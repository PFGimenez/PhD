library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "insurance"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result
# tightness = 0
oracle = c(0.792, 0.7972, 0.79975, 0.80885, 0.80565, 0.81135, 0.8195, 0.8261, 0.83185, 0.83085, 0.8394, 0.8423, 0.848, 0.85355, 0.86005, 0.8689, 0.8704, 0.88105, 0.8909, 0.89185, 0.90575, 0.9104, 0.91335, 0.92245, 0.92825, 0.9308, 0.93345)
Naif = c(0.792, 0.7975, 0.7993, 0.8068, 0.80285, 0.8095, 0.8151, 0.8207, 0.8251, 0.82225, 0.8294, 0.8312, 0.8303, 0.83195, 0.83615, 0.83825, 0.8405, 0.8422, 0.84605, 0.8441, 0.85205, 0.8498, 0.85295, 0.8521, 0.8544, 0.85715, 0.85555)
jointree = c(0.792, 0.79695, 0.79935, 0.80745, 0.80345, 0.8103, 0.8182, 0.8247, 0.82755, 0.82715, 0.8354, 0.8346, 0.83915, 0.84035, 0.8473, 0.84655, 0.8494, 0.8549, 0.86025, 0.85895, 0.8686, 0.87265, 0.86935, 0.8734, 0.87485, 0.8757, 0.87805)
wmv = c(0.62375, 0.78, 0.78485, 0.7943, 0.7935, 0.8019, 0.8088, 0.81545, 0.82085, 0.8169, 0.83035, 0.8297, 0.82975, 0.83285, 0.837, 0.83915, 0.8423, 0.8453, 0.8501, 0.84815, 0.8559, 0.8597, 0.8602, 0.8595, 0.8631, 0.8601, 0.8616)
vpop = c(0.75925, 0.7758, 0.78035, 0.78805, 0.78465, 0.79605, 0.80045, 0.8072, 0.81145, 0.81245, 0.81795, 0.8205, 0.8219, 0.82425, 0.82855, 0.82995, 0.83325, 0.83375, 0.8398, 0.8324, 0.83945, 0.84255, 0.83855, 0.8395, 0.8396, 0.8381, 0.8359)
vnaif = c(0.76955, 0.78, 0.78485, 0.7943, 0.7936, 0.80195, 0.80875, 0.81555, 0.82095, 0.8172, 0.8302, 0.8298, 0.8301, 0.833, 0.8371, 0.8396, 0.8431, 0.8453, 0.8506, 0.84855, 0.85565, 0.86015, 0.8605, 0.8596, 0.86325, 0.8608, 0.86215)

# tightness = 0.05
oracle = c(0.78445, 0.7875731289086141, 0.7847084540694423, 0.7864097570974685, 0.7882553984775517, 0.7967047291308201, 0.7909723686985868, 0.7989625238196062, 0.8039993566718491, 0.8120462489916644, 0.8097047329570126, 0.8167487684729065, 0.8266791662071248, 0.8296736894769026, 0.8382771912183676, 0.8457714253432009, 0.8500113973102348, 0.8591196401116109, 0.8675010046500947, 0.8812579488958261, 0.883212954333644, 0.8947739283617147, 0.8969497114591921, 0.9069352825815653, 0.9111641791044777, 0.9237039256817501, 0.9260417293007035)
Naif = c(0.78445, 0.7883296348597942, 0.7840475827360073, 0.7850773803423183, 0.7869607995443012, 0.7948798164659263, 0.7873338958025733, 0.7930340885030701, 0.7957969227470112, 0.8041408980908846, 0.800531914893617, 0.80415982484948, 0.8054483291055476, 0.8114403246428373, 0.8145355008100106, 0.8131743969267273, 0.8188397538180989, 0.8230738568418655, 0.8200815201791147, 0.8305584460631287, 0.8299161230195713, 0.8347034644744569, 0.8264044282181133, 0.839484162358115, 0.8402985074626865, 0.8421336529817202, 0.8418014551139439)
jointree = c(0.78445, 0.7884809360500302, 0.7838950739667531, 0.7853848519011991, 0.7875304230749314, 0.7964961676834037, 0.7884939886099979, 0.796262968452255, 0.8007827159170107, 0.8086044635654746, 0.8035171515414676, 0.8097974822112753, 0.8148229844491012, 0.8177775307132137, 0.8211273113233898, 0.822043952319078, 0.8275586961477092, 0.8346905073742953, 0.8320799127389632, 0.8435079199907504, 0.842497670083877, 0.8491485613623018, 0.8456601107054529, 0.8579069352825816, 0.8581492537313433, 0.8599340725202278, 0.8613432746076604)
wmv = c(0.73825, 0.7800080693968126, 0.7782522495043465, 0.7783642513067541, 0.7814199161099892, 0.7889879555764117, 0.7829571820291078, 0.7912873173830193, 0.7931699994638932, 0.7998386663081474, 0.7976552323056882, 0.8063492063492064, 0.8073784052056909, 0.812218578019901, 0.8110720071504385, 0.8164510479633919, 0.8232847048096649, 0.8241557997836114, 0.8259946035937769, 0.8308474968204417, 0.8341099720410066, 0.8346447445684086, 0.8341773642680486, 0.8420990075473941, 0.8458507462686568, 0.8501048846269104, 0.8485959954302207)
vpop = c(0.7603, 0.7650292515634456, 0.7616796299120533, 0.767705237265553, 0.770286365284035, 0.7744929349809687, 0.7676650495676017, 0.774984120262545, 0.781214817991744, 0.7841892981984404, 0.784085974815458, 0.7934865900383141, 0.7950259181647733, 0.8001000611484796, 0.7973297581140718, 0.8044178295011581, 0.8056188739457488, 0.8071863789078071, 0.8111257821918595, 0.8150075153196902, 0.8166938490214353, 0.8194362889019378, 0.8150983394182075, 0.8229036667260949, 0.823044776119403, 0.8267905304165418, 0.8210570621129216)
vnaif = c(0.7771, 0.7800080693968126, 0.7782522495043465, 0.7783642513067541, 0.7814199161099892, 0.7889879555764117, 0.7829571820291078, 0.7913931822993859, 0.7933308315016351, 0.7997848884108631, 0.7978723404255319, 0.8064039408866995, 0.807874710488585, 0.812218578019901, 0.811239595553321, 0.8163945539800012, 0.8233986779120127, 0.8241557997836114, 0.8261668293243011, 0.8305584460631287, 0.8338769804287046, 0.8352319436288902, 0.8335296195972206, 0.8423367207464194, 0.8463880597014926, 0.8501048846269104, 0.8494979255606999)

# tightness = 0.1
oracle = c(0.7534, 0.7549471259553974, 0.7517139253002797, 0.7447208150720018, 0.7571530333610352, 0.7563426586440047, 0.7564168377823408, 0.7670360294605534, 0.7688234889637626, 0.7726946279804654, 0.7772777572851346, 0.7839292579777009, 0.786020651310564, 0.7995057660626029, 0.8087923279300687, 0.8079289732770746, 0.8082314881380301, 0.8251249768561377, 0.8263849229011994, 0.8277642474427667, 0.8372769199919792, 0.8506004477915734, 0.8506929861402772, 0.8539398512450146, 0.8545474325500435, 0.8690892675770229, 0.8735460094437406)
Naif = c(0.7534, 0.7556800335043451, 0.7499040201831844, 0.7428425066879162, 0.7529383829989315, 0.7498914459400782, 0.7494224845995893, 0.7590073651383452, 0.754864883449082, 0.7548118356794025, 0.7564736259682774, 0.7620146097654749, 0.7558379666401907, 0.7681219110378913, 0.7686497496393109, 0.7667018284106891, 0.7699496764917325, 0.7744862062581004, 0.7806967447173044, 0.7811008280565027, 0.7782233807900542, 0.7874007734581722, 0.7825493490130198, 0.7853832057777299, 0.7780678851174935, 0.7908813903622616, 0.7926983761372798)
jointree = c(0.7534, 0.7552088786514501, 0.751330006033017, 0.7444931413284763, 0.7565594206339784, 0.7569009366664599, 0.7523742299794661, 0.7634529891845265, 0.7644915079419652, 0.7671646078713014, 0.7699004057543342, 0.7790080738177624, 0.7782366957903097, 0.7874794069192751, 0.7931766103708733, 0.7937763713080169, 0.7935837526959022, 0.8062395852619885, 0.807824100513992, 0.8039941548952753, 0.8123120112291959, 0.8225117036433951, 0.8200335993280135, 0.818368006898782, 0.8160356832027851, 0.8326373998420042, 0.8312795116895082)
wmv = c(0.61295, 0.7299235682127526, 0.7303241375527889, 0.7260515681029085, 0.7372076457319245, 0.7384777619254389, 0.7433264887063655, 0.7521730475748125, 0.7503953792202435, 0.7563200229819017, 0.7600885282183696, 0.7679354094579008, 0.7677521842732328, 0.7790774299835256, 0.7874904523466011, 0.7883263009845288, 0.7843278217109992, 0.8005924828735419, 0.8037312012183514, 0.8029225523623965, 0.8046921997192701, 0.81355587217586, 0.8121587568248635, 0.8116848119003989, 0.8092906875543951, 0.8195463265997066, 0.8168835655879304)
vpop = c(0.7074, 0.7022824835095801, 0.7071792902978117, 0.7035118674938813, 0.7146503621037635, 0.7223497301656224, 0.7133598562628337, 0.7298785747462013, 0.7333425015471361, 0.7391554151106005, 0.7448911840649207, 0.75440215301807, 0.7567911040508339, 0.7708401976935749, 0.7760332682678435, 0.7761954992967651, 0.7774982027318476, 0.7913349379744492, 0.7967827907862174, 0.7919142717973697, 0.8002807298977341, 0.806126602890291, 0.8030239395212095, 0.8069418993209011, 0.8021105308964317, 0.811307978783433, 0.8092825060462974)
vnaif = c(0.73675, 0.7299235682127526, 0.7303241375527889, 0.7260515681029085, 0.7372076457319245, 0.7384777619254389, 0.7433264887063655, 0.7521730475748125, 0.7503266176167228, 0.7563200229819017, 0.7600885282183696, 0.7679354094579008, 0.7679904686258936, 0.7792421746293245, 0.7878299244674531, 0.7875351617440225, 0.7849568655643422, 0.8004073319755601, 0.8036360175138016, 0.8028251339503166, 0.8047924603970323, 0.8139629554243842, 0.8127887442251155, 0.8120081923035464, 0.8107049608355091, 0.8201105969980815, 0.8175745710008062)



#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-100*oracle
Naif = 100-100*Naif
jointree = 100-100*jointree
wmv = 100-100*wmv
vpop = 100-100*vpop
vnaif = 100-100*vnaif

c_oracle = 100*c_oracle
c_Naif = 100*c_Naif
c_jointree = 100*c_jointree
c_wmv = 100*c_wmv
c_vpop = 100*c_vpop
c_vnaif = 100*c_vnaif
#FIN MAJ VERS ERROR

nb_val = length(oracle)
nb_val = length(Naif)
nb_val = length(jointree)
nb_val = length(wmv)
nb_val = length(vpop)
nb_val = length(vnaif)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*vpop)
min_val_erreur = min(min_val_erreur,100-100*vnaif)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*vpop)
max_val_erreur = max(max_val_erreur,100-100*vnaif)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

#fin parametres graphes
#--------------------------------------------------------------------------------------------

(ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
    ylab("Error rate (%)") + xlab("Number of assigned variables") + theme_bw() #+ theme(legend.position="bottom")
  +geom_line(aes(y=Naif, colour="Naive Bayes"), colour="turquoise2", linetype = "dotted") + geom_point(aes(y=Naif, shape="Naive Bayes"), colour="turquoise2", fill="turquoise2") 
  +geom_line(aes(y=wmv, colour="Weighted Majority Voter"), colour="deeppink2", linetype = "dotted") + geom_point(aes(y=wmv, shape="Weighted Majority Voter"), colour="deeppink2", fill="deeppink2") 
  +geom_line(aes(y=vpop, colour="Most Popular Choice"), colour="gold2", linetype = "dotted") + geom_point(aes(y=vpop, shape="Most Popular Choice"), colour="gold2", fill="gold2")
  +geom_line(aes(y=vnaif, colour="Naive Bayes Voter"), colour="firebrick3", linetype = "dotted") + geom_point(aes(y=vnaif, shape="Naive Bayes Voter"), colour="firebrick3", fill="firebrick3")
  +geom_line(aes(y=jointree, colour="Bayesian network"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointree, shape="Bayesian network"), colour="springgreen4", fill="springgreen4") 
  +geom_line(aes(y=oracle, colour="Oracle"), colour="black", linetype = "dotted") + geom_point(aes(y=oracle, shape="Oracle"), colour="black", fill="black") 
  + scale_colour_manual(name = 'Legend', guide = 'legend',
                        limits = c(NULL
                                   ,'Bayesian network' #jointree
                                   ,'Naive Bayes' #Naif
                                   ,'Weighted Majority Voter' #wmv
                                   ,'Most Popular Choice' #vpop
                                   ,'Naive Bayes Voter' #vnaif
                                   ,'Oracle' #oracle
                        ),
                        values =c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ,'Oracle'='black' #oracle
                        ))
  + scale_shape_manual(name = 'Legend', guide = 'legend',
                       limits = c(NULL
                                  ,'Bayesian network' #jointree
                                  ,'Naive Bayes' #Naif
                                  ,'Weighted Majority Voter' #wmv
                                  ,'Most Popular Choice' #vpop
                                  ,'Naive Bayes Voter' #vnaif
                                  ,'Oracle' #oracle
                       ),
                       values =c(NULL
                                 ,'Bayesian network'=21 #jointree
                                 ,'Naive Bayes'=24 #Naif
                                 ,'Weighted Majority Voter'=25 #wmv
                                 ,'Most Popular Choice'=22 #vpop
                                 ,'Naive Bayes Voter'=23 #vnaif
                                 ,'Oracle'=4 #oracle
                       ))
  
  + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                                               ,'Bayesian network'='springgreen4' #jointree
                                                               ,'Naive Bayes'='turquoise2' #Naif
                                                               ,'Weighted Majority Voter'='deeppink2' #wmv
                                                               ,'Most Popular Choice'='gold2' #vpop
                                                               ,'Naive Bayes Voter'='firebrick3' #vnaif
                                                               ,'Oracle'='black' #oracle
  ),
  fill = c(NULL
           ,'Bayesian network'='springgreen4' #jointree
           ,'Naive Bayes'='turquoise2' #Naif
           ,'Weighted Majority Voter'='deeppink2' #wmv
           ,'Most Popular Choice'='gold2' #vpop
           ,'Naive Bayes Voter'='firebrick3' #vnaif
           ,'Oracle'='black' #oracle
  ))))
)
