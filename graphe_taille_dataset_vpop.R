library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "alarm"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data

#VPOP

#1
dRC = c(0.7426970788315326,0.7657062825130052,0.7841136454581833,0.8103241296518607,0.8239295718287315,0.8407362945178071,0.8545418167266907,0.866546618647459,0.8625450180072028,0.868547418967587,0.8865546218487395,0.8775510204081632,0.89015606242497,0.8903561424569828,0.8975590236094437,0.8951580632252901,0.9041616646658663,0.9027611044417767,0.9083633453381352,0.9039615846338536,0.9123649459783914,0.90656262505002,0.90656262505002,0.9067627050820328,0.9151660664265706,0.9131652661064426,0.9081632653061225,0.915766306522609,0.9143657462985194,0.9125650260104041,0.9181672669067628,0.9187675070028011,0.9245698279311725,0.9135654261704682,0.9139655862344938,0.9165666266506602,0.9185674269707883)
#2
oracle = c(0.7463323552947453,0.7802080554814618,0.7972792744731928,0.7988797012536677,0.8378234195785543,0.8367564683915711,0.8508935716190984,0.863430248066151,0.863430248066151,0.8644971992531342,0.8799679914643905,0.8759669245132036,0.8839690584155775,0.8861029607895439,0.888503600960256,0.8903707655374766,0.8922379301146972,0.9029074419845292,0.8834355828220859,0.8927714057081888,0.9069085089357162,0.8973059482528675,0.9023739663910376,0.8994398506268338,0.8906375033342224,0.9111763136836489,0.9074419845292078,0.9093091491064283,0.9082421979194452,0.9127767404641237,0.9050413443584956,0.908508935716191,0.9066417711389704,0.9218458255534809,0.9066417711389704,0.9069085089357162,0.9090424113096826)
#4
rc = c(0.7389117512574302,0.7821216278006401,0.7848651120256058,0.8042981252857796,0.8333333333333334,0.8294467306812986,0.8509373571101966,0.8447645176040238,0.8573388203017832,0.8644261545496114,0.8699131229995427,0.8573388203017832,0.8733424782807498,0.8852309099222679,0.8765432098765432,0.8870598994055784,0.8692272519433013,0.8843164151806127,0.8884316415180613,0.8845450388660265,0.8900320073159579,0.8943758573388203,0.8831732967535436,0.8907178783721994,0.892318244170096,0.8927754915409236,0.8978052126200274,0.8952903520804756,0.8877457704618198,0.8904892546867855,0.8831732967535436,0.8891175125743027,0.8845450388660265,0.897119341563786,0.8936899862825789,0.8879743941472337,0.8982624599908551)
#8
Naif = c(0.7407723490505654,0.7729891188393428,0.7853637721356945,0.8005120546191594,0.8126733518241945,0.8299551952208235,0.8393428632387455,0.8401962876040111,0.850650736078515,0.8555579261787924,0.856411350544058,0.8527842969916791,0.8617452528269682,0.8743332622146363,0.8662257307446127,0.8749733304885855,0.8692127160230425,0.8687860038404096,0.8728397695754214,0.8689993599317261,0.87945380840623,0.8766801792191167,0.873693193940687,0.8702794964796245,0.8749733304885855,0.8734798378493706,0.8773202474930659,0.8775336035843824,0.8719863452101557,0.8777469596756987,0.8724130573927885,0.8734798378493706,0.8715596330275229,0.8749733304885855,0.8728397695754214,0.8856411350544058,0.8728397695754214)
#16
jointree = c(0.7381788147842246,0.77782366301879,0.7945488333677473,0.8048730125954987,0.8269667561428866,0.829857526326657,0.8259343382201115,0.8331612636795375,0.8399752219698534,0.844104893660954,0.8484410489366095,0.851951269874045,0.859797646087136,0.8602106132562461,0.8579392938261409,0.8554614908114805,0.8564939087342556,0.8569068759033657,0.8593846789180261,0.858971711748916,0.8550485236423704,0.8633078670245715,0.8569068759033657,0.8558744579805906,0.8527772042122651,0.8583522609952509,0.8641338013627916,0.8618624819326863,0.858971711748916,0.8577328102415858,0.8531901713813752,0.8509188519512699,0.8507123683667148,0.8579392938261409,0.8498864340284947,0.8498864340284947,0.8600041296716912)
#32
wmv = c(0.7358260516155253,0.7652916073968705,0.7878479983743142,0.7959764275553749,0.8028855923592766,0.8106076000812843,0.8160942897785003,0.823816297500508,0.8254419833367201,0.8252387726071937,0.8248323511481406,0.8189392399918716,0.8258484047957733,0.828896565738671,0.8193456614509246,0.8313350944929893,0.8171103434261329,0.8228002438528754,0.8276773013615119,0.8114204429993904,0.8138589717537086,0.8142653932127616,0.8215809794757163,0.8106076000812843,0.8110140215403373,0.8162975005080269,0.8248323511481406,0.8142653932127616,0.8065433854907539,0.828896565738671,0.8144686039422881,0.813249339565129,0.8221906116642959,0.8303190408453567,0.8087787035155456,0.8114204429993904,0.8177199756147124)
#64
lextree = c(0.7225806451612903,0.7596774193548387,0.7727822580645162,0.7925403225806451,0.7955645161290322,0.7989919354838709,0.8042338709677419,0.8008064516129032,0.7891129032258064,0.7939516129032258,0.79375,0.7846774193548387,0.7967741935483871,0.7977822580645161,0.7872983870967742,0.7921370967741935,0.7776209677419355,0.7715725806451613,0.7764112903225806,0.7721774193548387,0.7828629032258064,0.7667338709677419,0.7848790322580645,0.7677419354838709,0.7689516129032258,0.7729838709677419,0.76875,0.7633064516129032,0.7637096774193548,0.7566532258064517,0.7625,0.7681451612903226,0.7528225806451613,0.7719758064516129,0.7554435483870968,0.7616935483870968,0.7570564516129032)

#NAIVE BAYES VOTER

#1
dRC = c(0.7426970788315326,0.7657062825130052,0.7841136454581833,0.8103241296518607,0.8239295718287315,0.8407362945178071,0.8545418167266907,0.866546618647459,0.8625450180072028,0.868547418967587,0.8865546218487395,0.8775510204081632,0.89015606242497,0.8903561424569828,0.8975590236094437,0.8951580632252901,0.9041616646658663,0.9027611044417767,0.9083633453381352,0.9039615846338536,0.9123649459783914,0.90656262505002,0.90656262505002,0.9067627050820328,0.9151660664265706,0.9131652661064426,0.9081632653061225,0.915766306522609,0.9143657462985194,0.9125650260104041,0.9181672669067628,0.9187675070028011,0.9245698279311725,0.9135654261704682,0.9139655862344938,0.9165666266506602,0.9185674269707883)
#2
oracle = c(0.7463323552947453,0.7802080554814618,0.7972792744731928,0.7988797012536677,0.8378234195785543,0.8367564683915711,0.8508935716190984,0.863430248066151,0.863430248066151,0.8644971992531342,0.8799679914643905,0.8759669245132036,0.8839690584155775,0.8861029607895439,0.888503600960256,0.8903707655374766,0.8922379301146972,0.9029074419845292,0.8834355828220859,0.8927714057081888,0.9069085089357162,0.8973059482528675,0.9023739663910376,0.8994398506268338,0.8906375033342224,0.9111763136836489,0.9074419845292078,0.9093091491064283,0.9082421979194452,0.9127767404641237,0.9050413443584956,0.908508935716191,0.9066417711389704,0.9218458255534809,0.9066417711389704,0.9069085089357162,0.9090424113096826)
#4
rc = c(0.7389117512574302,0.7821216278006401,0.7848651120256058,0.8042981252857796,0.8333333333333334,0.8294467306812986,0.8509373571101966,0.8447645176040238,0.8573388203017832,0.8644261545496114,0.8699131229995427,0.8573388203017832,0.8733424782807498,0.8852309099222679,0.8765432098765432,0.8870598994055784,0.8692272519433013,0.8843164151806127,0.8884316415180613,0.8845450388660265,0.8900320073159579,0.8943758573388203,0.8831732967535436,0.8907178783721994,0.892318244170096,0.8927754915409236,0.8978052126200274,0.8952903520804756,0.8877457704618198,0.8904892546867855,0.8831732967535436,0.8891175125743027,0.8845450388660265,0.897119341563786,0.8936899862825789,0.8879743941472337,0.8982624599908551)
#8
Naif = c(0.7407723490505654,0.7729891188393428,0.7853637721356945,0.8005120546191594,0.8126733518241945,0.8299551952208235,0.8393428632387455,0.8401962876040111,0.850650736078515,0.8555579261787924,0.856411350544058,0.8527842969916791,0.8617452528269682,0.8743332622146363,0.8662257307446127,0.8749733304885855,0.8692127160230425,0.8687860038404096,0.8728397695754214,0.8689993599317261,0.87945380840623,0.8766801792191167,0.873693193940687,0.8702794964796245,0.8749733304885855,0.8734798378493706,0.8773202474930659,0.8775336035843824,0.8719863452101557,0.8777469596756987,0.8724130573927885,0.8734798378493706,0.8715596330275229,0.8749733304885855,0.8728397695754214,0.8856411350544058,0.8728397695754214)
#16
jointree = c(0.7381788147842246,0.77782366301879,0.7945488333677473,0.8048730125954987,0.8269667561428866,0.829857526326657,0.8259343382201115,0.8331612636795375,0.8399752219698534,0.844104893660954,0.8484410489366095,0.851951269874045,0.859797646087136,0.8602106132562461,0.8579392938261409,0.8554614908114805,0.8564939087342556,0.8569068759033657,0.8593846789180261,0.858971711748916,0.8550485236423704,0.8633078670245715,0.8569068759033657,0.8558744579805906,0.8527772042122651,0.8583522609952509,0.8641338013627916,0.8618624819326863,0.858971711748916,0.8577328102415858,0.8531901713813752,0.8509188519512699,0.8507123683667148,0.8579392938261409,0.8498864340284947,0.8498864340284947,0.8600041296716912)
#32
wmv = c(0.7358260516155253,0.7652916073968705,0.7878479983743142,0.7959764275553749,0.8028855923592766,0.8106076000812843,0.8160942897785003,0.823816297500508,0.8254419833367201,0.8252387726071937,0.8248323511481406,0.8189392399918716,0.8258484047957733,0.828896565738671,0.8193456614509246,0.8313350944929893,0.8171103434261329,0.8228002438528754,0.8276773013615119,0.8114204429993904,0.8138589717537086,0.8142653932127616,0.8215809794757163,0.8106076000812843,0.8110140215403373,0.8162975005080269,0.8248323511481406,0.8142653932127616,0.8065433854907539,0.828896565738671,0.8144686039422881,0.813249339565129,0.8221906116642959,0.8303190408453567,0.8087787035155456,0.8114204429993904,0.8177199756147124)
#64
lextree = c(0.7225806451612903,0.7596774193548387,0.7727822580645162,0.7925403225806451,0.7955645161290322,0.7989919354838709,0.8042338709677419,0.8008064516129032,0.7891129032258064,0.7939516129032258,0.79375,0.7846774193548387,0.7967741935483871,0.7977822580645161,0.7872983870967742,0.7921370967741935,0.7776209677419355,0.7715725806451613,0.7764112903225806,0.7721774193548387,0.7828629032258064,0.7667338709677419,0.7848790322580645,0.7677419354838709,0.7689516129032258,0.7729838709677419,0.76875,0.7633064516129032,0.7637096774193548,0.7566532258064517,0.7625,0.7681451612903226,0.7528225806451613,0.7719758064516129,0.7554435483870968,0.7616935483870968,0.7570564516129032)


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
dRC = 100-100*dRC
oracle = 100-100*oracle
Naif = 100-100*Naif
rc = 100-100*rc
jointree = 100-100*jointree
wmv = 100-100*wmv
lextree = 100-100*lextree


nb_val = length(rc)
nb_val = length(dRC)
nb_val = length(oracle)
nb_val = length(Naif)
nb_val = length(jointree)
nb_val = length(wmv)
nb_val = length(lextree)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*rc)
min_val_erreur = min(min_val_erreur,100-100*dRC)
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*lextree)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*rc)
max_val_erreur = max(max_val_erreur,100-100*dRC)
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*lextree)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)


png(file=paste("Taux_erreur_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
(ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
  ylab("Error rate (%)") + xlab("Number of known choices") + theme_bw() #+ theme(legend.position="bottom")
+geom_line(aes(y=dRC, colour="Complete sample")) + geom_point(aes(y=dRC), colour="coral3") 
+geom_line(aes(y=oracle, colour="1/2 sample")) + geom_point(aes(y=oracle), colour="black") 
+geom_line(aes(y=rc, colour="1/4 sample")) + geom_point(aes(y=rc), colour="darkorchid3") 
+geom_line(aes(y=Naif, colour="1/8 sample")) + geom_point(aes(y=Naif), colour="darkslategray4") 
+geom_line(aes(y=jointree, colour="1/16 sample")) + geom_point(aes(y=jointree), colour="springgreen4") 
+geom_line(aes(y=wmv, colour="1/32 sample")) + geom_point(aes(y=wmv), colour="indianred4") 
+geom_line(aes(y=lextree, colour="1/64 sample")) + geom_point(aes(y=lextree), colour="deepskyblue4") 
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                      values =c(NULL
                                ,'Complete sample'='coral' #dRC
                                ,'1/2 sample'='black' #oracle
                                ,'1/4 sample'='darkorchid1' #rc
                                ,'1/8 sample'='darkslategray1' #Naif
                                ,'1/16 sample'='springgreen' #jointree
                                ,'1/32 sample'='indianred1' #wmv
                                ,'1/64 sample'='deepskyblue4' #lextree
                      )))
dev.off()

