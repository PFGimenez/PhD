library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "alarm"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data

#oracle

oracleVrai = c(0.7565026010404161,0.7787114845938375,0.7965186074429772,0.8181272509003601,0.84093637454982,0.8531412565026011,0.8647458983593438,0.8879551820728291,0.8877551020408163,0.898359343737495,0.9145658263305322,0.9161664665866347,0.9297719087635054,0.928171268507403,0.9359743897559024,0.9387755102040817,0.9471788715486195,0.9483793517406963,0.9553821528611445,0.9591836734693877,0.9623849539815926,0.9633853541416567,0.9677871148459384,0.9663865546218487,0.9679871948779512,0.9739895958383353,0.9717887154861945,0.9749899959983993,0.9717887154861945,0.976390556222489,0.9765906362545018,0.9831932773109243,0.9839935974389756,0.9821928771508603,0.9813925570228091,0.985594237695078,0.9849939975990396)

#VPOP

#1
dRC = c(0.7426970788315326,0.7657062825130052,0.7841136454581833,0.8103241296518607,0.8239295718287315,0.8407362945178071,0.8545418167266907,0.866546618647459,0.8625450180072028,0.868547418967587,0.8865546218487395,0.8775510204081632,0.89015606242497,0.8903561424569828,0.8975590236094437,0.8951580632252901,0.9041616646658663,0.9027611044417767,0.9083633453381352,0.9039615846338536,0.9123649459783914,0.90656262505002,0.90656262505002,0.9067627050820328,0.9151660664265706,0.9131652661064426,0.9081632653061225,0.915766306522609,0.9143657462985194,0.9125650260104041,0.9181672669067628,0.9187675070028011,0.9245698279311725,0.9135654261704682,0.9139655862344938,0.9165666266506602,0.9185674269707883)
#2
oracle = c(0.7463323552947453,0.7802080554814618,0.7972792744731928,0.7988797012536677,0.8378234195785543,0.8367564683915711,0.8508935716190984,0.863430248066151,0.863430248066151,0.8644971992531342,0.8799679914643905,0.8759669245132036,0.8839690584155775,0.8861029607895439,0.888503600960256,0.8903707655374766,0.8922379301146972,0.9029074419845292,0.8834355828220859,0.8927714057081888,0.9069085089357162,0.8973059482528675,0.9023739663910376,0.8994398506268338,0.8906375033342224,0.9111763136836489,0.9074419845292078,0.9093091491064283,0.9082421979194452,0.9127767404641237,0.9050413443584956,0.908508935716191,0.9066417711389704,0.9218458255534809,0.9066417711389704,0.9069085089357162,0.9090424113096826)
#4
rc = c(0.7389117512574302,0.7821216278006401,0.7848651120256058,0.8042981252857796,0.8333333333333334,0.8294467306812986,0.8509373571101966,0.8447645176040238,0.8573388203017832,0.8644261545496114,0.8699131229995427,0.8573388203017832,0.8733424782807498,0.8852309099222679,0.8765432098765432,0.8870598994055784,0.8692272519433013,0.8843164151806127,0.8884316415180613,0.8845450388660265,0.8900320073159579,0.8943758573388203,0.8831732967535436,0.8907178783721994,0.892318244170096,0.8927754915409236,0.8978052126200274,0.8952903520804756,0.8877457704618198,0.8904892546867855,0.8831732967535436,0.8891175125743027,0.8845450388660265,0.897119341563786,0.8936899862825789,0.8879743941472337,0.8982624599908551)
#8
Naif = c(0.7407723490505654,0.7729891188393428,0.7853637721356945,0.8005120546191594,0.8126733518241945,0.8299551952208235,0.8393428632387455,0.8401962876040111,0.850650736078515,0.8555579261787924,0.856411350544058,0.8527842969916791,0.8617452528269682,0.8743332622146363,0.8662257307446127,0.8749733304885855,0.8692127160230425,0.8687860038404096,0.8728397695754214,0.8689993599317261,0.87945380840623,0.8766801792191167,0.873693193940687,0.8702794964796245,0.8749733304885855,0.8734798378493706,0.8773202474930659,0.8775336035843824,0.8719863452101557,0.8777469596756987,0.8724130573927885,0.8734798378493706,0.8715596330275229,0.8749733304885855,0.8728397695754214,0.8856411350544058,0.8728397695754214)
#16
jointree = c(0.7381788147842246,0.77782366301879,0.7945488333677473,0.8048730125954987,0.8269667561428866,0.829857526326657,0.8259343382201115,0.8331612636795375,0.8399752219698534,0.844104893660954,0.8484410489366095,0.851951269874045,0.859797646087136,0.8602106132562461,0.8579392938261409,0.8554614908114805,0.8564939087342556,0.8569068759033657,0.8593846789180261,0.858971711748916,0.8550485236423704,0.8633078670245715,0.8569068759033657,0.8558744579805906,0.8527772042122651,0.8583522609952509,0.8641338013627916,0.8618624819326863,0.858971711748916,0.8577328102415858,0.8531901713813752,0.8509188519512699,0.8507123683667148,0.8579392938261409,0.8498864340284947,0.8498864340284947,0.8600041296716912)
#32
wmv = c(0.7358260516155253,0.7652916073968705,0.7878479983743142,0.7959764275553749,0.8028855923592766,0.8106076000812843,0.8160942897785003,0.823816297500508,0.8254419833367201,0.8252387726071937,0.8248323511481406,0.8189392399918716,0.8258484047957733,0.828896565738671,0.8193456614509246,0.8313350944929893,0.8171103434261329,0.8228002438528754,0.8276773013615119,0.8114204429993904,0.8138589717537086,0.8142653932127616,0.8215809794757163,0.8106076000812843,0.8110140215403373,0.8162975005080269,0.8248323511481406,0.8142653932127616,0.8065433854907539,0.828896565738671,0.8144686039422881,0.813249339565129,0.8221906116642959,0.8303190408453567,0.8087787035155456,0.8114204429993904,0.8177199756147124)
#64
lextree = c(0.7225806451612903,0.7596774193548387,0.7727822580645162,0.7925403225806451,0.7955645161290322,0.7989919354838709,0.8042338709677419,0.8008064516129032,0.7891129032258064,0.7939516129032258,0.79375,0.7846774193548387,0.7967741935483871,0.7977822580645161,0.7872983870967742,0.7921370967741935,0.7776209677419355,0.7715725806451613,0.7764112903225806,0.7721774193548387,0.7828629032258064,0.7667338709677419,0.7848790322580645,0.7677419354838709,0.7689516129032258,0.7729838709677419,0.76875,0.7633064516129032,0.7637096774193548,0.7566532258064517,0.7625,0.7681451612903226,0.7528225806451613,0.7719758064516129,0.7554435483870968,0.7616935483870968,0.7570564516129032)

#NAIVE BAYES VOTER

#1
dRC = c(0.7543017206882753,0.7767106842737095,0.7903161264505802,0.8143257302921169,0.8271308523409364,0.8469387755102041,0.8563425370148059,0.8751500600240096,0.8679471788715486,0.8769507803121248,0.8929571828731493,0.8891556622649059,0.8945578231292517,0.8977591036414566,0.9009603841536614,0.8991596638655462,0.9101640656262505,0.8997599039615847,0.912765106042417,0.9071628651460584,0.9179671868747499,0.9173669467787114,0.9181672669067628,0.9185674269707883,0.9241696678671468,0.921968787515006,0.9177671068427371,0.924969987995198,0.9213685474189676,0.9231692677070829,0.9295718287314926,0.9297719087635054,0.9325730292116847,0.9221688675470188,0.9251700680272109,0.9259703881552621,0.9267707082833133)
#2
oracle = c(0.7263270205388104,0.7772739397172579,0.7951453720992264,0.8074153107495332,0.8372899439850627,0.8442251267004535,0.8599626567084556,0.8722325953587623,0.8711656441717791,0.8703654307815417,0.8797012536676447,0.8895705521472392,0.891170978927714,0.8946385702854095,0.8914377167244598,0.9023739663910376,0.905841557748733,0.9149106428380902,0.8989063750333423,0.9013070152040544,0.913843691651107,0.9114430514803947,0.9090424113096826,0.9114430514803947,0.9021072285942918,0.9202453987730062,0.9135769538543612,0.9207788743664977,0.9111763136836489,0.9269138436916511,0.919178447586023,0.9143771672445986,0.9210456121632435,0.9263803680981595,0.9218458255534809,0.9239797279274473,0.9229127767404641)
#4
rc = c(0.7457704618198445,0.7887517146776406,0.7912665752171925,0.807498856881573,0.8363054412437129,0.8399634202103338,0.8577960676726109,0.8571101966163694,0.866026520347508,0.8783721993598537,0.8754000914494742,0.8632830361225423,0.8904892546867855,0.8927754915409236,0.8850022862368542,0.895976223136717,0.8836305441243713,0.8895747599451304,0.8998628257887518,0.9012345679012346,0.9064929126657522,0.9060356652949245,0.9042066758116141,0.904435299497028,0.9078646547782351,0.9122085048010974,0.9133516232281664,0.9128943758573388,0.9094650205761317,0.9131229995427527,0.9042066758116141,0.9087791495198903,0.9083219021490626,0.9176954732510288,0.9085505258344765,0.9071787837219936,0.9133516232281664)
#8
Naif = c(0.7426925538724131,0.7729891188393428,0.7889908256880734,0.8062726690847024,0.8143802005547258,0.8331555365905696,0.8414764241519095,0.8474503947087689,0.8566247066353745,0.8685726477490933,0.8634521015574995,0.8692127160230425,0.8758267548538511,0.8867079155109878,0.8779603157670152,0.8807339449541285,0.8830808619586089,0.8858544911457222,0.8869212716023043,0.8826541497759761,0.8939620226157456,0.890975037337316,0.8958822274375934,0.8935353104331129,0.8899082568807339,0.8956688713462769,0.8928952421591636,0.8950288030723277,0.8973757200768082,0.9027096223597184,0.9003627053552379,0.9012161297205035,0.8992959248986558,0.904629827181566,0.9012161297205035,0.9059099637294645,0.904629827181566)
#16
jointree = c(0.7571753045632872,0.7860830064009912,0.8063183976873839,0.8040470782572785,0.8275862068965517,0.8308899442494322,0.8323353293413174,0.8430724757381788,0.8529836877968201,0.8469956638447244,0.8531901713813752,0.851951269874045,0.8715672104067727,0.8719801775758828,0.8746644641750981,0.8728061119141028,0.8705347924839976,0.8759033656824282,0.8773487507743134,0.8779682015279785,0.881065455296304,0.8806524881271939,0.8804460045426389,0.8792071030353087,0.8796200702044188,0.8893247986785051,0.8920090852777204,0.8909766673549453,0.8837497418955194,0.8953128226306009,0.8839562254800744,0.8845756762337394,0.8880858971711749,0.8847821598182944,0.8926285360313855,0.8829238075572992,0.8955193062151559)
#32
wmv = c(0.7583824425929689,0.7815484657589921,0.7963828490144279,0.8039016460069092,0.8173135541556594,0.813249339565129,0.8274740906319854,0.8368217841902053,0.8368217841902053,0.8366185734606787,0.8549075391180654,0.8425116846169478,0.8457630562893721,0.8583621215200162,0.8506401137980085,0.8616134931924405,0.8581589107904898,0.8579557000609632,0.8599878073562284,0.8585653322495428,0.8571428571428571,0.8579557000609632,0.8782767730136151,0.8486080065027434,0.8679130258077626,0.8632391790286527,0.8780735622840886,0.8746189798821378,0.8636456004877058,0.8733997155049786,0.8695387116439748,0.8705547652916074,0.8713676082097135,0.8813249339565129,0.8723836618573461,0.8683194472668156,0.8746189798821378)
#64
lextree = c(0.7586693548387097,0.7786290322580646,0.7820564516129033,0.7903225806451613,0.7975806451612903,0.7983870967741935,0.8066532258064516,0.8042338709677419,0.8002016129032258,0.7989919354838709,0.8048387096774193,0.8046370967741936,0.8131048387096774,0.8201612903225807,0.8125,0.8147177419354839,0.8129032258064516,0.7985887096774194,0.8137096774193548,0.8179435483870968,0.8231854838709678,0.8092741935483871,0.8302419354838709,0.8118951612903226,0.8245967741935484,0.8205645161290323,0.8245967741935484,0.8300403225806452,0.816733870967742,0.822983870967742,0.8233870967741935,0.819758064516129,0.8112903225806452,0.8189516129032258,0.822983870967742,0.8280241935483871,0.8163306451612903)


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
dRC = 100-100*dRC
oracle = 100-100*oracle
Naif = 100-100*Naif
rc = 100-100*rc
jointree = 100-100*jointree
wmv = 100-100*wmv
lextree = 100-100*lextree
oracleVrai = 100-100*oracleVrai


nb_val = length(rc)
nb_val = length(dRC)
nb_val = length(oracle)
nb_val = length(Naif)
nb_val = length(jointree)
nb_val = length(wmv)
nb_val = length(lextree)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*rc)
min_val_erreur = min(min_val_erreur,100-100*dRC)
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*lextree)
min_val_erreur = min(min_val_erreur,100-100*oracleVrai)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*rc)
max_val_erreur = max(max_val_erreur,100-100*dRC)
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*lextree)
max_val_erreur = max(max_val_erreur,100-100*oracleVrai)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)


png(file=paste("Taux_erreur_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
(ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
  ylab("Error rate (%)") + xlab("Number of known choices") + theme_bw() #+ theme(legend.position="bottom")
+geom_line(aes(y=dRC, colour="Complete sample",shape="a")) + geom_point(aes(y=dRC), colour="coral3") 
+geom_line(aes(y=oracle, colour="1/2 sample",shape="b")) + geom_point(aes(y=oracle), colour="firebrick3") 
+geom_line(aes(y=oracleVrai, colour="Oracle",shape="b")) + geom_point(aes(y=oracleVrai), colour="black") 
+geom_line(aes(y=rc, colour="1/4 sample")) + geom_point(aes(y=rc), colour="darkorchid3") 
+geom_line(aes(y=Naif, colour="1/8 sample")) + geom_point(aes(y=Naif), colour="darkslategray4") 
+geom_line(aes(y=jointree, colour="1/16 sample")) + geom_point(aes(y=jointree), colour="springgreen4") 
+geom_line(aes(y=wmv, colour="1/32 sample")) + geom_point(aes(y=wmv), colour="indianred4") 
+geom_line(aes(y=lextree, colour="1/64 sample")) + geom_point(aes(y=lextree), colour="deepskyblue4") 
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                      values =c(NULL
                                ,'Complete sample'='coral' #dRC
                                ,'Oracle'='black' #oracleVrai
                                ,'1/2 sample'='firebrick3' #oracle
                                ,'1/4 sample'='darkorchid1' #rc
                                ,'1/8 sample'='darkslategray1' #Naif
                                ,'1/16 sample'='springgreen' #jointree
                                ,'1/32 sample'='indianred1' #wmv
                                ,'1/64 sample'='deepskyblue4' #lextree
                      )))
dev.off()

