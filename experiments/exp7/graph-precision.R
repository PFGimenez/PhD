library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "insurance"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result

#pas de contraintes small
oracle = c(0.686650915534554, 0.7504060838747785, 0.8024955699940933, 0.8267498523331365, 0.8497858830478441, 0.8642203189604253, 0.8767720023626698, 0.8885484347312463, 0.896042528056704, 0.8996972829297105, 0.9089633786178382, 0.9155345540460721, 0.9181925575900768, 0.9226594802126403, 0.9238408151210868, 0.9270894861193149, 0.931777909037212, 0.9347681630242174, 0.9385336680448907, 0.9418192557590077, 0.9439235085646781, 0.944809509746013, 0.9500886001181335, 0.9498670998227997, 0.9534111045481394, 0.9559214412285884, 0.957028942705257, 0.9582841110454814, 0.962677200236267, 0.9643753691671589, 0.9633786178381571, 0.9674025398700532, 0.9693960425280567, 0.9710572947430597, 0.973235380980508, 0.9734937979917306, 0.9753396337861784, 0.9760779681039575, 0.977259303012404, 0.9791420555227407, 0.9802495569994093, 0.9816523922031896, 0.9810986414648553, 0.9808402244536326, 0.9840888954518606, 0.9847164796219728, 0.9862669816893089, 0.9865253987005316)
jointree = c(0.6886075014766686, 0.7482649143532192, 0.7989515652687537, 0.8251993502658004, 0.8471647962197283, 0.8615992321323095, 0.8728588304784406, 0.8853366804489072, 0.8913910218546958, 0.8947873597164796, 0.9018384524512699, 0.9078558771411696, 0.9108830478440638, 0.9150177200236267, 0.9144270525694034, 0.9161252215002953, 0.9198168930891908, 0.9238038984051978, 0.9233608978145305, 0.926166568222091, 0.9287138216184289, 0.9292306556408741, 0.9331438275251034, 0.9324054932073242, 0.935137330183107, 0.9364294152392203, 0.935875664500886, 0.9376845835794447, 0.9398257531010041, 0.9391612522150029, 0.9390135853514472, 0.9434435912581217, 0.9442557590076787, 0.9476890135853514, 0.9462861783815711, 0.9482796810395747, 0.9490918487891317, 0.9501255168340225, 0.9499409332545776, 0.9511222681630243, 0.9512330183106911, 0.9532265209686946, 0.953706438275251, 0.9516021854695806, 0.955330773774365, 0.9559214412285884, 0.9557368576491435, 0.9574350265800354)
drc = c(0.6886075014766686, 0.7485971647962197, 0.8012034849379799, 0.8248301831069108, 0.8468694624926166, 0.862042232722977, 0.8730064973419964, 0.8856689308919079, 0.8913541051388069, 0.8940490253987006, 0.9016538688718252, 0.9071175428233904, 0.9102554636739516, 0.9141686355581807, 0.9142055522740697, 0.9151653868871825, 0.919595392793857, 0.9230286473715298, 0.9227702303603071, 0.9262773183697578, 0.9281231541642055, 0.9287507383343178, 0.9328484937979917, 0.9318517424689899, 0.9348050797401063, 0.935912581216775, 0.935063496751329, 0.9376845835794447, 0.9392720023626698, 0.9391612522150029, 0.939124335499114, 0.9434066745422327, 0.9444034258712345, 0.9476520968694625, 0.9466184288245718, 0.9477628470171293, 0.9487965150620201, 0.949719432959244, 0.9498301831069108, 0.9508638511518015, 0.9514176018901358, 0.9533003544004726, 0.9538541051388069, 0.9511222681630243, 0.9555522740696988, 0.9557737743650325, 0.9554415239220319, 0.9576196101594802)

#contraintes métier small
#oracle = c(0.6661971830985915, 0.6747404844290658, 0.6904276985743381, 0.7524271844660194, 0.7285714285714285, 0.7352941176470589, 0.7448979591836735, 0.784452296819788, 0.756198347107438, 0.7644444444444445, 0.8193832599118943, 0.7692307692307693, 0.7918781725888325, 0.8078817733990148, 0.806282722513089, 0.8342245989304813, 0.8536585365853658, 0.8031914893617021, 0.89937106918239, 0.8176100628930818, 0.8522727272727273, 0.821656050955414, 0.8841463414634146, 0.8616352201257862, 0.8609271523178808, 0.8372093023255814, 0.8913043478260869, 0.9057971014492754, 0.8689655172413793, 0.916030534351145, 0.8759124087591241, 0.9078014184397163, 0.9084967320261438, 0.9173553719008265, 0.8992248062015504, 0.92, 0.926829268292683, 0.9448275862068966, 0.9652777777777778, 0.8983050847457628, 0.8740740740740741, 0.940677966101695, 0.9609375, 0.9642857142857143, 0.9655172413793104, 0.9916666666666667, 0.9478260869565217, 0.9777777777777777)
#jointree = c(0.6619718309859155, 0.6747404844290658, 0.6904276985743381, 0.7524271844660194, 0.7257142857142858, 0.7411764705882353, 0.7414965986394558, 0.7632508833922261, 0.7148760330578512, 0.7511111111111111, 0.788546255506608, 0.7104072398190046, 0.7715736040609137, 0.7684729064039408, 0.774869109947644, 0.7486631016042781, 0.75, 0.7659574468085106, 0.8553459119496856, 0.7861635220125787, 0.8125, 0.6815286624203821, 0.7987804878048781, 0.779874213836478, 0.7880794701986755, 0.7441860465116279, 0.7753623188405797, 0.7898550724637681, 0.7586206896551724, 0.8244274809160306, 0.7883211678832117, 0.851063829787234, 0.7973856209150327, 0.8264462809917356, 0.689922480620155, 0.8, 0.8536585365853658, 0.8068965517241379, 0.8194444444444444, 0.7966101694915254, 0.8074074074074075, 0.8050847457627118, 0.7734375, 0.8035714285714286, 0.8068965517241379, 0.8333333333333334, 0.8434782608695652, 0.8296296296296296)
#drc = c(0.6619718309859155, 0.6730103806228374, 0.6924643584521385, 0.7402912621359223, 0.7314285714285714, 0.7382352941176471, 0.7414965986394558, 0.7597173144876325, 0.7272727272727273, 0.7511111111111111, 0.788546255506608, 0.7104072398190046, 0.766497461928934, 0.7783251231527094, 0.7696335078534031, 0.7379679144385026, 0.7621951219512195, 0.7606382978723404, 0.8490566037735849, 0.7861635220125787, 0.8011363636363636, 0.7006369426751592, 0.8109756097560976, 0.7861635220125787, 0.7947019867549668, 0.7286821705426356, 0.7681159420289855, 0.7971014492753623, 0.7517241379310344, 0.8396946564885496, 0.7956204379562044, 0.8581560283687943, 0.803921568627451, 0.8264462809917356, 0.6821705426356589, 0.8066666666666666, 0.8617886178861789, 0.8, 0.8263888888888888, 0.7966101694915254, 0.8, 0.8220338983050848, 0.765625, 0.8035714285714286, 0.8137931034482758, 0.8333333333333334, 0.8434782608695652, 0.8444444444444444)

#contraintes métier + random small
#oracle = c(0.6147540983606558, 0.6391752577319587, 0.5454545454545454, 0.7638888888888888, 0.6610169491525424, 0.6545454545454545, 0.7021276595744681, 0.6190476190476191, 0.775, 0.7241379310344828, 0.7619047619047619, 0.8275862068965517, 0.8235294117647058, 0.8235294117647058, 0.6666666666666666, 0.7906976744186046, 0.84, 0.9393939393939394, 0.92, 0.7272727272727273, 0.8108108108108109, 0.967741935483871, 0.896551724137931, 0.7333333333333333, 0.9, 0.75, 0.9642857142857143, 0.92, 0.9666666666666667, 0.9705882352941176, 0.9166666666666666, 0.9411764705882353, 0.9047619047619048, 0.9583333333333334, 0.9, 0.9310344827586207, 0.9565217391304348, 0.9285714285714286, 0.9411764705882353, 0.9230769230769231, 0.9285714285714286, 1.0, 0.8846153846153846, 0.9615384615384616, 0.96, 0.9615384615384616, 0.85, 1.0)
#jointree = c(0.6147540983606558, 0.6494845360824743, 0.5454545454545454, 0.7361111111111112, 0.6271186440677966, 0.6363636363636364, 0.6808510638297872, 0.6190476190476191, 0.75, 0.7931034482758621, 0.7619047619047619, 0.7586206896551724, 0.7352941176470589, 0.7647058823529411, 0.5925925925925926, 0.6511627906976745, 0.76, 0.8787878787878788, 0.76, 0.8181818181818182, 0.8108108108108109, 0.7419354838709677, 0.8275862068965517, 0.6, 0.7333333333333333, 0.5, 0.7857142857142857, 0.88, 0.9, 0.8235294117647058, 0.75, 0.6176470588235294, 0.7619047619047619, 0.7083333333333334, 0.65, 0.6896551724137931, 0.782608695652174, 0.7857142857142857, 0.7941176470588235, 0.9230769230769231, 0.7857142857142857, 0.84, 0.7692307692307693, 0.8461538461538461, 0.76, 0.7692307692307693, 0.6, 0.8181818181818182)
#drc = c(0.6147540983606558, 0.6494845360824743, 0.5353535353535354, 0.7222222222222222, 0.6271186440677966, 0.6363636363636364, 0.6808510638297872, 0.6190476190476191, 0.75, 0.7931034482758621, 0.7380952380952381, 0.7931034482758621, 0.7647058823529411, 0.7352941176470589, 0.5555555555555556, 0.6511627906976745, 0.76, 0.8787878787878788, 0.76, 0.8181818181818182, 0.8108108108108109, 0.7419354838709677, 0.8275862068965517, 0.6333333333333333, 0.7666666666666667, 0.55, 0.7857142857142857, 0.92, 0.9, 0.7647058823529411, 0.7222222222222222, 0.6176470588235294, 0.7142857142857143, 0.7083333333333334, 0.7, 0.6896551724137931, 0.782608695652174, 0.8214285714285714, 0.7941176470588235, 0.9230769230769231, 0.8214285714285714, 0.84, 0.7692307692307693, 0.8461538461538461, 0.76, 0.7307692307692307, 0.6, 0.8181818181818182)


#pas de contraintes medium
#oracle = c(0.7614635465981334, 0.7969701068578385, 0.811713783308535, 0.8409982415798729, 0.857770864331124, 0.8748140132557825, 0.8911808467469228, 0.898552684972271, 0.9148518869200595, 0.9180982010009469, 0.9305424049776816, 0.9390639794400109, 0.9455566076017855, 0.949479237116191, 0.953198972000541, 0.9570539699715948, 0.9584742323819829, 0.9592858109022048, 0.9638847558501284, 0.9642905451102394, 0.9672663330177195, 0.9703773840119031, 0.9724739618558096, 0.9734208034627351, 0.9736913296361422, 0.9762613282835114, 0.9770729068037333, 0.9778844853239551, 0.9745029081563641, 0.976058433653456, 0.9786284323008251, 0.9769376437170296, 0.9803192208846205, 0.9807250101447315, 0.9787636953875287, 0.9798458000811578, 0.9817394832950088, 0.9797781685378061, 0.9806573786013797, 0.9802515893412688, 0.983497903422156, 0.9811307994048424, 0.982821587988638, 0.980927904774787)
#jointree = c(0.761598809684837, 0.7965643175977276, 0.8111050994183687, 0.8403219261463547, 0.8545921817935885, 0.8717705938049506, 0.8863790071689436, 0.8930068984174219, 0.9076829433247666, 0.9092384688218585, 0.9206005681049642, 0.9290545110239415, 0.9352089814689571, 0.9399431895035845, 0.9413634519139726, 0.9467739753821183, 0.9483295008792101, 0.9483971324225619, 0.9518463411335046, 0.9520492357635602, 0.9566481807114838, 0.9568510753415393, 0.9616529149195184, 0.9619910726362776, 0.9611118625727039, 0.9626673880697958, 0.9649668605437576, 0.964087650480184, 0.9627350196131476, 0.9643581766535912, 0.9667929122142568, 0.9628026511564994, 0.9671987014743676, 0.9672663330177195, 0.9638847558501284, 0.9689571216015149, 0.9669958068443122, 0.9648992290004058, 0.9676721222778304, 0.9684160692547004, 0.9689571216015149, 0.9654402813472204, 0.9682808061679967, 0.9676044907344785)
#drc = c(0.761598809684837, 0.7959556337075612, 0.8109022047883133, 0.8407277154064656, 0.8549979710536995, 0.8722440146084134, 0.8870553226024618, 0.8927363722440146, 0.9082239956715812, 0.908697416475044, 0.9207358311916678, 0.9289192479372379, 0.9354118760990126, 0.9400108210469363, 0.9415663465440282, 0.9464358176653591, 0.9486000270526174, 0.9493439740294873, 0.9519816042202083, 0.9527255511970784, 0.9572568646016502, 0.9575273907750574, 0.9621263357229812, 0.9629379142432031, 0.9613147572027594, 0.9627350196131476, 0.9657784390639794, 0.9648992290004058, 0.9632084404166104, 0.9645610712836467, 0.9668605437576085, 0.9640200189368321, 0.968551332341404, 0.9678750169078858, 0.9652373867171649, 0.9688218585148113, 0.9680102799945894, 0.9655079128905721, 0.9688894900581632, 0.9694305424049777, 0.9707155417286623, 0.9659813336940349, 0.9692276477749222, 0.9683484377113486)

#contraintes métier medium
#oracle = c(0.7856277266117305, 0.7753894979803808, 0.7798350446052853, 0.7739028213166145, 0.7821978021978022, 0.793451501723289, 0.7926254505128916, 0.8042312276519666, 0.8013371537726839, 0.7937478763166836, 0.8259398496240602, 0.8176025487853444, 0.837055417700579, 0.8420387531592249, 0.851716247139588, 0.8496888463379607, 0.8683001531393568, 0.847814910025707, 0.8600929272070211, 0.8408590308370044, 0.8648332358104155, 0.8661087866108786, 0.8726076555023924, 0.8872727272727273, 0.8691358024691358, 0.8601134215500945, 0.8699551569506726, 0.8683229813664596, 0.8816568047337278, 0.8735785953177257, 0.8761904761904762, 0.8919463087248322, 0.8867028493894166, 0.8922651933701657, 0.8822299651567944, 0.8928823114869626, 0.8854382332643203, 0.8973998594518623, 0.9050359712230216, 0.9022611232676878, 0.906025824964132, 0.9053213545266068, 0.8976545842217484, 0.8849431818181818)
#jointree = c(0.7844158991759573, 0.773802654356607, 0.774617067833698, 0.770180250783699, 0.7764835164835164, 0.7823732151649434, 0.783199334627114, 0.7929082240762813, 0.792741165234002, 0.7838939857288482, 0.8075187969924812, 0.7992831541218638, 0.8130686517783292, 0.8142375737152485, 0.8265446224256293, 0.8252752513164193, 0.846350178662583, 0.8277634961439588, 0.8275684047496128, 0.8094713656387665, 0.826214160327677, 0.8338314405260012, 0.8415071770334929, 0.8503030303030303, 0.8364197530864198, 0.8191556395715186, 0.8417680973734786, 0.8372670807453416, 0.8382642998027613, 0.8461538461538461, 0.8231292517006803, 0.8395973154362416, 0.8453188602442334, 0.850828729281768, 0.848780487804878, 0.8463706835799859, 0.8461007591442374, 0.8475052705551651, 0.8647482014388489, 0.8409919766593728, 0.8500717360114778, 0.8534899792674498, 0.8528784648187633, 0.8345170454545454)
#drc = c(0.7844158991759573, 0.7751009809578765, 0.7769735734724794, 0.7719435736677116, 0.7773626373626373, 0.7836041358936484, 0.7859717216523426, 0.7964839094159714, 0.7949697548551417, 0.7828746177370031, 0.8082706766917294, 0.7976901632815612, 0.8167907361455748, 0.8180286436394272, 0.8283752860411899, 0.8267113451412159, 0.846350178662583, 0.8277634961439588, 0.8306659783169851, 0.8061674008810573, 0.8291398478642481, 0.8362223550508069, 0.8462918660287081, 0.8521212121212122, 0.8395061728395061, 0.8248267170762444, 0.8411274823830878, 0.8366459627329192, 0.8395792241946088, 0.8448160535117056, 0.8251700680272109, 0.8375838926174497, 0.8480325644504749, 0.8522099447513812, 0.8501742160278746, 0.8470754052149401, 0.8461007591442374, 0.8510189739985945, 0.8647482014388489, 0.8424507658643327, 0.8493543758967002, 0.8527988942639945, 0.853589196872779, 0.8345170454545454)

#contraintes métier + random medium
#oracle = c(0.6649484536082474, 0.6934523809523809, 0.7210144927536232, 0.7090163934426229, 0.7962962962962963, 0.7527472527472527, 0.7941176470588235, 0.7635135135135135, 0.8135593220338984, 0.8373493975903614, 0.8548387096774194, 0.8515625, 0.8583333333333333, 0.8818181818181818, 0.8305084745762712, 0.7766990291262136, 0.8571428571428571, 0.8125, 0.8795180722891566, 0.8426966292134831, 0.8823529411764706, 0.788235294117647, 0.8928571428571429, 0.863013698630137, 0.8666666666666667, 0.8602150537634409, 0.9156626506024096, 0.8117647058823529, 0.8470588235294118, 0.8846153846153846, 0.863013698630137, 0.797752808988764, 0.9135802469135802, 0.8507462686567164, 0.8947368421052632, 0.7692307692307693, 0.9605263157894737, 0.8987341772151899, 0.8548387096774194, 0.8611111111111112, 0.835820895522388, 0.8051948051948052, 0.8412698412698413, 0.8028169014084507)
#jointree = c(0.6675257731958762, 0.6994047619047619, 0.7246376811594203, 0.7049180327868853, 0.7870370370370371, 0.7527472527472527, 0.7470588235294118, 0.75, 0.7796610169491526, 0.8433734939759037, 0.8145161290322581, 0.8359375, 0.825, 0.8181818181818182, 0.8135593220338984, 0.7281553398058253, 0.8367346938775511, 0.8125, 0.8554216867469879, 0.797752808988764, 0.8470588235294118, 0.7411764705882353, 0.8690476190476191, 0.7671232876712328, 0.8111111111111111, 0.8602150537634409, 0.891566265060241, 0.788235294117647, 0.8, 0.7948717948717948, 0.7808219178082192, 0.7865168539325843, 0.8641975308641975, 0.8059701492537313, 0.868421052631579, 0.7538461538461538, 0.8947368421052632, 0.8227848101265823, 0.7741935483870968, 0.8055555555555556, 0.8208955223880597, 0.7792207792207793, 0.7619047619047619, 0.7746478873239436)
#drc = c(0.6675257731958762, 0.6994047619047619, 0.7210144927536232, 0.6967213114754098, 0.7731481481481481, 0.7582417582417582, 0.7470588235294118, 0.7432432432432432, 0.7740112994350282, 0.8433734939759037, 0.8225806451612904, 0.8203125, 0.825, 0.8181818181818182, 0.8135593220338984, 0.7281553398058253, 0.8367346938775511, 0.8125, 0.8554216867469879, 0.797752808988764, 0.8470588235294118, 0.7411764705882353, 0.8690476190476191, 0.7671232876712328, 0.8111111111111111, 0.8602150537634409, 0.891566265060241, 0.788235294117647, 0.8, 0.8076923076923077, 0.7808219178082192, 0.7865168539325843, 0.8641975308641975, 0.8059701492537313, 0.868421052631579, 0.7538461538461538, 0.8947368421052632, 0.8227848101265823, 0.7741935483870968, 0.8055555555555556, 0.8208955223880597, 0.7792207792207793, 0.7619047619047619, 0.7746478873239436)



#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-100*oracle
Naif = 100-100*Naif
jointree = 100-100*jointree
wmv = 100-100*wmv
vpop = 100-100*vpop
vnaif = 100-100*vnaif
drc = 100-100*drc

nb_val = length(jointree)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*vpop)
min_val_erreur = min(min_val_erreur,100-100*vnaif)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*vpop)
max_val_erreur = max(max_val_erreur,100-100*vnaif)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

#fin parametres graphes
#--------------------------------------------------------------------------------------------

(ggplot(NULL, aes(size)) + #ggtitle(paste("Précision sur \"\" \navec contraintes. Tightness =", tightness)) +#scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
    ylab("Taux d'erreur (%)") + xlab("Nombre de variables configurées") + theme_bw() #+ theme(legend.position="bottom")
  +geom_line(aes(y=jointree, colour="Bayesian network"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointree, shape="Bayesian network"), colour="springgreen4", fill="springgreen4") 
 +geom_line(aes(y=drc, colour="DRC"), colour="blue", linetype = "dotted") + geom_point(aes(y=drc, shape="DRC"), colour="blue", fill="blue") 
 +geom_line(aes(y=oracle, colour="Oracle"), colour="black", linetype = "dotted") + geom_point(aes(y=oracle, shape="Oracle"), colour="black", fill="black") 
  + scale_colour_manual(name = 'Legend', guide = 'legend',
                        limits = c(NULL
                                   ,'Bayesian network' #jointree
                                   ,'DRC'
                                   ,'Oracle' #oracle
                        ),
                        values =c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'DRC'='blue'
                                  ,'Oracle'='black' #oracle
                        ))
  + scale_shape_manual(name = 'Legend', guide = 'legend',
                       limits = c(NULL
                                  ,'Bayesian network' #jointree
                                  ,'DRC'
                                  ,'Oracle' #oracle
                       ),
                       values =c(NULL
                                 ,'Bayesian network'=21 #jointree
                                 ,'DRC'=20
                                 ,'Oracle'=4 #oracle
                       ))
  
  + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                                               ,'Bayesian network'='springgreen4' #jointree
                                                               ,'DRC'='blue'
                                                               ,'Oracle'='black' #oracle
  ),
  fill = c(NULL
           ,'Bayesian network'='springgreen4' #jointree
           ,'DRC'='blue'
           ,'Oracle'='black' #oracle
  ))))
)
