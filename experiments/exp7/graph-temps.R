library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "insurance"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result

#pas de contraintes small
oracle = c(1.8150012213895452, 0.716808677753987, 0.5945102299173065, 0.5144786841774955, 0.4456495488038984, 0.38957311351890134, 0.3406463526653869, 0.3064095066450089, 0.2716098961532782, 0.24588933402244537, 0.21820655164648553, 0.1962463210646781, 0.17943992476373302, 0.16066920341110455, 0.14737426746160662, 0.13518704241730656, 0.11980011518015357, 0.10727554562906085, 0.0986404228809805, 0.08745030873449498, 0.08260201380685174, 0.07357913456142942, 0.06783344093325458, 0.0619310766760189, 0.05503789563644418, 0.04962320950236267, 0.04595651188718251, 0.04110981246308328, 0.03766498368281158, 0.03492908967070289, 0.03192384627879504, 0.02828187223124631, 0.026089797548730066, 0.023682026690785587, 0.02171078761813349, 0.019838797290313053, 0.018819730212640284, 0.017473851594802126, 0.015934425686650915, 0.015287954592439456, 0.014374064530419374, 0.013172249926166568, 0.012542780751624336, 0.011963966479621974, 0.011388636739515652, 0.010889022740696988, 0.01044356563792085, 0.010145927089486119)
jointree = c(0.03933311532782044, 0.03721214467660957, 0.041267421921145894, 0.04151943624483166, 0.04294228979621973, 0.041665221241878325, 0.04195557748818665, 0.04096928171145895, 0.040885062130832844, 0.039270912581216774, 0.03905538304784406, 0.04041512023774365, 0.03664986255906674, 0.0367865704001772, 0.03794206774217366, 0.03694487248966332, 0.034573978883638515, 0.03495308719728293, 0.03297391368871825, 0.03264864740844654, 0.033056199867099824, 0.031192906674542234, 0.030962359310395746, 0.03132714991878322, 0.029273945104843473, 0.029100464559952747, 0.02777355090815121, 0.027912429119905494, 0.027900613371234496, 0.026660494019492026, 0.025611832841110453, 0.025655198501181337, 0.02592915571470762, 0.025316870902244538, 0.024129212714116954, 0.02352173733756645, 0.023020863814235085, 0.022476259746012996, 0.02194642251181335, 0.021117049099232132, 0.020480203706438275, 0.02064643642941524, 0.019921673803898404, 0.020065069920259894, 0.019473036510632015, 0.01803569152392203, 0.017599578078854105, 0.016685174468399292)
drc = c(0.010713109125812168, 1.2391867427643237, 2.5395946810395746, 2.8008886005242175, 5.8293673308476075, 3.330828808365328, 3.108402488555818, 2.858523822024513, 2.6194580801461904, 2.5081924296736564, 2.273301640209687, 2.181365276284702, 1.9901784723493798, 1.8511977010853515, 1.6538222295112226, 1.5308213857058477, 1.395944813533668, 1.2387700898552865, 1.1752341240032487, 1.0515395576269935, 0.937310816930006, 0.8736202839633787, 0.7746963733387477, 0.7264007570510927, 0.6388874580626107, 0.5887323639249852, 0.5410975544890727, 0.47413164604252805, 0.4316457426535735, 0.39390836252215, 0.34795593524808033, 0.3074436875369167, 0.2782809974158299, 0.23920746611045482, 0.21661283465002953, 0.20362252454961607, 0.17000440951712936, 0.15991284952746604, 0.13646250601742468, 0.11956592756940343, 0.10298659003987005, 0.08885829780714707, 0.0789330578484938, 0.07163731054341406, 0.06443726602185469, 0.05222118004282339, 0.04676241505463674, 0.040103032818960424)

#contraintes métier small
oracle = c(3.1546306225352114, 1.2631136660899653, 1.1269793747454175, 0.9391219830097087, 0.8474004028571429, 0.8162585617647059, 0.8398303367346939, 0.7450781130742049, 0.5942825330578513, 0.6135867911111111, 0.3986221629955947, 0.3866200452488688, 0.3932269543147208, 0.3461727684729064, 0.31979275916230365, 0.25907129411764707, 0.3039610792682927, 0.1814736595744681, 0.14411121383647799, 0.2157246540880503, 0.13721427272727274, 0.20883710191082802, 0.1173590487804878, 0.09998430817610063, 0.16569127814569537, 0.13538913178294573, 0.09593139855072463, 0.07972733333333333, 0.07655681379310345, 0.05906471755725191, 0.07267178832116789, 0.10873059574468086, 0.09176964705882353, 0.049429148760330575, 0.04377617829457364, 0.041360306666666666, 0.0460730162601626, 0.061600710344827586, 0.037584458333333334, 0.0372574406779661, 0.049014444444444444, 0.03390391525423729, 0.0293512421875, 0.02754924107142857, 0.03388108965517241, 0.030597158333333332, 0.029678156521739132, 0.025674125925925925)
jointree = c(0.09473900422535211, 0.04676131141868512, 0.053484993890020364, 0.07074632038834952, 0.050695694285714285, 0.06096809117647059, 0.05486319727891156, 0.060134858657243814, 0.05066232644628099, 0.04650599111111111, 0.05354592511013216, 0.04808997285067873, 0.04831991878172589, 0.049723857142857146, 0.04435187434554974, 0.04591923529411765, 0.04583701219512195, 0.04614630319148936, 0.043533981132075475, 0.04219292452830189, 0.043221386363636365, 0.04688271974522293, 0.041108884146341465, 0.03942957232704403, 0.04032604635761589, 0.0383287984496124, 0.036038115942028985, 0.0376446231884058, 0.0384288, 0.037696, 0.03827835766423358, 0.05744887943262411, 0.034096686274509805, 0.03460985950413223, 0.03260989147286822, 0.031501313333333336, 0.046256252032520324, 0.03139556551724138, 0.03287593055555556, 0.027828101694915255, 0.029326385185185187, 0.03464698305084746, 0.0286524609375, 0.031122401785714286, 0.029403455172413794, 0.03915768333333333, 0.026508530434782608, 0.026028207407407408)
drc = c(0.17684261690140846, 1.3021586920415225, 3.267291904276986, 2.4275932378640777, 34.34872193142857, 20.505020179411765, 16.12337731632653, 14.752074388692579, 11.616629520661157, 12.142846337777778, 11.09474670044053, 15.237451140271494, 11.860374177664974, 9.68719933004926, 8.07212409947644, 6.971502427807486, 7.987782975609756, 6.241745196808511, 5.171910358490566, 5.457074031446541, 4.234617693181818, 7.208544248407644, 6.74488018902439, 4.301505672955975, 6.582904774834437, 3.81839184496124, 3.329941, 3.984254384057971, 2.4683625862068967, 1.6310551679389313, 3.5589478467153284, 2.1097948581560284, 2.2877721307189542, 2.0307211983471074, 1.0198197906976745, 1.21958782, 1.939337861788618, 1.2506283862068965, 1.1950229375, 1.1210951779661016, 1.0168690962962963, 0.841627406779661, 0.328425921875, 0.7037751696428571, 0.3434383379310345, 0.35373715, 0.459783052173913, 0.4162418962962963)

#contraintes métier + random small
oracle = c(2.588152352459016, 1.714332731958763, 1.2990869191919192, 1.172357986111111, 0.5989331525423729, 0.8492285272727272, 1.2130347872340426, 0.6788509761904762, 0.767275525, 0.5336753793103448, 0.4139487142857143, 0.27622775862068966, 0.3737297647058824, 0.6145175, 0.31074885185185186, 0.4234858837209302, 0.24952024, 0.27473993939393937, 0.09216276, 0.19654204545454546, 0.18238705405405406, 0.1183808064516129, 0.12891410344827586, 0.12533923333333333, 0.12216623333333333, 0.18458215, 0.07728253571428571, 0.08165632, 0.08350543333333334, 0.053269882352941174, 0.09144125, 0.11028644117647059, 0.046419714285714286, 0.05178225, 0.0460822, 0.06373834482758621, 0.06814326086956522, 0.03901942857142857, 0.051939, 0.027039923076923076, 0.05245457142857143, 0.03969108, 0.03126573076923077, 0.03060826923076923, 0.03246676, 0.03306330769230769, 0.03424495, 0.032634363636363635)
jointree = c(0.12867292622950818, 0.08097245360824742, 0.07245165656565657, 0.08241525, 0.06166433898305085, 0.06928898181818181, 0.07342027659574468, 0.06362414285714285, 0.061167825, 0.06529765517241379, 0.06037209523809524, 0.04606506896551724, 0.06247314705882353, 0.0715209705882353, 0.05437444444444445, 0.060840744186046514, 0.0572204, 0.05973963636363636, 0.04416224, 0.044461909090909094, 0.04756421621621622, 0.05027806451612903, 0.05906003448275862, 0.046472233333333335, 0.042607266666666664, 0.043524, 0.045838642857142856, 0.04480692, 0.04488743333333333, 0.05184388235294118, 0.048703777777777776, 0.039192470588235294, 0.03681257142857143, 0.040707791666666666, 0.03867155, 0.04457, 0.049315739130434785, 0.03813375, 0.04417032352941176, 0.041948769230769234, 0.034525214285714284, 0.03879604, 0.035320346153846154, 0.03755423076923077, 0.04220768, 0.04468661538461539, 0.04194415, 0.030615545454545454)
drc = c(0.25313668852459015, 1.4100024639175257, 1.304600414141414, 13.885415208333333, 104.94570791525423, 78.08774236363637, 61.82825468085107, 33.441238523809524, 49.945964725, 58.5211904137931, 28.301858, 27.521517620689654, 39.1962919117647, 41.33714423529412, 34.297656777777775, 19.92308541860465, 33.26216092, 16.26619675757576, 13.36381344, 35.64023704545455, 13.511361594594595, 25.004798451612903, 12.473915241379311, 7.9972984333333335, 8.012238466666666, 20.23292955, 16.819297464285714, 6.69665956, 8.075404133333333, 9.709357411764707, 8.164805416666667, 3.603115176470588, 4.612058476190477, 3.4535614166666666, 3.81039865, 4.582617310344828, 4.801288434782609, 8.587532892857142, 2.2447362352941176, 9.98170046153846, 2.195866035714286, 0.7973496, 1.9655236923076924, 0.7488401923076923, 2.44739932, 1.9708258461538462, 0.48042685, 0.44006022727272726)


#pas de contraintes medium
oracle = c(9.68338306350602, 5.330732466725281, 4.533543603340998, 3.8113867346138237, 3.347955071216015, 2.919835847558501, 2.5565442456377654, 2.2662050313134046, 2.000406142026241, 1.7463912200054106, 1.5362447661977547, 1.3523774018666306, 1.1943975822399566, 1.1049628422156093, 0.9480707996753686, 0.8206037346814554, 0.7402299566481807, 0.6238852415122413, 0.5612661329636143, 0.4950247251454078, 0.4383899333829298, 0.3846924628702827, 0.34197896009738943, 0.2903425960367916, 0.25158791255241447, 0.21536729189774112, 0.18600925781144326, 0.163126374408224, 0.15372238604084945, 0.12930493453266603, 0.11066248802921683, 0.09682509082916273, 0.08207082841877451, 0.06799543703503313, 0.05880558494521845, 0.052743209454889764, 0.0476082563235493, 0.039095428648721765, 0.03764161984309482, 0.031951737386717166, 0.029013830380089273, 0.027341225145407818, 0.02556232794535371, 0.025445838090085215)
jointree = c(0.08788636142296767, 0.08446053888813743, 0.09953775280670905, 0.10303282693088056, 0.10291492607872312, 0.0995497151359394, 0.09580983815771676, 0.09188813668334911, 0.0881204364939808, 0.08412340660083863, 0.07957603489787637, 0.07615480495062897, 0.07233158196943054, 0.06821821175436224, 0.06469191539293927, 0.06091775375355066, 0.057798020086568376, 0.05487753002840525, 0.05170126085486271, 0.04899252610577574, 0.04656875470039226, 0.04435206147707291, 0.04211617658595969, 0.039886094007845256, 0.038080654673339646, 0.036735561612335994, 0.03480343520898147, 0.03325541397267685, 0.03181836838901664, 0.030510447653185446, 0.029341487623427566, 0.02836755065602597, 0.02719099655079129, 0.026168267076964697, 0.025275797037738402, 0.02447983538482348, 0.023755169214121467, 0.02303007824969566, 0.022408363113756255, 0.02180652461788178, 0.02154024272960909, 0.020752794873529015, 0.020257628973353172, 0.01988857459759232)
drc = c(0.016950982551061814, 4.271118912958204, 13.765909570472068, 17.626967435885298, 32.78403036703639, 24.332731775666172, 23.907234174286486, 20.834237891992426, 19.527853093534425, 17.122223089544164, 15.637928228391722, 15.29595524015961, 13.188647885026377, 11.13761622129041, 10.986317099756526, 9.822447353510077, 7.847761499797105, 7.069774395238739, 6.322033535709455, 5.798743028811037, 4.92050485804139, 4.361948647301501, 3.4748746530501826, 3.007493762275125, 2.932095536994454, 2.442274577505749, 2.0555226880156905, 1.8809824045042607, 1.417038946232923, 1.1371667388746112, 1.0236637536859192, 0.7826935131205194, 0.7126387935208981, 0.7637336439199243, 0.3920398633842824, 0.33914335249560396, 0.31003807101312053, 0.2039679398079264, 0.17582520384147166, 0.12304582192614635, 0.0839495488299743, 0.07458874962802652, 0.047189277289327744, 0.033699971527120245)

#contraintes métier medium
oracle = c(10.86755673763936, 6.393349793998846, 5.721099905571452, 5.384239877938872, 5.018129045714286, 3.821554909896603, 3.9772498464097588, 3.4919640235399285, 3.236688418019739, 2.7168008049609242, 2.953054982706767, 2.052104368379132, 2.255883064929694, 1.7754150648694187, 1.5784385757437072, 1.2746262939205362, 1.143804787136294, 1.0810372133676092, 0.807944055240062, 0.8036724542951542, 0.6263893563487419, 0.5696524273759713, 0.5201598277511962, 0.3732663109090909, 0.3728899796296296, 0.39730537870195337, 0.3420876976297245, 0.27343031304347826, 0.23436451150558843, 0.17487216789297658, 0.2063837238095238, 0.15654858187919463, 0.1149703263229308, 0.1571060179558011, 0.08445939860627177, 0.07118795912614517, 0.07359048585231194, 0.0654827146872804, 0.05384515107913669, 0.05299791393143691, 0.04797262840746055, 0.04605878921907395, 0.041937320540156364, 0.0414820703125)
jointree = c(0.21058577872031023, 0.18547195585689555, 0.2152470520114459, 0.2194397968260188, 0.2147280397802198, 0.20798815312653865, 0.19922875325755476, 0.18800077651966626, 0.17884507863737664, 0.16857782636765206, 0.15290571428571428, 0.15121673317403425, 0.14425392597187758, 0.1294601647009267, 0.12376477299771167, 0.1141695557683102, 0.10435696579887697, 0.10284375167095115, 0.0901009334021683, 0.08699610077092511, 0.0821333188999415, 0.07712720203227734, 0.07396863397129187, 0.06691407878787879, 0.06249139012345679, 0.06205999117832388, 0.05685787187700192, 0.05503891614906832, 0.050420076265614726, 0.04711808294314381, 0.045106319727891156, 0.04364952416107382, 0.04125643962008141, 0.04076139640883978, 0.03847086968641115, 0.03624324947145877, 0.03439271911663216, 0.03657989318341532, 0.03309350935251799, 0.0314740576221736, 0.03131619225251076, 0.03011070214236351, 0.029111927505330492, 0.028151420454545453)
drc = c(0.016365705768298593, 7.864903721869591, 13.264094768725803, 13.292621279976489, 45.16716640879121, 35.06417451329394, 30.8218497557527, 29.433125781585222, 24.939893027061444, 23.181471479782534, 21.01994327969925, 18.300120851055357, 17.527610300661703, 16.329765139427128, 15.179726487414188, 14.63044229775012, 12.381877066870853, 13.009327841645245, 9.010118531233866, 7.823645807819383, 6.803018775307197, 6.904744677226539, 6.354342376196172, 5.044991444242425, 5.610131758641975, 4.006559916194077, 3.8322286515054453, 3.076978695031056, 2.4451638875739645, 2.2044656093645485, 1.7616086727891156, 1.997014722147651, 1.46828789687924, 1.567872757596685, 0.8382306, 1.3168446187455956, 0.6274075838509316, 0.5455326043569922, 0.3619209215827338, 0.36278868854850477, 0.3246248142037303, 0.21240378714581892, 0.2002485010660981, 0.10863407386363637)

#contraintes métier + random medium
oracle = c(6.9130427963917525, 4.67187475, 3.7710611376811594, 3.2166374918032785, 2.989741175925926, 2.772673313186813, 2.227653211764706, 1.9521457432432432, 1.528678723163842, 1.4820685361445782, 1.441262564516129, 1.627203078125, 1.0340365, 1.2730759090909092, 1.0697283644067797, 0.7205317864077669, 1.0742429081632654, 0.9003708125, 1.0435135180722892, 0.5177740224719101, 0.3472311294117647, 0.8001467294117647, 0.35135888095238094, 0.2604005479452055, 0.3551319111111111, 0.2534285268817204, 0.13452160240963856, 0.34981264705882353, 0.16920195294117646, 0.12316641025641026, 0.1150907397260274, 0.12260432584269663, 0.10009222222222222, 0.08375782089552239, 0.0839613552631579, 0.07717947692307692, 0.06669448684210526, 0.05376982278481013, 0.06400146774193548, 0.04848651388888889, 0.0546605223880597, 0.04818196103896104, 0.053776730158730156, 0.042820901408450705)
jointree = c(0.3459010412371134, 0.37707461607142856, 0.379267518115942, 0.4428088606557377, 0.386585087962963, 0.3758898736263736, 0.5224348705882353, 0.36663729054054056, 0.21728018644067795, 0.2694679578313253, 0.2837286935483871, 0.202310953125, 0.24680036666666666, 0.19332491818181818, 0.19924854237288137, 0.21476664077669902, 0.13701877551020408, 0.14407408333333332, 0.3002829638554217, 0.2857187303370787, 0.2683831411764706, 0.10777644705882353, 0.24846533333333334, 0.07737823287671233, 0.1178829, 0.09792219354838709, 0.19673956626506023, 0.09536895294117648, 0.062183564705882356, 0.10616116666666667, 0.06051027397260274, 0.05720394382022472, 0.05333745679012346, 0.048874089552238806, 0.06567698684210527, 0.05877186153846154, 0.04902088157894737, 0.055609911392405065, 0.041933806451612904, 0.046313791666666666, 0.048954955223880596, 0.040257935064935066, 0.03814820634920635, 0.03418046478873239)
drc = c(0.13879672164948453, 16.995936657738095, 30.374262173913042, 52.337329209016396, 161.91464481944445, 118.26834696153846, 111.74491485882353, 92.2576445945946, 66.00038233333333, 52.341658475903614, 26.210967572580646, 41.2160313125, 37.6284854, 28.31648309090909, 65.65185305932204, 35.89867149514563, 31.057529887755102, 50.264302854166665, 25.928557277108435, 51.9913341011236, 8.193650682352942, 15.356564552941176, 9.81610944047619, 10.68628587671233, 17.851019677777778, 6.415735795698925, 7.7099377469879515, 7.363380282352941, 6.9749962, 2.973205217948718, 13.88383402739726, 2.951295584269663, 2.118536864197531, 1.2143260149253732, 1.4569231184210527, 1.2800654153846154, 1.713847447368421, 3.121039911392405, 3.552979758064516, 2.2534949444444443, 0.819493, 0.2901411688311688, 0.31010457142857145, 0.14679474647887325)



#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul
nb_val = length(jointree)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*vpop)
min_val_erreur = min(min_val_erreur,100-100*vnaif)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*vpop)
max_val_erreur = max(max_val_erreur,100-100*vnaif)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

#fin parametres graphes
#--------------------------------------------------------------------------------------------

(ggplot(NULL, aes(size)) + scale_y_log10() + annotation_logticks(sides="l") +
    ylab("MAP inference time (ms)") + xlab("Evidence size") + theme_bw() #+ theme(legend.position="bottom")
 +geom_line(aes(y=oracle, colour="RC"), colour="red", linetype = "dotted") + geom_point(aes(y=oracle, shape="RC"), colour="red", fill="red") 
 +geom_line(aes(y=jointree, colour="Jointree"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointree, shape="Jointree"), colour="springgreen4", fill="springgreen4") 
 +geom_line(aes(y=drc, colour="DRC"), colour="blue", linetype = "dotted") + geom_point(aes(y=drc, shape="DRC"), colour="blue", fill="blue") 
 + theme(legend.position=c(0.86,0.70), legend.background = element_rect(fill=alpha('blue', 0)))
 + scale_colour_manual(name = 'Legend', guide = 'legend',
                        limits = c(NULL
                                   ,'Jointree' #jointree
                                   ,'RC' #oracle
                                   ,'DRC'
                        ),
                        values =c(NULL
                                  ,'Jointree'='springgreen4' #jointree
                                  ,'RC'='red' #oracle
                                  ,'DRC'='blue'
                        ))
  + scale_shape_manual(name = 'Legend', guide = 'legend',
                       limits = c(NULL
                                  ,'Jointree' #jointree
                                  ,'RC'
                                  ,'DRC'
                       ),
                       values =c(NULL
                                 ,'Jointree'=21 #jointree
                                 ,'RC'=22
                                 ,'DRC'=20
                       ))
  
  + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                                               ,'Bayesian network'='springgreen4' #jointree
                                                               ,'RC'='red' #oracle
                                                               ,'DRC'='blue'
  ),
  fill = c(NULL
           ,'Bayesian network'='springgreen4' #jointree
           ,'RC'='red' #oracle
           ,'DRC'='blue'
  ))))
)
