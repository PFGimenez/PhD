library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "insurance"
taille_img_x = 1024/2
taille_img_y = 720/2

dataset = "naive-bayes"

#oracle = c(0.7770181681962914, 0.810408560311284, 0.8280888710163868, 0.8416839916839917, 0.8590909090909091, 0.8736137037443724, 0.8862495817999331, 0.8941792914910582, 0.9039408866995073, 0.9133405249910105, 0.9165348582552622, 0.9215661746309732, 0.9381209910703057, 0.9385496183206107, 0.935726540847301, 0.9459316893050244, 0.9450785551228683, 0.9471377704738427, 0.9500274574409665, 0.9494239955043552, 0.9562012756909993, 0.9574407312196516, 0.9588489208633093, 0.959065176368123, 0.9605013846378079, 0.9574120789434635, 0.9625373134328358, 0.9642643540669856, 0.9570906877662811, 0.9650274893097129, 0.9661305289205072, 0.9585927770859277, 0.9639085894405043, 0.9668411867364747, 0.967176545570427, 0.9626636495878454, 0.9651426718547341, 0.9645424053665549, 0.9709387755102041, 0.9671729544341009, 0.9637150466045273, 0.9657907783837383, 0.967795210569777, 0.9658956609826101)
if(dataset == "naive-bayes")
{
  # vnaif 0
  Naif = c(0.7506966048965238, 0.7829974300013526, 0.8115311781414852, 0.8357365075071013, 0.8550453131340457, 0.870445015555255, 0.8846746922764778, 0.8968483700798052, 0.9070674962802651, 0.9145204923576356, 0.923346408765048, 0.9291694846476397, 0.9344041661030704, 0.9389692952793183, 0.9427025564723387, 0.9464966860543758, 0.9487488164479914, 0.951859867442175, 0.9549641552820235, 0.955910996888949, 0.9571892330582984, 0.9588529690247531, 0.960854862707967, 0.9610983362640335, 0.9635465981333694, 0.963492492898688, 0.9650142026241039, 0.9640605978628433, 0.9660354389287164, 0.9669619910726363, 0.9671175436223455, 0.9671040173136751, 0.9683078587853374, 0.9691262004598945, 0.9692141214662519, 0.9698363316650886, 0.970188015690518, 0.970485594481266, 0.97156093602056, 0.9706614364939808, 0.9720681725956987, 0.971709725415934, 0.9714527255511971, 0.9720478831326931)
  # vnaif  30
  jointree = c(0.7435773145904023, 0.7788763142706582, 0.8059751855889529, 0.8282652610737268, 0.8464327405067638, 0.8625747952413959, 0.8779531560834652, 0.8881606202284429, 0.898682080225151, 0.9048635604232411, 0.9131166095513567, 0.9187245764069056, 0.9253251521728487, 0.9292209185273198, 0.9306829079529586, 0.9352858465653829, 0.9391356957649093, 0.939627092980263, 0.9440337154898389, 0.9452297779145324, 0.947457750848633, 0.9497962720551633, 0.9500690633516258, 0.9506718861745774, 0.9505185129012077, 0.9512720834455949, 0.9523055534100564, 0.9532697494429895, 0.9534024691358025, 0.9547306383988609, 0.9536984981126014, 0.9560468456077186, 0.9572159921989274, 0.958050282195998, 0.9549462121368545, 0.9565009956853634, 0.9575577998497621, 0.9582170363685967, 0.9584847460491844, 0.9586825840318347, 0.9595415423579662, 0.9579386049708921, 0.9580837037514226, 0.95838269823148)
  # vnaif 60
  wmv = c(0.7435773145904023, 0.7617901242916458, 0.7774230602837409, 0.7924959481361427, 0.8059961046188091, 0.820162879773902, 0.8344285657733265, 0.8442117462025578, 0.8566508824795523, 0.8626236790738373, 0.8731916660898457, 0.8787078813477969, 0.8870767550392216, 0.8925119248921081, 0.8930663041204769, 0.8999436831237094, 0.9058705821908548, 0.9053472649047326, 0.9121128679705908, 0.9130687769114395, 0.9169823416283001, 0.920347445859308, 0.9209197475202886, 0.9215220700152207, 0.9214541229706179, 0.9219836050244677, 0.9228048010107391, 0.9255090426204629, 0.924963785610816, 0.9274589769114672, 0.925498151359487, 0.929114593665278, 0.9308848854152868, 0.9319869619274841, 0.9273987350289329, 0.9292605597790884, 0.9314274017467249, 0.9323912820337359, 0.932738361875883, 0.9332205379648493, 0.9348287993312202, 0.932080218014115, 0.9319737393490711, 0.9327366801845896)
  # vnaif 100
  vpop = c(0.7435773145904023, 0.7456197556627973, 0.7486082824168364, 0.7536350206049296, 0.7586010555592054, 0.7660442260442261, 0.7749145123786075, 0.7797169530831897, 0.7905883105665569, 0.7928425852361048, 0.8017045037102344, 0.8052029462466698, 0.8141736881621757, 0.8184060228452752, 0.8157713340379578, 0.8238666473960592, 0.830376610505451, 0.8275540351422795, 0.8379415055138245, 0.8362925739810162, 0.8422890616199167, 0.8467643821331325, 0.8469417964355498, 0.8455259791679357, 0.8442198668967217, 0.8474597428535763, 0.8474856779121579, 0.8518376478108022, 0.8497997768003677, 0.8544237332633237, 0.8505302474488095, 0.8563024073573168, 0.8605280974949221, 0.8604504756575265, 0.8533599284682578, 0.8551122369995074, 0.8610200237214819, 0.8624085537422622, 0.8630166169578185, 0.8627129517428185, 0.8670540967140192, 0.8599681251811069, 0.8605574812247256, 0.8625)
} else if(dataset == "jointree")
{
  # jointree 0
  Naif = c(0.761598809684837, 0.7965643175977276, 0.8111050994183687, 0.8403219261463547, 0.8545921817935885, 0.8717705938049506, 0.8863790071689436, 0.8930068984174219, 0.9076829433247666, 0.9092384688218585, 0.9206005681049642, 0.9290545110239415, 0.9352089814689571, 0.9399431895035845, 0.9412958203706209, 0.9467739753821183, 0.9483295008792101, 0.9483971324225619, 0.9518463411335046, 0.9520492357635602, 0.9566481807114838, 0.9568510753415393, 0.9616529149195184, 0.9619910726362776, 0.9611118625727039, 0.9626673880697958, 0.9649668605437576, 0.964087650480184, 0.9627350196131476, 0.9643581766535912, 0.9667929122142568, 0.9628026511564994, 0.9671987014743676, 0.9672663330177195, 0.9638847558501284, 0.9689571216015149, 0.9669958068443122, 0.9648992290004058, 0.9676721222778304, 0.9684160692547004, 0.9689571216015149, 0.9654402813472204, 0.9682808061679967, 0.9676044907344785)
  # jointree  30
  jointree = c(0.7780295685894328, 0.8044967503952222, 0.8254036235269688, 0.8441049378587004, 0.8583121609558471, 0.8716987537662853, 0.8853296934671178, 0.891785524057525, 0.9017385646628032, 0.9063331477012561, 0.9145628320809884, 0.9195253194964927, 0.9250803701104783, 0.92851131244121, 0.9297070848124905, 0.9343941836139785, 0.9374416594641314, 0.9393982076518126, 0.9429443908711025, 0.9434016905283353, 0.9454502317772019, 0.9484503770349748, 0.9483331466756262, 0.9493168216208078, 0.9489828805429693, 0.9493283553365921, 0.949949795319379, 0.9519211976703279, 0.9524148148148148, 0.9534055850011867, 0.9507268492490563, 0.9525880377839357, 0.9530513570615959, 0.9548486403283736, 0.9523239247589353, 0.9536591437105875, 0.9541774476254069, 0.9546074583954167, 0.9546818220231555, 0.9554652442638218, 0.954368869524157, 0.9543511417585014, 0.9540037363911615, 0.9540529478922086)
  # jointree 60
  wmv = c(0.7780295685894328, 0.7892587132636363, 0.7994868199245148, 0.8114262560777958, 0.8208298553144129, 0.831858242534677, 0.8440679308024227, 0.8491163445221638, 0.8605897546276366, 0.8646653653721029, 0.8749452020027226, 0.8794998560046079, 0.8862079237414358, 0.8908967014107968, 0.8911054172767203, 0.8976105553916705, 0.9023011816878937, 0.9039224451025312, 0.909330910948988, 0.9091702548586058, 0.9130485459525614, 0.9175406978461902, 0.9168620378719567, 0.9181430745814307, 0.917785183599841, 0.9180562914939376, 0.9183512318382817, 0.9222840521057291, 0.9225494929985514, 0.9244404482836133, 0.9199358701698132, 0.9225682734907095, 0.9235329182673202, 0.9262071978225075, 0.922486879289463, 0.9240105001193195, 0.9254912663755459, 0.9261641632736853, 0.9262947520760828, 0.9273851041055212, 0.9261207286913511, 0.9258961637900915, 0.925373655538483, 0.9257096909523144)
  # jointree 100
  vpop = c(0.7780295685894328, 0.7745315421068649, 0.7728275627970129, 0.7751146878158774, 0.7760331121476907, 0.7806142506142506, 0.7870332375871973, 0.7853659986918, 0.7950990114846924, 0.7941552385229196, 0.8027698185291309, 0.8054771979313587, 0.8101276382747977, 0.8142956040152302, 0.8105785579706815, 0.8174109938815821, 0.8219028741328047, 0.8227336339605038, 0.8307495604922487, 0.8262423227247347, 0.8329953813225188, 0.8386536121893285, 0.8369352833205045, 0.83712005847597, 0.8350998274587134, 0.8365996754462613, 0.8360916613621897, 0.8439117929050814, 0.8427099061248605, 0.846285114203203, 0.8371906889881945, 0.8422369488774682, 0.8440081245768449, 0.8470201454952434, 0.8423550450512415, 0.8435015129125325, 0.8480429777436684, 0.8489729881823298, 0.8484590257065757, 0.850880319338513, 0.848400057397044, 0.8470008693132426, 0.8465482380127094, 0.8475574712643679)
}


#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-oracle*100
Naif = 100-Naif*100
jointree = 100-jointree*100
wmv = 100-wmv*100
vpop = 100-vpop*100

nb_val = length(oracle)
nb_val = length(Naif)
nb_val = length(jointree)
nb_val = length(wmv)
nb_val = length(vpop)


size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

#fin parametres graphes
#--------------------------------------------------------------------------------------------

(ggplot(NULL, aes(size))  + #scale_x_continuous(breaks=size)  + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
   ylab("Error rate (%)") + xlab("Number of configurated attributes") + theme_bw() #+ theme(legend.position="bottom")
 +geom_line(aes(y=Naif, colour="No constraints"), colour="turquoise2", linetype = "dotted") + geom_point(aes(y=Naif, shape="No constraints"), colour="turquoise2", fill="turquoise2") 
 +geom_line(aes(y=wmv, colour="60% constraints"), colour="deeppink2", linetype = "dotted") + geom_point(aes(y=wmv, shape="60% constraints"), colour="deeppink2", fill="deeppink2") 
 +geom_line(aes(y=vpop, colour="100% constraints"), colour="gold2", linetype = "dotted") + geom_point(aes(y=vpop, shape="100% constraints"), colour="gold2", fill="gold2")
 +geom_line(aes(y=jointree, colour="30% constraints"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointree, shape="30% constraints"), colour="springgreen4", fill="springgreen4") 
 # +geom_line(aes(y=drc, colour="DRC"), colour="blue", linetype = "dotted") + geom_point(aes(y=drc, shape="DRC"), colour="blue", fill="blue") 
# +geom_line(aes(y=oracle, colour="Oracle"), colour="black", linetype = "dotted") + geom_point(aes(y=oracle, shape="Oracle"), colour="black", fill="black") 
+ theme(legend.position=c(0.80,0.81), legend.background = element_rect(fill=alpha('blue', 0)))
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                       limits = c(NULL
                                  ,'No constraints' #Naif
                                  ,'30% constraints' #jointree
                                  ,'60% constraints' #wmv
                                  ,'100% constraints' #vpop
#                                  ,'Oracle' #oracle
                       ),
                       values =c(NULL
                                 ,'No constraints'='turquoise2' #Naif
                                 ,'30% constraints'='springgreen4' #jointree
                                 ,'60% constraints'='deeppink2' #wmv
                                 ,'100% constraints'='gold2' #vpop
#                                 ,'Oracle'='black' #oracle
                       ))
 + scale_shape_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                 ,'No constraints' #Naif
                                 ,'30% constraints' #jointree
                                 ,'60% constraints' #wmv
                                 ,'100% constraints' #vpop
#                                 ,'Oracle' #oracle
                      ),
                      values =c(NULL
                                ,'No constraints'=24 #Naif
                                ,'30% constraints'=21 #jointree
                                ,'60% constraints'=25 #wmv
                                ,'100% constraints'=22 #vpop
#                                ,'Oracle'=4 #oracle
                      ))
 
 + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                                              ,'No constraints'='turquoise2' #Naif
                                                              ,'30% constraints'='springgreen4' #jointree
                                                              ,'60% constraints'='deeppink2' #wmv
                                                              ,'100% constraints'='gold2' #vpop
#                                                              ,'Oracle'='black' #oracle
 ),
 fill = c(NULL
          ,'No constraints'='turquoise2' #Naif
          ,'30% constraints'='springgreen4' #jointree
          ,'60% constraints'='deeppink2' #wmv
          ,'100% constraints'='gold2' #vpop
#          ,'Oracle'='black' #oracle
 ))))
)

