library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "insurance"
taille_img_x = 1024/2
taille_img_y = 720/2

dataset = "3-lextree"

#oracle = c(0.7770181681962914, 0.810408560311284, 0.8280888710163868, 0.8416839916839917, 0.8590909090909091, 0.8736137037443724, 0.8862495817999331, 0.8941792914910582, 0.9039408866995073, 0.9133405249910105, 0.9165348582552622, 0.9215661746309732, 0.9381209910703057, 0.9385496183206107, 0.935726540847301, 0.9459316893050244, 0.9450785551228683, 0.9471377704738427, 0.9500274574409665, 0.9494239955043552, 0.9562012756909993, 0.9574407312196516, 0.9588489208633093, 0.959065176368123, 0.9605013846378079, 0.9574120789434635, 0.9625373134328358, 0.9642643540669856, 0.9570906877662811, 0.9650274893097129, 0.9661305289205072, 0.9585927770859277, 0.9639085894405043, 0.9668411867364747, 0.967176545570427, 0.9626636495878454, 0.9651426718547341, 0.9645424053665549, 0.9709387755102041, 0.9671729544341009, 0.9637150466045273, 0.9657907783837383, 0.967795210569777, 0.9658956609826101)
if(dataset == "naive-bayes")
{
  # vnaif 0
  Naif = c(0.7506966048965238, 0.7829974300013526, 0.8115311781414852, 0.8357365075071013, 0.8550453131340457, 0.870445015555255, 0.8846746922764778, 0.8968483700798052, 0.9070674962802651, 0.9145204923576356, 0.923346408765048, 0.9291694846476397, 0.9344041661030704, 0.9389692952793183, 0.9427025564723387, 0.9464966860543758, 0.9487488164479914, 0.951859867442175, 0.9549641552820235, 0.955910996888949, 0.9571892330582984, 0.9588529690247531, 0.960854862707967, 0.9610983362640335, 0.9635465981333694, 0.963492492898688, 0.9650142026241039, 0.9640605978628433, 0.9660354389287164, 0.9669619910726363, 0.9671175436223455, 0.9671040173136751, 0.9683078587853374, 0.9691262004598945, 0.9692141214662519, 0.9698363316650886, 0.970188015690518, 0.970485594481266, 0.97156093602056, 0.9706614364939808, 0.9720681725956987, 0.971709725415934, 0.9714527255511971, 0.9720478831326931)
  # vnaif  30
  jointree = c(0.7435773145904023, 0.7788763142706582, 0.8059751855889529, 0.8282652610737268, 0.8464327405067638, 0.8625747952413959, 0.8779531560834652, 0.8881606202284429, 0.898682080225151, 0.9048635604232411, 0.9131166095513567, 0.9187245764069056, 0.9253251521728487, 0.9292209185273198, 0.9306829079529586, 0.9352858465653829, 0.9391356957649093, 0.939627092980263, 0.9440337154898389, 0.9452297779145324, 0.947457750848633, 0.9497962720551633, 0.9500690633516258, 0.9506718861745774, 0.9505185129012077, 0.9512720834455949, 0.9523055534100564, 0.9532697494429895, 0.9534024691358025, 0.9547306383988609, 0.9536984981126014, 0.9560468456077186, 0.9572159921989274, 0.958050282195998, 0.9549462121368545, 0.9565009956853634, 0.9575577998497621, 0.9582170363685967, 0.9584847460491844, 0.9586825840318347, 0.9595415423579662, 0.9579386049708921, 0.9580837037514226, 0.95838269823148)
  # vnaif 60
  wmv = c(0.7435773145904023, 0.7617901242916458, 0.7774230602837409, 0.7924959481361427, 0.8059961046188091, 0.820162879773902, 0.8344285657733265, 0.8442117462025578, 0.8566508824795523, 0.8626236790738373, 0.8731916660898457, 0.8787078813477969, 0.8870767550392216, 0.8925119248921081, 0.8930663041204769, 0.8999436831237094, 0.9058705821908548, 0.9053472649047326, 0.9121128679705908, 0.9130687769114395, 0.9169823416283001, 0.920347445859308, 0.9209197475202886, 0.9215220700152207, 0.9214541229706179, 0.9219836050244677, 0.9228048010107391, 0.9255090426204629, 0.924963785610816, 0.9274589769114672, 0.925498151359487, 0.929114593665278, 0.9308848854152868, 0.9319869619274841, 0.9273987350289329, 0.9292605597790884, 0.9314274017467249, 0.9323912820337359, 0.932738361875883, 0.9332205379648493, 0.9348287993312202, 0.932080218014115, 0.9319737393490711, 0.9327366801845896)
  # vnaif 100
  vpop = c(0.7435773145904023, 0.7456197556627973, 0.7486082824168364, 0.7536350206049296, 0.7586010555592054, 0.7660442260442261, 0.7749145123786075, 0.7797169530831897, 0.7905883105665569, 0.7928425852361048, 0.8017045037102344, 0.8052029462466698, 0.8141736881621757, 0.8184060228452752, 0.8157713340379578, 0.8238666473960592, 0.830376610505451, 0.8275540351422795, 0.8379415055138245, 0.8362925739810162, 0.8422890616199167, 0.8467643821331325, 0.8469417964355498, 0.8455259791679357, 0.8442198668967217, 0.8474597428535763, 0.8474856779121579, 0.8518376478108022, 0.8497997768003677, 0.8544237332633237, 0.8505302474488095, 0.8563024073573168, 0.8605280974949221, 0.8604504756575265, 0.8533599284682578, 0.8551122369995074, 0.8610200237214819, 0.8624085537422622, 0.8630166169578185, 0.8627129517428185, 0.8670540967140192, 0.8599681251811069, 0.8605574812247256, 0.8625)
} else if(dataset == "jointree")
{
  # jointree 0
  Naif = c(0.761598809684837, 0.7965643175977276, 0.8111050994183687, 0.8403219261463547, 0.8545921817935885, 0.8717705938049506, 0.8863790071689436, 0.8930068984174219, 0.9076829433247666, 0.9092384688218585, 0.9206005681049642, 0.9290545110239415, 0.9352089814689571, 0.9399431895035845, 0.9412958203706209, 0.9467739753821183, 0.9483295008792101, 0.9483971324225619, 0.9518463411335046, 0.9520492357635602, 0.9566481807114838, 0.9568510753415393, 0.9616529149195184, 0.9619910726362776, 0.9611118625727039, 0.9626673880697958, 0.9649668605437576, 0.964087650480184, 0.9627350196131476, 0.9643581766535912, 0.9667929122142568, 0.9628026511564994, 0.9671987014743676, 0.9672663330177195, 0.9638847558501284, 0.9689571216015149, 0.9669958068443122, 0.9648992290004058, 0.9676721222778304, 0.9684160692547004, 0.9689571216015149, 0.9654402813472204, 0.9682808061679967, 0.9676044907344785)
  # jointree  30
  jointree = c(0.7780295685894328, 0.8044967503952222, 0.8254036235269688, 0.8441049378587004, 0.8583121609558471, 0.8716987537662853, 0.8853296934671178, 0.891785524057525, 0.9017385646628032, 0.9063331477012561, 0.9145628320809884, 0.9195253194964927, 0.9250803701104783, 0.92851131244121, 0.9297070848124905, 0.9343941836139785, 0.9374416594641314, 0.9393982076518126, 0.9429443908711025, 0.9434016905283353, 0.9454502317772019, 0.9484503770349748, 0.9483331466756262, 0.9493168216208078, 0.9489828805429693, 0.9493283553365921, 0.949949795319379, 0.9519211976703279, 0.9524148148148148, 0.9534055850011867, 0.9507268492490563, 0.9525880377839357, 0.9530513570615959, 0.9548486403283736, 0.9523239247589353, 0.9536591437105875, 0.9541774476254069, 0.9546074583954167, 0.9546818220231555, 0.9554652442638218, 0.954368869524157, 0.9543511417585014, 0.9540037363911615, 0.9540529478922086)
  # jointree 60
  wmv = c(0.7780295685894328, 0.7892587132636363, 0.7994868199245148, 0.8114262560777958, 0.8208298553144129, 0.831858242534677, 0.8440679308024227, 0.8491163445221638, 0.8605897546276366, 0.8646653653721029, 0.8749452020027226, 0.8794998560046079, 0.8862079237414358, 0.8908967014107968, 0.8911054172767203, 0.8976105553916705, 0.9023011816878937, 0.9039224451025312, 0.909330910948988, 0.9091702548586058, 0.9130485459525614, 0.9175406978461902, 0.9168620378719567, 0.9181430745814307, 0.917785183599841, 0.9180562914939376, 0.9183512318382817, 0.9222840521057291, 0.9225494929985514, 0.9244404482836133, 0.9199358701698132, 0.9225682734907095, 0.9235329182673202, 0.9262071978225075, 0.922486879289463, 0.9240105001193195, 0.9254912663755459, 0.9261641632736853, 0.9262947520760828, 0.9273851041055212, 0.9261207286913511, 0.9258961637900915, 0.925373655538483, 0.9257096909523144)
  # jointree 100
  vpop = c(0.7780295685894328, 0.7745315421068649, 0.7728275627970129, 0.7751146878158774, 0.7760331121476907, 0.7806142506142506, 0.7870332375871973, 0.7853659986918, 0.7950990114846924, 0.7941552385229196, 0.8027698185291309, 0.8054771979313587, 0.8101276382747977, 0.8142956040152302, 0.8105785579706815, 0.8174109938815821, 0.8219028741328047, 0.8227336339605038, 0.8307495604922487, 0.8262423227247347, 0.8329953813225188, 0.8386536121893285, 0.8369352833205045, 0.83712005847597, 0.8350998274587134, 0.8365996754462613, 0.8360916613621897, 0.8439117929050814, 0.8427099061248605, 0.846285114203203, 0.8371906889881945, 0.8422369488774682, 0.8440081245768449, 0.8470201454952434, 0.8423550450512415, 0.8435015129125325, 0.8480429777436684, 0.8489729881823298, 0.8484590257065757, 0.850880319338513, 0.848400057397044, 0.8470008693132426, 0.8465482380127094, 0.8475574712643679)
} else if(dataset == "lextree")
{
  # 1 3-LP-tree
  # lextree 0
  Naif = c(0.7463817124306776, 0.7514270255647234, 0.7564588123900987, 0.762565940754768, 0.7678344379818748, 0.771412146625186, 0.7800284052482077, 0.7816312728256459, 0.7851954551602868, 0.7905180576220749, 0.7945827133775193, 0.7992831056404707, 0.805241444609766, 0.807473285540376, 0.8144799134316245, 0.8173001487893954, 0.8218720411199784, 0.8241512241309347, 0.8307994048424185, 0.8327066143649398, 0.836913296361423, 0.8428648721763831, 0.8442242661977546, 0.850223184093061, 0.8529149195184634, 0.8551332341404031, 0.860185310428784, 0.8636886243744082, 0.8674489381847694, 0.8697754632760719, 0.8724063303124577, 0.8768970647910185, 0.8800284052482078, 0.8825307723522251, 0.8875693223319356, 0.8894832950087921, 0.8922832409035574, 0.8953604761260652, 0.8994995265791965, 0.9026173407277154, 0.9045989449479237, 0.9076288380900852, 0.9100027052617341, 0.913343703503314)
  # lextree  30
  jointree = c(0.7819627232846167, 0.7816077541347444, 0.7824790259209793, 0.7806960035321978, 0.7829969317978563, 0.7837239473164679, 0.7858886754019734, 0.7877027927994666, 0.7874033617259483, 0.7904813412655489, 0.7938584737613695, 0.7958444223554686, 0.800319671195342, 0.8027192748600374, 0.8073402200386327, 0.8102741130630938, 0.8121108046694767, 0.8142501664739074, 0.8223445180594144, 0.8207137733142037, 0.824123350586863, 0.8315462286880874, 0.8358544980928458, 0.8339128963741284, 0.8400220214139267, 0.8414432115888426, 0.8474013437331068, 0.8484771225166212, 0.8537009929975867, 0.8530343844081762, 0.8546071521795876, 0.860184942683885, 0.8641592741118808, 0.8642430952820324, 0.8681044267877412, 0.8741838898823138, 0.8749555132204242, 0.8787904224288082, 0.8815864742897095, 0.8817078613478418, 0.8870433314093931, 0.8913533108818293, 0.8912076339487202, 0.8944897561819873)
  # lextree 60
  wmv = c(0.7819574385573707, 0.7689823821876351, 0.7585652626879, 0.7481667341157426, 0.7437595605618134, 0.739454737270725, 0.7364205991775994, 0.7336858848561219, 0.7304640331205796, 0.7313546764851152, 0.7329211385907606, 0.7332097189780143, 0.7357824003162211, 0.7375358312858313, 0.7409618141535254, 0.7422253121908174, 0.7442176870748299, 0.7434736725172184, 0.755015660712774, 0.7526866394914626, 0.7549162630565444, 0.7631656892364197, 0.7672047065922462, 0.7645201445183228, 0.772817978080005, 0.7726210142443038, 0.7809962694755321, 0.7815380689611177, 0.789980359960076, 0.7865839946027564, 0.7864477729086271, 0.7947235272858691, 0.8004969593931864, 0.8001011804384486, 0.8032328674861088, 0.8122590988163864, 0.8125748298156193, 0.8196193866374589, 0.8226316513130758, 0.8203143893591294, 0.8296644061902277, 0.8349330904505009, 0.8341458282187073, 0.8390509666080843)
  # lextree 100
  vpop = c(0.7819680077556956, 0.7686821929697671, 0.758451157901875, 0.7504383401519579, 0.7519342359767892, 0.7515875156299802, 0.7531719509875839, 0.7507795563210881, 0.7484236263029211, 0.7558696776417859, 0.7594231762189275, 0.7639362243898618, 0.7668444809191629, 0.7733368625374978, 0.775435380384968, 0.7802433786685755, 0.7825223435948362, 0.7826447566222591, 0.7955966440442473, 0.788654181184669, 0.7950514066207208, 0.8023202123975528, 0.7995833333333333, 0.8054801134649043, 0.8091187270501836, 0.8113890101665315, 0.8171672724953766, 0.818306906041148, 0.821256992431721, 0.8167117682001188, 0.8101011454216626, 0.8206145364082565, 0.8264501785353365, 0.8201951692158627, 0.8199642267473858, 0.8315662991235511, 0.8290802019068985, 0.8335072705767759, 0.8346222064561901, 0.835104486127951, 0.8395825836631882, 0.8401921422426154, 0.8375169849102482, 0.8416273416273417)
} else if(dataset == "3-lextree")
{
  # 3 3-LP-tree
  # lextree 0
  Naif = c(0.5445894765318544, 0.6308737995401055, 0.6837007980522115, 0.7255782496956581, 0.7529284458271338, 0.7716285675639118, 0.7911335046665765, 0.8004666576491275, 0.8082172325172461, 0.8192005951575815, 0.8248004869471122, 0.8312457730285405, 0.8378330853510078, 0.8426957933180035, 0.8468483700798052, 0.8521844988502638, 0.8558974705802787, 0.8594887055322602, 0.8637494927634248, 0.866021912620046, 0.8695049371026646, 0.873197619369674, 0.8749898552684973, 0.8775936696875423, 0.8805085892060057, 0.8836872717435412, 0.8875219802515893, 0.8889760584336535, 0.8912146625185987, 0.8918436358717706, 0.8932638982821588, 0.8973285540376031, 0.9000541052346814, 0.9003246314080887, 0.9027255511970783, 0.9045042607872311, 0.9078520221831462, 0.909069389963479, 0.9137292033004193, 0.9148113079940484, 0.9166982280535642, 0.9193223319356147, 0.922379277695117, 0.9262004598944948)
  # lextree  30
  jointree = c(0.5381240911294232, 0.6375639482395425, 0.7040883805967246, 0.7410326050600056, 0.7709780829079702, 0.7855460762885145, 0.803458438068822, 0.8120805369127517, 0.8133529002390391, 0.8212161013675345, 0.8259875784230272, 0.8307334669338677, 0.8347984929786505, 0.8389816388416809, 0.8426356719350991, 0.8474999145562049, 0.8482940452030321, 0.8526319478516857, 0.8562574578354022, 0.8568712899696921, 0.8591372177367913, 0.8626498933274479, 0.8662734444775231, 0.867561369873313, 0.8701355404533202, 0.8740368315611035, 0.878484825083018, 0.8787973876718508, 0.8834117972860703, 0.8834201509239636, 0.8839828925968315, 0.8871429147024457, 0.8897440051847051, 0.8913333196645685, 0.8912415387155358, 0.8977440482378626, 0.8981933133753428, 0.9018151295771692, 0.9020741964872138, 0.9000510052280358, 0.9038477982043608, 0.9076556768699457, 0.9061485891126346, 0.908577609518658)
  # lextree 60
  wmv = c(0.5381240911294232, 0.6207409008619525, 0.6769901626657538, 0.7063860785107244, 0.7301361052686471, 0.7391634277253378, 0.7555068235662679, 0.7576633892423366, 0.7567381085859675, 0.7616235996677367, 0.7645411912927836, 0.7689029088807552, 0.7715055091654726, 0.7761824324324325, 0.7792170558798999, 0.783122543383513, 0.7828086310576583, 0.7881085284234497, 0.7944072914021276, 0.7933924346512357, 0.79503413666336, 0.7991528937859131, 0.802081761955046, 0.8049609861250265, 0.8088411358403684, 0.8133649170926318, 0.8183642120442647, 0.8176772670728206, 0.8252736638763684, 0.8249807247494217, 0.8234409235095981, 0.8286296284127871, 0.8326467895906892, 0.8319786853731745, 0.8313240840517241, 0.841087386588444, 0.8403571184237532, 0.8461169866858336, 0.847415096933865, 0.843265277921719, 0.848240367227709, 0.8522034610803615, 0.8494721705888542, 0.8536131027695768)
  # lextree 100
  vpop = c(0.5381240911294232, 0.61160133082598, 0.6623097006069236, 0.6891096824469122, 0.7131176367153156, 0.7199352734940054, 0.7334202733175754, 0.7343569031568319, 0.732048642388367, 0.7361489398379589, 0.7380688942981486, 0.7429780232694794, 0.7461222814936397, 0.7499558849479442, 0.7565994500458295, 0.7603435934144596, 0.759682224428997, 0.76222072469027, 0.7731523539785176, 0.768074912891986, 0.7761269913004181, 0.7824656585478472, 0.7819047619047619, 0.7868911823284447, 0.793390452876377, 0.7946734859352586, 0.8002040686180728, 0.8004848643690211, 0.8044093451793353, 0.8015972543066464, 0.7973072543371961, 0.8066294627849122, 0.8134474162905073, 0.80469236625372, 0.80152724270776, 0.8151682216567713, 0.8130959057767807, 0.8175050441800599, 0.819226676126286, 0.8165608729762499, 0.8231738035264483, 0.8196874103814167, 0.8161338768504612, 0.8204633204633205)
}

#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-oracle*100
Naif = 100-Naif*100
jointree = 100-jointree*100
wmv = 100-wmv*100
vpop = 100-vpop*100

nb_val = length(oracle)
nb_val = length(Naif)
nb_val = length(jointree)
nb_val = length(wmv)
nb_val = length(vpop)


size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

#fin parametres graphes
#--------------------------------------------------------------------------------------------

(ggplot(NULL, aes(size))  + #scale_x_continuous(breaks=size)  + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
   ylab("Error rate (%)") + xlab("Number of configurated attributes") + theme_bw() #+ theme(legend.position="bottom")
 +geom_line(aes(y=Naif, colour="No constraints"), colour="turquoise2", linetype = "dotted") + geom_point(aes(y=Naif, shape="No constraints"), colour="turquoise2", fill="turquoise2") 
 +geom_line(aes(y=wmv, colour="60% constraints"), colour="deeppink2", linetype = "dotted") + geom_point(aes(y=wmv, shape="60% constraints"), colour="deeppink2", fill="deeppink2") 
 +geom_line(aes(y=vpop, colour="100% constraints"), colour="gold2", linetype = "dotted") + geom_point(aes(y=vpop, shape="100% constraints"), colour="gold2", fill="gold2")
 +geom_line(aes(y=jointree, colour="30% constraints"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointree, shape="30% constraints"), colour="springgreen4", fill="springgreen4") 
 # +geom_line(aes(y=drc, colour="DRC"), colour="blue", linetype = "dotted") + geom_point(aes(y=drc, shape="DRC"), colour="blue", fill="blue") 
# +geom_line(aes(y=oracle, colour="Oracle"), colour="black", linetype = "dotted") + geom_point(aes(y=oracle, shape="Oracle"), colour="black", fill="black") 
+ theme(legend.position=c(0.80,0.81), legend.background = element_rect(fill=alpha('blue', 0)))
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                       limits = c(NULL
                                  ,'No constraints' #Naif
                                  ,'30% constraints' #jointree
                                  ,'60% constraints' #wmv
                                  ,'100% constraints' #vpop
#                                  ,'Oracle' #oracle
                       ),
                       values =c(NULL
                                 ,'No constraints'='turquoise2' #Naif
                                 ,'30% constraints'='springgreen4' #jointree
                                 ,'60% constraints'='deeppink2' #wmv
                                 ,'100% constraints'='gold2' #vpop
#                                 ,'Oracle'='black' #oracle
                       ))
 + scale_shape_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                 ,'No constraints' #Naif
                                 ,'30% constraints' #jointree
                                 ,'60% constraints' #wmv
                                 ,'100% constraints' #vpop
#                                 ,'Oracle' #oracle
                      ),
                      values =c(NULL
                                ,'No constraints'=24 #Naif
                                ,'30% constraints'=21 #jointree
                                ,'60% constraints'=25 #wmv
                                ,'100% constraints'=22 #vpop
#                                ,'Oracle'=4 #oracle
                      ))
 
 + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                                              ,'No constraints'='turquoise2' #Naif
                                                              ,'30% constraints'='springgreen4' #jointree
                                                              ,'60% constraints'='deeppink2' #wmv
                                                              ,'100% constraints'='gold2' #vpop
#                                                              ,'Oracle'='black' #oracle
 ),
 fill = c(NULL
          ,'No constraints'='turquoise2' #Naif
          ,'30% constraints'='springgreen4' #jointree
          ,'60% constraints'='deeppink2' #wmv
          ,'100% constraints'='gold2' #vpop
#          ,'Oracle'='black' #oracle
 ))))
)

