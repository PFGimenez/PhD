library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "insurance"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result

# oracle
nom = "oracle"
# pas contraintes
#oracle = c(0.792, 0.7972, 0.79975, 0.80885, 0.80565, 0.81135, 0.8195, 0.8261, 0.83185, 0.83085, 0.8394, 0.8423, 0.848, 0.85355, 0.86005, 0.8689, 0.8704, 0.88105, 0.8909, 0.89185, 0.90575, 0.9104, 0.91335, 0.92245, 0.92825, 0.9308, 0.93345)
# contraintes
#Naif = c(0.78445, 0.7875731289086141, 0.7847084540694423, 0.7864097570974685, 0.7882553984775517, 0.7967047291308201, 0.7909723686985868, 0.7989625238196062, 0.8039993566718491, 0.8120462489916644, 0.8097047329570126, 0.8167487684729065, 0.8266791662071248, 0.8296736894769026, 0.8382771912183676, 0.8457714253432009, 0.8500113973102348, 0.8591196401116109, 0.8675010046500947, 0.8812579488958261, 0.883212954333644, 0.8947739283617147, 0.8969497114591921, 0.9069352825815653, 0.9111641791044777, 0.9237039256817501, 0.9260417293007035)
# contraintes plus dur
#jointree = c(0.7534, 0.7549471259553974, 0.7517139253002797, 0.7447208150720018, 0.7571530333610352, 0.7563426586440047, 0.7564168377823408, 0.7670360294605534, 0.7688234889637626, 0.7726946279804654, 0.7772777572851346, 0.7839292579777009, 0.786020651310564, 0.7995057660626029, 0.8087923279300687, 0.8079289732770746, 0.8082314881380301, 0.8251249768561377, 0.8263849229011994, 0.8277642474427667, 0.8372769199919792, 0.8506004477915734, 0.8506929861402772, 0.8539398512450146, 0.8545474325500435, 0.8690892675770229, 0.8735460094437406)

# DRC small
nom = "DRC"
#oracle = c(0.6886075014766686, 0.7485971647962197, 0.8012034849379799, 0.8248301831069108, 0.8468694624926166, 0.862042232722977, 0.8730064973419964, 0.8856689308919079, 0.8913541051388069, 0.8940490253987006, 0.9016538688718252, 0.9071175428233904, 0.9102554636739516, 0.9141686355581807, 0.9142055522740697, 0.9151653868871825, 0.919595392793857, 0.9230286473715298, 0.9227702303603071, 0.9262773183697578, 0.9281231541642055, 0.9287507383343178, 0.9328484937979917, 0.9318517424689899, 0.9348050797401063, 0.935912581216775, 0.935063496751329, 0.9376845835794447, 0.9392720023626698, 0.9391612522150029, 0.939124335499114, 0.9434066745422327, 0.9444034258712345, 0.9476520968694625, 0.9466184288245718, 0.9477628470171293, 0.9487965150620201, 0.949719432959244, 0.9498301831069108, 0.9508638511518015, 0.9514176018901358, 0.9533003544004726, 0.9538541051388069, 0.9511222681630243, 0.9555522740696988, 0.9557737743650325, 0.9554415239220319, 0.9576196101594802)
#Naif = c(0.6619718309859155, 0.6730103806228374, 0.6924643584521385, 0.7402912621359223, 0.7314285714285714, 0.7382352941176471, 0.7414965986394558, 0.7597173144876325, 0.7272727272727273, 0.7511111111111111, 0.788546255506608, 0.7104072398190046, 0.766497461928934, 0.7783251231527094, 0.7696335078534031, 0.7379679144385026, 0.7621951219512195, 0.7606382978723404, 0.8490566037735849, 0.7861635220125787, 0.8011363636363636, 0.7006369426751592, 0.8109756097560976, 0.7861635220125787, 0.7947019867549668, 0.7286821705426356, 0.7681159420289855, 0.7971014492753623, 0.7517241379310344, 0.8396946564885496, 0.7956204379562044, 0.8581560283687943, 0.803921568627451, 0.8264462809917356, 0.6821705426356589, 0.8066666666666666, 0.8617886178861789, 0.8, 0.8263888888888888, 0.7966101694915254, 0.8, 0.8220338983050848, 0.765625, 0.8035714285714286, 0.8137931034482758, 0.8333333333333334, 0.8434782608695652, 0.8444444444444444)
#jointree = c(0.6147540983606558, 0.6494845360824743, 0.5353535353535354, 0.7222222222222222, 0.6271186440677966, 0.6363636363636364, 0.6808510638297872, 0.6190476190476191, 0.75, 0.7931034482758621, 0.7380952380952381, 0.7931034482758621, 0.7647058823529411, 0.7352941176470589, 0.5555555555555556, 0.6511627906976745, 0.76, 0.8787878787878788, 0.76, 0.8181818181818182, 0.8108108108108109, 0.7419354838709677, 0.8275862068965517, 0.6333333333333333, 0.7666666666666667, 0.55, 0.7857142857142857, 0.92, 0.9, 0.7647058823529411, 0.7222222222222222, 0.6176470588235294, 0.7142857142857143, 0.7083333333333334, 0.7, 0.6896551724137931, 0.782608695652174, 0.8214285714285714, 0.7941176470588235, 0.9230769230769231, 0.8214285714285714, 0.84, 0.7692307692307693, 0.8461538461538461, 0.76, 0.7307692307692307, 0.6, 0.8181818181818182)

# k = 3
oracle = c(77.7, 75.7, 95.3, 101.1, 104.2)
oracle2 =c(77.7, 63.1, 83.6, 101.1, 104.2)
oracle2 = c(19, 33, 51.2, 70.2, 86.1)
# k = 2
Naif = c(303.0, 352.4, 252.3, 280.9, 427.6)
Naif2 = c(303.0, 320.9, 225.1, 263.8,416.6)
Naif2 = c(28, 62.9, 92.1, 122.4, 158.6)
# k = 1
jointree = c(3106.2, 2274.4, 2016.5, 1942.2, 2129.6)
jointree2 = c(3036.5, 2032.2, 1666.1,1634.6,1939.0)
jointree2 = c(94, 96, 144, 192, 240)

sum(3 - (oracle2 / oracle + Naif2 / Naif + jointree2 / jointree))/15

# RB small
nom = "RB"
#oracle = c(0.6886075014766686, 0.7482649143532192, 0.7989515652687537, 0.8251993502658004, 0.8471647962197283, 0.8615992321323095, 0.8728588304784406, 0.8853366804489072, 0.8913910218546958, 0.8947873597164796, 0.9018384524512699, 0.9078558771411696, 0.9108830478440638, 0.9150177200236267, 0.9144270525694034, 0.9161252215002953, 0.9198168930891908, 0.9238038984051978, 0.9233608978145305, 0.926166568222091, 0.9287138216184289, 0.9292306556408741, 0.9331438275251034, 0.9324054932073242, 0.935137330183107, 0.9364294152392203, 0.935875664500886, 0.9376845835794447, 0.9398257531010041, 0.9391612522150029, 0.9390135853514472, 0.9434435912581217, 0.9442557590076787, 0.9476890135853514, 0.9462861783815711, 0.9482796810395747, 0.9490918487891317, 0.9501255168340225, 0.9499409332545776, 0.9511222681630243, 0.9512330183106911, 0.9532265209686946, 0.953706438275251, 0.9516021854695806, 0.955330773774365, 0.9559214412285884, 0.9557368576491435, 0.9574350265800354)
#Naif = c(0.6619718309859155, 0.6747404844290658, 0.6904276985743381, 0.7524271844660194, 0.7257142857142858, 0.7411764705882353, 0.7414965986394558, 0.7632508833922261, 0.7148760330578512, 0.7511111111111111, 0.788546255506608, 0.7104072398190046, 0.7715736040609137, 0.7684729064039408, 0.774869109947644, 0.7486631016042781, 0.75, 0.7659574468085106, 0.8553459119496856, 0.7861635220125787, 0.8125, 0.6815286624203821, 0.7987804878048781, 0.779874213836478, 0.7880794701986755, 0.7441860465116279, 0.7753623188405797, 0.7898550724637681, 0.7586206896551724, 0.8244274809160306, 0.7883211678832117, 0.851063829787234, 0.7973856209150327, 0.8264462809917356, 0.689922480620155, 0.8, 0.8536585365853658, 0.8068965517241379, 0.8194444444444444, 0.7966101694915254, 0.8074074074074075, 0.8050847457627118, 0.7734375, 0.8035714285714286, 0.8068965517241379, 0.8333333333333334, 0.8434782608695652, 0.8296296296296296)
#jointree = c(0.6147540983606558, 0.6494845360824743, 0.5454545454545454, 0.7361111111111112, 0.6271186440677966, 0.6363636363636364, 0.6808510638297872, 0.6190476190476191, 0.75, 0.7931034482758621, 0.7619047619047619, 0.7586206896551724, 0.7352941176470589, 0.7647058823529411, 0.5925925925925926, 0.6511627906976745, 0.76, 0.8787878787878788, 0.76, 0.8181818181818182, 0.8108108108108109, 0.7419354838709677, 0.8275862068965517, 0.6, 0.7333333333333333, 0.5, 0.7857142857142857, 0.88, 0.9, 0.8235294117647058, 0.75, 0.6176470588235294, 0.7619047619047619, 0.7083333333333334, 0.65, 0.6896551724137931, 0.782608695652174, 0.7857142857142857, 0.7941176470588235, 0.9230769230769231, 0.7857142857142857, 0.84, 0.7692307692307693, 0.8461538461538461, 0.76, 0.7692307692307693, 0.6, 0.8181818181818182)

# DRC medium
nom = "DRC"
#oracle = c(0.761598809684837, 0.7959556337075612, 0.8109022047883133, 0.8407277154064656, 0.8549979710536995, 0.8722440146084134, 0.8870553226024618, 0.8927363722440146, 0.9082239956715812, 0.908697416475044, 0.9207358311916678, 0.9289192479372379, 0.9354118760990126, 0.9400108210469363, 0.9415663465440282, 0.9464358176653591, 0.9486000270526174, 0.9493439740294873, 0.9519816042202083, 0.9527255511970784, 0.9572568646016502, 0.9575273907750574, 0.9621263357229812, 0.9629379142432031, 0.9613147572027594, 0.9627350196131476, 0.9657784390639794, 0.9648992290004058, 0.9632084404166104, 0.9645610712836467, 0.9668605437576085, 0.9640200189368321, 0.968551332341404, 0.9678750169078858, 0.9652373867171649, 0.9688218585148113, 0.9680102799945894, 0.9655079128905721, 0.9688894900581632, 0.9694305424049777, 0.9707155417286623, 0.9659813336940349, 0.9692276477749222, 0.9683484377113486)
#Naif = c(0.7844158991759573, 0.7751009809578765, 0.7769735734724794, 0.7719435736677116, 0.7773626373626373, 0.7836041358936484, 0.7859717216523426, 0.7964839094159714, 0.7949697548551417, 0.7828746177370031, 0.8082706766917294, 0.7976901632815612, 0.8167907361455748, 0.8180286436394272, 0.8283752860411899, 0.8267113451412159, 0.846350178662583, 0.8277634961439588, 0.8306659783169851, 0.8061674008810573, 0.8291398478642481, 0.8362223550508069, 0.8462918660287081, 0.8521212121212122, 0.8395061728395061, 0.8248267170762444, 0.8411274823830878, 0.8366459627329192, 0.8395792241946088, 0.8448160535117056, 0.8251700680272109, 0.8375838926174497, 0.8480325644504749, 0.8522099447513812, 0.8501742160278746, 0.8470754052149401, 0.8461007591442374, 0.8510189739985945, 0.8647482014388489, 0.8424507658643327, 0.8493543758967002, 0.8527988942639945, 0.853589196872779, 0.8345170454545454)
#jointree = c(0.6675257731958762, 0.6994047619047619, 0.7210144927536232, 0.6967213114754098, 0.7731481481481481, 0.7582417582417582, 0.7470588235294118, 0.7432432432432432, 0.7740112994350282, 0.8433734939759037, 0.8225806451612904, 0.8203125, 0.825, 0.8181818181818182, 0.8135593220338984, 0.7281553398058253, 0.8367346938775511, 0.8125, 0.8554216867469879, 0.797752808988764, 0.8470588235294118, 0.7411764705882353, 0.8690476190476191, 0.7671232876712328, 0.8111111111111111, 0.8602150537634409, 0.891566265060241, 0.788235294117647, 0.8, 0.8076923076923077, 0.7808219178082192, 0.7865168539325843, 0.8641975308641975, 0.8059701492537313, 0.868421052631579, 0.7538461538461538, 0.8947368421052632, 0.8227848101265823, 0.7741935483870968, 0.8055555555555556, 0.8208955223880597, 0.7792207792207793, 0.7619047619047619, 0.7746478873239436)

# RB medium
nom = "RB"
#oracle = c(0.761598809684837, 0.7965643175977276, 0.8111050994183687, 0.8403219261463547, 0.8545921817935885, 0.8717705938049506, 0.8863790071689436, 0.8930068984174219, 0.9076829433247666, 0.9092384688218585, 0.9206005681049642, 0.9290545110239415, 0.9352089814689571, 0.9399431895035845, 0.9413634519139726, 0.9467739753821183, 0.9483295008792101, 0.9483971324225619, 0.9518463411335046, 0.9520492357635602, 0.9566481807114838, 0.9568510753415393, 0.9616529149195184, 0.9619910726362776, 0.9611118625727039, 0.9626673880697958, 0.9649668605437576, 0.964087650480184, 0.9627350196131476, 0.9643581766535912, 0.9667929122142568, 0.9628026511564994, 0.9671987014743676, 0.9672663330177195, 0.9638847558501284, 0.9689571216015149, 0.9669958068443122, 0.9648992290004058, 0.9676721222778304, 0.9684160692547004, 0.9689571216015149, 0.9654402813472204, 0.9682808061679967, 0.9676044907344785)
#Naif = c(0.7844158991759573, 0.773802654356607, 0.774617067833698, 0.770180250783699, 0.7764835164835164, 0.7823732151649434, 0.783199334627114, 0.7929082240762813, 0.792741165234002, 0.7838939857288482, 0.8075187969924812, 0.7992831541218638, 0.8130686517783292, 0.8142375737152485, 0.8265446224256293, 0.8252752513164193, 0.846350178662583, 0.8277634961439588, 0.8275684047496128, 0.8094713656387665, 0.826214160327677, 0.8338314405260012, 0.8415071770334929, 0.8503030303030303, 0.8364197530864198, 0.8191556395715186, 0.8417680973734786, 0.8372670807453416, 0.8382642998027613, 0.8461538461538461, 0.8231292517006803, 0.8395973154362416, 0.8453188602442334, 0.850828729281768, 0.848780487804878, 0.8463706835799859, 0.8461007591442374, 0.8475052705551651, 0.8647482014388489, 0.8409919766593728, 0.8500717360114778, 0.8534899792674498, 0.8528784648187633, 0.8345170454545454)
#jointree = c(0.6675257731958762, 0.6994047619047619, 0.7246376811594203, 0.7049180327868853, 0.7870370370370371, 0.7527472527472527, 0.7470588235294118, 0.75, 0.7796610169491526, 0.8433734939759037, 0.8145161290322581, 0.8359375, 0.825, 0.8181818181818182, 0.8135593220338984, 0.7281553398058253, 0.8367346938775511, 0.8125, 0.8554216867469879, 0.797752808988764, 0.8470588235294118, 0.7411764705882353, 0.8690476190476191, 0.7671232876712328, 0.8111111111111111, 0.8602150537634409, 0.891566265060241, 0.788235294117647, 0.8, 0.7948717948717948, 0.7808219178082192, 0.7865168539325843, 0.8641975308641975, 0.8059701492537313, 0.868421052631579, 0.7538461538461538, 0.8947368421052632, 0.8227848101265823, 0.7741935483870968, 0.8055555555555556, 0.8208955223880597, 0.7792207792207793, 0.7619047619047619, 0.7746478873239436)


#fin data

#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
#oracle = 100-100*oracle
#Naif = 100-100*Naif
#jointree = 100-100*jointree
#wmv = 100-100*wmv
#vpop = 100-100*vpop
#vnaif = 100-100*vnaif

nb_val = length(oracle)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*vpop)
min_val_erreur = min(min_val_erreur,100-100*vnaif)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*vpop)
max_val_erreur = max(max_val_erreur,100-100*vnaif)
max_val_erreur = floor(max_val_erreur)

size = 1:nb_val
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

#fin parametres graphes
#--------------------------------------------------------------------------------------------

(ggplot(NULL, aes(size)) + scale_y_log10() + annotation_logticks(sides="l") +
   ylab("#noeuds") + xlab("#clusters") + theme_bw() #+ theme(legend.position="bottom")
 +geom_line(aes(y=Naif, colour="k = 2"), colour="turquoise2", linetype = "solid") + geom_point(aes(y=Naif, shape="k = 2"), colour="turquoise2", fill="turquoise2") 
 +geom_line(aes(y=jointree, colour="k = 1"), colour="springgreen4", linetype = "solid") + geom_point(aes(y=jointree, shape="k = 1"), colour="springgreen4", fill="springgreen4") 
 +geom_line(aes(y=oracle, colour="k = 3"), colour="black", linetype = "solid") + geom_point(aes(y=oracle, shape="k = 3"), colour="black", fill="black") 
 + theme(legend.position=c(0.90,0.66), legend.background = element_rect(fill=alpha('blue', 0)))
 + scale_colour_manual(name = 'Légende', guide = 'legend',
                       limits = c(NULL
                                  ,'k = 1' #jointree
                                  ,'k = 2' #Naif
                                  ,'k = 3' #oracle
                       ),
                       values =c(NULL
                                 ,'k = 1'='springgreen4' #jointree
                                 ,'k = 2'='turquoise2' #Naif
                                 ,'k = 3'='black' #oracle
                       ))
 + scale_shape_manual(name = 'Légende', guide = 'legend',
                      limits = c(NULL
                                 ,'k = 1' #jointree
                                 ,'k = 2' #Naif
                                 ,'k = 3' #oracle
                      ),
                      values =c(NULL
                                ,'k = 1'=21 #jointree
                                ,'k = 2'=24 #Naif
                                ,'k = 3'=4 #oracle
                      ))
 
 + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                                              ,'k = 1'='springgreen4' #jointree
                                                              ,'k = 2'='turquoise2' #Naif
                                                              ,'k = 3'='black' #oracle
 ),
 fill = c(NULL
          ,'k = 1'='springgreen4' #jointree
          ,'k = 2'='turquoise2' #Naif
          ,'k = 3'='black' #oracle
 ))))
)


