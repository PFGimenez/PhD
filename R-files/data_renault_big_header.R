library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "renault_big_header"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result
oracle = c(0.8348566914917626,0.8585533739562176,0.8612615662378695,0.8746896863010607,0.888004965019183,0.8962423832092079,0.9022793951703905,0.9117580681561724,0.9126607989167231,0.920503272399007,0.9255247122545701,0.929981945384789,0.9330850823741819,0.9390656736628301,0.9395170390431054,0.9383886255924171,0.9461182577296321,0.9457797336944256,0.9480929812683367,0.9497856014443692,0.9514218009478673,0.950575490859851,0.9551455653351388,0.9552019860076733,0.9588693297224103,0.9575152335815843,0.9621417287294065,0.9614646806589935,0.9648499210110585,0.9666553825321598,0.9664296998420221,0.9657526517716091,0.9686865267433988,0.9704355675919657,0.9693071541412773,0.9721846084405326,0.9707176709546378,0.9743850146693749,0.976980365605958,0.9752877454299256,0.9755698487925976,0.9757955314827352,0.9781651997291808,0.9795192958700067,0.9804220266305574,0.981437598736177,0.9803091852854886,0.9836380049650192,0.9827352742044685,0.9807041299932295,0.9852742044685172,0.9853306251410516,0.9866283006093433,0.9849356804333108,0.9869104039720153,0.9865718799368088,0.9867411419544121,0.9872489280072219,0.9895621755811329,0.988772286165651,0.9893929135635297,0.9892236515459264,0.9892800722184608,0.9897878582712706,0.9902392236515459,0.9917061611374408,0.9914804784473031,0.9896750169262017,0.9914240577747687,0.9919882645001128,0.9918190024825095,0.992552471225457,0.9922703678627849,0.9926088918979914,0.9940194087113519,0.99322951929587,0.9933423606409388,0.9938501466937486,0.9940194087113519,0.9946400361092305,0.9939629880388174,0.9941886707289551,0.9942450914014895,0.9950914014895057,0.9946400361092305,0.9954863461972466,0.994583615436696)
Naif = c(0.8348566914917626,0.8585533739562176,0.8613744075829384,0.8726585420898217,0.8860302414804785,0.8930828255472806,0.8965809072444143,0.9057210561949899,0.9040848566914917,0.9109681787406906,0.9151433085082374,0.9193184382757843,0.920108327691266,0.9219137892123674,0.9189799142405778,0.9174565560821485,0.9268223877228616,0.9205596930715414,0.9233807266982622,0.9211238997968856,0.9203904310539381,0.9170051907018731,0.9243398781313473,0.920108327691266,0.9258632362897766,0.9185849695328369,0.923493568043331,0.9231550440081245,0.9247348228390883,0.9224779959377116,0.923888512751072,0.9223651545926428,0.9229293613179869,0.9223651545926428,0.9207853757616791,0.9206725344166102,0.9226472579553149,0.9223651545926428,0.9233243060257278,0.9250169262017603,0.9209546377792823,0.9170051907018731,0.9212931618144888,0.9250733468742948,0.9232678853531934,0.9259760776348455,0.922534416610246,0.9282893252087565,0.9208417964342135,0.9208982171067479,0.9237756714060031,0.9224215752651772,0.9273865944482058,0.9223651545926428,0.92118032046942,0.9225908372827805,0.9248476641841571,0.9249040848566915,0.9208417964342135,0.9227600993003836,0.9276686978108779,0.9250733468742948,0.925242608891898,0.9258068156172422,0.9281764838636877,0.9243398781313473,0.9268223877228616,0.925919656962311,0.9271044910855337,0.9255811329271045,0.9258068156172422,0.9251297675468292,0.9300947867298578,0.9268223877228616,0.9278943805010156,0.9251861882193636,0.9273301737756714,0.9268223877228616,0.9285150078988942,0.9276686978108779,0.9275558564658091,0.9229293613179869,0.9270480704129993,0.9293613179869104,0.9281200631911533,0.9260324983073798,0.9251861882193636)
jointree = c(0.8348566914917626,0.8549988715865493,0.8540397201534642,0.8636876551568494,0.8755924170616114,0.8810652222974498,0.8837734145791017,0.8911081020085759,0.8937598736176935,0.8960731211916046,0.903577070638682,0.9057774768675243,0.9092191378921237,0.9108553373956217,0.9113631234484315,0.9102347099977431,0.9174001354096141,0.9143534190927556,0.919826224328594,0.9146355224554277,0.9152561498533063,0.9146919431279621,0.9203340103814037,0.917795080117355,0.9240577747686752,0.9212367411419544,0.9251861882193636,0.9237192507334687,0.9261453396524486,0.9273301737756714,0.9251861882193636,0.9246784021665538,0.9271044910855337,0.9300947867298578,0.9273301737756714,0.9287406905890319,0.9284585872263598,0.9318438275784248,0.9338749717896637,0.9309410968178741,0.9304333107650643,0.9291356352967728,0.9320695102685624,0.9360753780185059,0.9316745655608215,0.9372037914691943,0.9306025727826676,0.9382193635748138,0.9361882193635748,0.9350033852403521,0.9365267433987813,0.9354547506206274,0.9405890318212593,0.9365267433987813,0.9409275558564658,0.9377679981945385,0.9414353419092756,0.9400248250959151,0.9386707289550892,0.9368088467614534,0.9410403972015347,0.940419769803656,0.9398555630783119,0.9423380726698263,0.9418867072895509,0.9429587000677048,0.9393477770255021,0.9443127962085308,0.9461746784021665,0.9457797336944256,0.9430151207402392,0.9459489957120288,0.9453847889866848,0.9448205822613406,0.9513089596027985,0.9448205822613406,0.9457233130218913,0.9459489957120288,0.9439178515007899,0.9447641615888062,0.9470774091627172,0.9480365605958023,0.9473030918528549,0.949221394719025,0.9470209884901828,0.9477544572331302,0.9487136086662153)
wmv = c(0.7950236966824644,0.8583276912660799,0.8601895734597157,0.8716993906567366,0.8851275107199278,0.8905438952832317,0.8966373279169487,0.9034078086210787,0.9054953735048522,0.909388399909727,0.9153125705258407,0.9190363349131122,0.920503272399007,0.9225908372827805,0.9206161137440758,0.9208417964342135,0.9276686978108779,0.9282893252087565,0.9278379598284812,0.9271609117580681,0.9289099526066351,0.9254118709095013,0.9317874069058903,0.9286842699164974,0.9334236064093884,0.9291920559693072,0.9347777025502144,0.9334800270819228,0.9343263371699391,0.9359625366734371,0.9335928684269916,0.933649289099526,0.9346648612051456,0.9378244188670729,0.9341006544798014,0.9368088467614534,0.9372037914691943,0.9390656736628301,0.9395734597156398,0.9385578876100203,0.9393477770255021,0.935793274655834,0.9402505077860528,0.939742721733243,0.9403633491311216,0.9422816519972919,0.9396298803881742,0.9422252313247574,0.9375987361769352,0.9379372602121417,0.9412096592191379,0.9369781087790566,0.9432972241029113,0.9391220943353645,0.943522906793049,0.9430715414127736,0.9443127962085308,0.943522906793049,0.9422252313247574,0.9403069284585872,0.9463439404197698,0.9417738659444821,0.9434664861205145,0.9436921688106522,0.9479237192507335,0.942168810652223,0.9401940871135184,0.9473030918528549,0.9460618370570977,0.9466260437824419,0.9441435341909276,0.9454412096592192,0.9449334236064094,0.945554051004288,0.950293387497179,0.9457233130218913,0.9466260437824419,0.9464003610923042,0.944877002933875,0.9451026856240127,0.9433536447754457,0.9469645678176484,0.9448205822613406,0.9486007673211465,0.9461746784021665,0.9473030918528549,0.9466824644549763)
vpop = c(0.806872037914692,0.8334461746784022,0.8447867298578199,0.8617129316181449,0.8754231550440081,0.8833220491988264,0.8934777702550214,0.9020537124802528,0.9027871812232002,0.910347551342812,0.913055743624464,0.9170616113744076,0.9228729406454524,0.9276686978108779,0.9272173324306026,0.9255247122545701,0.9312796208530806,0.9338185511171293,0.9344955991875423,0.9351162265854209,0.9371473707966599,0.935793274655834,0.940814714511397,0.9402505077860528,0.9433536447754457,0.9429587000677048,0.9449334236064094,0.9478672985781991,0.9474723538704581,0.9486571879936809,0.9523809523809523,0.9488264500112842,0.9493906567366283,0.9537914691943128,0.9487700293387498,0.9534529451591063,0.9549763033175356,0.9549198826450012,0.955991875423155,0.9567817648386369,0.955991875423155,0.9552584066802077,0.9570074475287745,0.9602234258632363,0.9589257503949447,0.9619160460392688,0.9614646806589935,0.9642857142857143,0.9581922816519973,0.9585872263597383,0.9615211013315279,0.9614082599864591,0.9658090724441435,0.9624238320920785,0.9637215075603701,0.9628187767998194,0.9654141277364027,0.9662040171518844,0.9663168584969533,0.962762356127285,0.9652448657187994,0.96614759647935,0.9650191830286617,0.964116452268111,0.9669939065673663,0.9663732791694877,0.9663168584969533,0.9680094786729858,0.968855788761002,0.9689122094335364,0.967219589257504,0.9669939065673663,0.9674452719476416,0.9669939065673663,0.9714511396975852,0.9679530580004514,0.9681223200180546,0.9686301060708644,0.9689122094335364,0.9678402166553826,0.9670503272399007,0.9699277815391559,0.9699842022116903,0.9683480027081923,0.9691943127962085,0.9694199954863462,0.9669374858948319)
vnaif = c(0.813247573911081,0.8426991649740465,0.8523470999774317,0.8663958474385015,0.8825885804558791,0.8895283231776123,0.8969194312796208,0.9077522004062288,0.9070751523358158,0.915086887835703,0.9195441209659219,0.9218009478672986,0.9260889189799142,0.9322387722861657,0.9314488828706838,0.9304897314375987,0.9373730534867976,0.9369781087790566,0.9391785150078988,0.938106522229745,0.9409839765290002,0.9377115775220041,0.9435793274655834,0.9396863010607086,0.9457233130218913,0.9444820582261341,0.9478672985781991,0.9474159331979237,0.9484315053035433,0.9498420221169036,0.9503498081697134,0.9480365605958023,0.950970435567592,0.9533965244865719,0.9496163394267659,0.9517603249830738,0.9523809523809523,0.9555969307154141,0.9552019860076733,0.9537914691943128,0.9539043105393816,0.9545813586097947,0.954355675919657,0.9561047167682238,0.9568946061837057,0.9586436470322727,0.956668923493568,0.9605055292259084,0.9558226134055517,0.9571767095463778,0.9596592191378921,0.9576844955991876,0.9623674114195441,0.9594335364477544,0.9623109907470097,0.9609568946061837,0.9621417287294065,0.9622545700744752,0.9609004739336493,0.9590950124125479,0.9640036109230422,0.9610133152787181,0.9618032046942,0.9620853080568721,0.9654141277364027,0.9628751974723538,0.9632137215075603,0.9643985556307831,0.9658090724441435,0.9669374858948319,0.9638907695779734,0.9650756037011962,0.9631008801624915,0.9645678176483864,0.9686301060708644,0.9650756037011962,0.9658654931166779,0.9655833897540058,0.9655833897540058,0.9648499210110585,0.9646242383209208,0.9649063416835929,0.9653012863913338,0.9670503272399007,0.9660911758068156,0.9666553825321598,0.9646242383209208)

#result conf
c_oracle = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
c_Naif = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
c_jointree = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
c_wmv = c(0.005943155119192405,0.005133862683287235,0.005105544525773731,0.004923488539867751,0.0046944653350120035,0.004596453388525946,0.0044819341574431956,0.00434898720759652,0.004306702312445203,0.004226119814069138,0.004098919503584075,0.004015934506127069,0.0039825615357017,0.003934376833968212,0.003979977939127609,0.003974803625007329,0.003813596969841869,0.0037984707234491053,0.003809479759858615,0.0038259122774882545,0.0037832619330331195,0.00386792095884044,0.003711640447264273,0.003788802015441062,0.0036700731770905547,0.0037763212896523655,0.003635192547101419,0.0036686286015953726,0.0036468686010821334,0.0036043046626123964,0.003665737178132538,0.003664290328371719,0.0036381162115637893,0.0035550514924263085,0.003652688098480093,0.003582026817954134,0.003571568060995086,0.003521714866132846,0.0035079584098846343,0.0035354019880217925,0.0035140810022666977,0.0036087385660517166,0.0034895071968989444,0.003503357375784197,0.0034864197304423027,0.003433385069179868,0.0035064255994393515,0.0034349599140357876,0.0035610690933411977,0.003552037703537442,0.0034631505948859425,0.0035775493946509592,0.003404878656506805,0.003520189809744683,0.003398502493783201,0.0034112396649821834,0.003376065343062869,0.003398502493783201,0.0034349599140357876,0.0034879639041965767,0.0033174859425924292,0.00344752556998392,0.0034000979598338334,0.0033937103753895474,0.003271010029409601,0.0034365338364213275,0.0034910496097178677,0.0032893663514872835,0.0033256997524532795,0.0033092465331084416,0.00338088920648537,0.0033436809523099335,0.0033583027436129673,0.00334042070156009,0.003199713825619681,0.003335522799022066,0.0033092465331084416,0.0033158401147636548,0.0033599224324696335,0.003353437748761453,0.003403286039860398,0.0032993251801429597,0.0033615411356604547,0.0032508374504655493,0.00332241728829909,0.0032893663514872835,0.003307595562432016)
c_vpop = c(0.005811658841190403,0.005485185071765144,0.005331055045183581,0.005082147796348624,0.004861864818004697,0.0047263854084095515,0.004541896159838565,0.0043760813775159104,0.004361437573218921,0.004205909201752709,0.004148052990195232,0.00406024513263971,0.003927801606618783,0.003813596969841869,0.0038245465899187712,0.003865229675761518,0.003724414629190705,0.00365994521617298,0.003642495887558965,0.0036264028448543713,0.0035730646227610176,0.0036087385660517166,0.003474034481415931,0.0034895071968989444,0.003403286039860398,0.0034144145128523215,0.0033583027436129673,0.0032726840946260822,0.003284372777294556,0.003249149368610942,0.003135240811838601,0.0032440785765073857,0.0032271044945117447,0.003090743736101146,0.003245769933335895,0.003101493937389771,0.003052755857788476,0.0030545777759251355,0.0030197343003746185,0.0029937474414545497,0.0030197343003746185,0.003043626507761613,0.0029862727714129525,0.002877233027965136,0.0029218136265616555,0.0028178300816614887,0.002833814051252457,0.0027321154763851607,0.002946658238518049,0.0029333114582859835,0.002831821841736226,0.0028358046178973313,0.002675323364589884,0.0027997201883494627,0.0027528059107695037,0.0027855394462696394,0.002690180325797952,0.002660370727621022,0.0026560807466652985,0.0027875704258090582,0.0026965186986488334,0.002662512737298517,0.002704943187749487,0.002738341667393394,0.002630171888919757,0.00265393276575037,0.0026560807466652985,0.0025907509399732136,0.0025573692453051263,0.0025551261323700147,0.002621470277980924,0.002630171888919757,0.0026127354616451827,0.002630171888919757,0.002451771935189174,0.002592958977425535,0.0025863284095227106,0.0025663194024880165,0.0025551261323700147,0.002597368624223794,0.0026279995811313325,0.002514361012890724,0.0025120742783546605,0.002577457371250601,0.002543876830904971,0.0025348365459885616,0.002632342141928256)
c_vnaif = c(0.005737460585154618,0.005360150656783061,0.005222812504602973,0.005008911518961909,0.004739248944965617,0.004615094138403135,0.004476517845257495,0.004260267446744964,0.004274277994354929,0.004103871428669516,0.0040044269801743915,0.003952706066863566,0.0038517343059154903,0.00370023591752587,0.0037201631114833936,0.0037441692853810034,0.0035670734478595338,0.0035775493946509592,0.0035186638962808026,0.003547510760829833,0.0034693753327793555,0.0035580619528804316,0.0033969060752551765,0.0035048919217855134,0.003335522799022066,0.0033712327352713577,0.0032726840946260822,0.0032860383551500897,0.0032558951732488974,0.0032134452150185113,0.0031979922855083333,0.003267658692591513,0.0031789794900597378,0.0031032812388634055,0.0032202838110402666,0.003154577386718309,0.003135240811838601,0.0030326275028197632,0.0030454550202409472,0.003090743736101146,0.003087150228879876,0.0030654818189215535,0.003072725193080164,0.0030160383458734084,0.0029900129036691675,0.0029313988732305434,0.0029974764056794516,0.0028674330369619265,0.003025268055397346,0.0029806520373187127,0.0028967156840122832,0.0029637133056768417,0.0028017391644594328,0.0029044655030988267,0.002803756440625787,0.002851670419932818,0.0028097981060616244,0.0028057720205151688,0.0028536463548179624,0.00291604451575027,0.002742483350624899,0.0028496928728451135,0.0028218360291986403,0.0028118086189842365,0.002690180325797952,0.0027835067369549314,0.0027712739424042704,0.002727955523086088,0.002675323364589884,0.002632342141928256,0.0027466177837130006,0.0027028399101036837,0.0027753585258800876,0.002721701770200612,0.0025663194024880165,0.0027028399101036837,0.0026731931686288205,0.002683824669961142,0.002683824669961142,0.0027112417039585877,0.0027196134828402488,0.002709144080289907,0.002694407820494429,0.0026279995811313325,0.0026646527661669784,0.00264316276225411,0.0027196134828402488)

#temps
Naiftemps = c(0.00469632012866091,0.00678952480108346,0.010033462953557925,0.013950615597313922,0.013854764178093787,0.016783919361209865,0.01984493064725467,0.022964014954009366,0.02519751498222448,0.026734815868178996,0.026873487613565825,0.031001877941425428,0.03304656119857796,0.03416763122848598,0.03846027137294735,0.039743153208058234,0.042773104339484225,0.04369320518029456,0.042934489024321426,0.04974415800462728,0.05624536854579313,0.0549238879860053,0.055812429095423506,0.057765659951470004,0.056513454376163876,0.05996653975509283,0.07009525111449692,0.06365193798318379,0.06876009203769538,0.0780441651148355,0.07275697449353874,0.08198136843293267,0.07704852389819987,0.08212766198295807,0.09007219005699453,0.08353381299023757,0.095925197731505,0.08518363077704419,0.09295438237119802,0.09361875887365273,0.09468717346650866,0.10357683099147903,0.10507326956718019,0.1009855371028723,0.1132588661475086,0.10426615811748773,0.12378699255121042,0.10007425297669431,0.1178453370012979,0.12116236595000282,0.11260484481688392,0.11937027504091191,0.11974064996332036,0.129627940804695,0.13540990141639864,0.12586783059646747,0.13246467857344393,0.14363830370746572,0.13832812194571412,0.13938311116754135,0.1345764880925508,0.14589631591422123,0.14171031202031603,0.15190489057562076,0.16036516416478555,0.15490840411963883,0.15825513888261852,0.1580144130925508,0.1575681183972912,0.16545660536117382,0.15969180874717834,0.16350425163656884,0.16294880428893904,0.17905278132054175,0.158539725,0.1891270586343115,0.174996566986456,0.18032123572234762,0.18605601224604967,0.17935054232505643,0.18371200090293455,0.18591498634311512,0.19241401495485327,0.1880498059255079,0.19844988448081263,0.20547052731376975,0.210128034255079)
jointreetemps = c(27.246312220077872,27.102715229783872,32.85797541239208,34.416307678234865,34.413268514192204,33.77221092274702,32.76229998685176,31.542794389932848,30.23325599983071,28.915683370859433,27.645367995993453,26.341602487444277,25.11493569775972,23.9426225814006,22.81615690158569,21.702456376051014,20.634195804017832,19.642536831950792,18.752658712149426,17.880941349641667,17.045190713616613,16.28752611319903,15.576991844816884,14.853247893459738,14.230431429264714,13.644606318266463,13.042544451216072,12.510861039219005,12.026990894362621,11.568933852886406,11.155899998645674,10.729652745838271,10.343556190790588,9.991670337791321,9.651479521189549,9.334602300547374,9.040392692906721,8.76525572315332,8.494856722589018,8.259694301619547,8.041163151966593,7.837130728852774,7.646287331188985,7.458310030867333,7.291952925963546,7.143948537215732,6.9897277505784094,6.848951528807629,6.718358433891993,6.589039963376784,6.46887727193725,6.353449732577168,6.24240912606512,6.12952212595226,6.029689841036059,5.932614609051408,5.8386968129902375,5.756244473110998,5.6623857901924275,5.573599088821172,5.492725137020316,5.40615928476298,5.327414508239277,5.2520847597065465,5.17176913244921,5.091933485835215,5.0233337465575625,4.9437326619074495,4.867635777765237,4.79375961506772,4.718916469638827,4.636837774435666,4.567317421726862,4.489804258295711,4.420138081038375,4.354781099379233,4.29003522037246,4.231350004232506,4.201858342155756,4.138456707223476,4.096267666873589,4.0839125694695255,4.0599902200338605,4.057317436173815,4.076606144300226,4.125554272799097,4.224577781376976)
wmvtemps = c(1.3014854312232003,1.4293006351839315,1.5217993793726021,1.6177837793387497,1.7165966678515008,1.7916713598510494,1.8508638076055066,1.8927339502933875,1.9215107408034304,1.940394192281652,1.9544777582374182,1.9648255922477995,1.9731129533401037,1.9775470077296322,1.983538067197021,1.987533917964342,1.995052105958023,2.0031658032046944,2.0091116354660348,2.0185100530918527,2.028649178345746,2.036527794403069,2.0443198671857368,2.054498832035658,2.0618487954186415,2.071772400304672,2.082963361938614,2.092457092360641,2.1021747085872264,2.11278116108102,2.1230016150417512,2.131670333728278,2.141553279282329,2.153808752369668,2.1659780175468293,2.177783284134507,2.1910185012976755,2.203252730309185,2.2150114293048975,2.2289482340893705,2.244422028436019,2.256098636425186,2.270281563924622,2.284246749097269,2.298065818381855,2.3114004930038368,2.3264456029113068,2.3389780284924395,2.355831651602347,2.3709314108553374,2.3871641346197245,2.402832263258858,2.419853930038366,2.436817791469194,2.4559093885691716,2.4738666230534867,2.4910949904649065,2.5098773295531482,2.527000736007673,2.5417984347777027,2.5597529294741594,2.580133362107876,2.5969212523132477,2.616967046659896,2.6356342306477094,2.654149471394719,2.673957175863236,2.692568846422929,2.7145501565109456,2.7330755097043555,2.751333355958023,2.770747666666667,2.7902277879711126,2.8138241220379148,2.835876202606635,2.861596143308508,2.88782152014218,2.913498345802302,2.9430133494696458,2.9720352645565336,3.0073289522681113,3.0449059916497405,3.0781286727036785,3.11233659732566,3.1506251038140376,3.1928383696682463,3.2362516150417515)
vpoptemps = c(0.7227277617919206,0.8176607521439856,0.8685920144436922,0.9502131319115323,1.0216973851275106,1.0768979904084857,1.122970468291582,1.160496698149402,1.1933421155495374,1.2239136979237193,1.252892573403295,1.281925575829384,1.311307916779508,1.340418865436696,1.3704302575603702,1.4022050484653577,1.4339764114759648,1.4657812242157526,1.4993304166666668,1.5340441478785827,1.570551124746107,1.6053883865380276,1.6435179111938614,1.6811516784585872,1.7186142176709547,1.7574324353419093,1.7949052927104492,1.8314419151997292,1.8706251108102008,1.90894174413225,1.9504140219476416,1.9909565009591514,2.032009888907696,2.071109803373956,2.111297498984428,2.152150255359964,2.192158244470774,2.234125353531934,2.273793709489957,2.316473826957797,2.3571149058338974,2.397940707289551,2.4398795717670954,2.480520919036335,2.5215542206612502,2.5621895197472355,2.6030560216091176,2.6435434206161137,2.68447965690589,2.7264281204581358,2.767640745147822,2.8107752989731436,2.8542455574362444,2.8974845194087115,2.941577401320244,2.983495113179869,3.027405131121643,3.0708076930151207,3.1148969090498757,3.1577836491762583,3.203265552189122,3.2486963406680207,3.296698244865719,3.343202899176258,3.392217123674114,3.4391654427330174,3.4891256319115325,3.5382426043218236,3.589984524994358,3.6454421313473255,3.7022196170728954,3.760034158824193,3.8207523094673888,3.8792767903972014,3.946767140769578,4.013047620232453,4.087033631798691,4.160871990972693,4.244349295982848,4.329059756149853,4.425155779056646,4.510295066463552,4.615544396468066,4.701517446118258,4.805407352572782,4.852121004062289,4.838807259252991)
vnaiftemps = c(0.6451137929361318,0.7004251516023471,0.7402862512412548,0.7941943547731889,0.8436578763258858,0.8850182477431731,0.9191662471789663,0.9456509149176259,0.9681622384337621,0.9869423571428572,1.0011106430828256,1.0154165848566914,1.0262460703565786,1.0352890938275785,1.0451006760324983,1.053796864421124,1.0625801736064093,1.073303820300158,1.0817336954412096,1.0911937024937937,1.1003672994809297,1.109127040340781,1.11878846812232,1.129006776686978,1.1406527800722184,1.1524109413789212,1.162298409896186,1.172779033795983,1.1848031659896185,1.1972309004739337,1.209998938670729,1.2215383002708193,1.2339877545136537,1.2478261321936357,1.262392099413225,1.2763035444030693,1.2883153586097946,1.302996368539833,1.3156883779620854,1.3307283744640037,1.3441463018505981,1.3648075778605282,1.373427721902505,1.3884467777589709,1.4039782082487022,1.418676180546152,1.434322146129542,1.4494948827578424,1.4646719453283683,1.4792495922477995,1.4947454961069735,1.5097882015910629,1.5263681480478448,1.54355282046942,1.5574965721620402,1.57437514596028,1.5904318558451818,1.6071270486910405,1.624394095971564,1.642454921575265,1.6590645144436922,1.6750880820920786,1.6930401014443692,1.7099707239900699,1.7283097175581132,1.7450942695779734,1.7636017050891446,1.7834564677273752,1.8007157356127286,1.8210072708756488,1.8392085387045813,1.8621039884901829,1.8897202618483413,1.905506202775897,1.9295180107199277,1.9544357783795983,1.9819774249605056,2.0094258825885802,2.040351750507786,2.072305510212142,2.1026803915594674,2.139019198995712,2.173030381516588,2.2094696697698035,2.2442522798465356,2.2808345163055743,2.3180854916497404)

#temps conf
c_Naiftemps = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
c_jointreetemps = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
c_wmvtemps = c(0.002018001223630027,0.002438202619245116,0.0035438708178907197,0.0038239267527712764,0.0052130295354526485,0.005241855674397767,0.005763222666294263,0.006191213040572437,0.006103408137578004,0.0060657865624632115,0.006123012997570698,0.0061782440919309345,0.006283136621024351,0.005933599306020357,0.005987144268621464,0.005784329313345588,0.005756228240690624,0.005710800942916276,0.005607765916636418,0.005536273429857354,0.005495600419806461,0.005399038921993724,0.005220477783374997,0.005535358219581401,0.0051438726669035765,0.005019614374794696,0.005108851215006134,0.005068420607978518,0.004813771491186771,0.004733881539962228,0.004736593298818123,0.004715651600213128,0.004638366817771093,0.00456044212815361,0.004509803199220825,0.004330044617257934,0.004328454939972613,0.00431751696357886,0.004078625222977538,0.004052006329149809,0.004786448631920333,0.004019593342095831,0.003974840102494368,0.0038900271794840152,0.0038729432333927134,0.003931601201498463,0.003934447828769003,0.003628641547365142,0.0038683055382163502,0.0036301857612662217,0.003773568662962703,0.003447013293651598,0.0034167467879188565,0.003650045113933383,0.0051648169032049865,0.0036580013718501125,0.003454945762720917,0.004365400307295528,0.0044693807357566884,0.0034939975579862297,0.0036418001714883055,0.003977163013692058,0.003265378302364911,0.0034469276236271866,0.0035066434131028213,0.003240388002403415,0.0033676221700938247,0.0033677041842468587,0.003961903910066755,0.0035128619482920104,0.003123537005696161,0.003133125496739151,0.0031606975805999775,0.0033846860494476617,0.003326658115036383,0.0033907784597534208,0.0035501938682837198,0.0032944181537207275,0.004163072673349134,0.00343254802252769,0.003609071752948782,0.003855378229746492,0.0037460980245656076,0.0037756587959809893,0.0038761851018087106,0.00466819649498077,0.0033349507097583633)
c_vpoptemps = c(7.056096110039256E-4,0.0025535486603732982,0.0032452269512556337,0.0038834564796079683,0.0046849506144973465,0.005226045758541381,0.00554606802498107,0.005741067626114071,0.005833706472882804,0.00587042869917969,0.005872592142559557,0.005891484360986332,0.005888158896318377,0.005885563635442431,0.0059082747308327795,0.005923043030886554,0.00595785143021118,0.006001858828873206,0.0060474509822182375,0.00612137896055188,0.006176808373468118,0.0062466472248608115,0.006327962815953873,0.006391110529550454,0.006493632462039472,0.006588335054116383,0.006677179987697994,0.0067727824226469354,0.006897165142066957,0.006996480041709899,0.007092870307074602,0.007186448353659593,0.007289042978126147,0.007382414329573281,0.007452870763148368,0.0075256681398856275,0.0076262535849003785,0.007725116780003065,0.0077999437092353555,0.007897736585035677,0.007985724697471459,0.008055981559585665,0.008132068214922301,0.008195097347960256,0.00824605845989452,0.00828797321667589,0.008347412098012855,0.008412402951549105,0.008469497536243216,0.008758897061866236,0.008551551312338762,0.008583159992812906,0.008617748507511614,0.008652439463359118,0.008669730233737672,0.008701998287631338,0.008714335578684592,0.008735679402023458,0.008743725302321393,0.008761211137855182,0.008772761344820022,0.00876926466656252,0.008780953877556225,0.008762177266693648,0.008723467055392804,0.008693327319589937,0.008630667943603839,0.008582482768971587,0.008557205815963918,0.008865262897028195,0.008449946786465113,0.008332741446366664,0.008230571695235816,0.008146070549073311,0.00805428358608771,0.007959905939723339,0.007875443903405992,0.00777195710873293,0.007664789431015495,0.007531506587627989,0.0073784830008632235,0.00709508742968137,0.006896197909949576,0.006442610842040661,0.006137665807902135,0.005612806157001071,0.00513022836558684)
c_vnaiftemps = c(6.52668349468898E-4,0.0015046453625289409,0.0016722145790867317,0.0022528907816018514,0.0022016546792893465,0.0025208173759310912,0.0027294008831954255,0.0026888291622941918,0.002737352623980079,0.003218334116730602,0.002690627724911501,0.0032014957079023435,0.002893361268065336,0.0025855880672641823,0.002688363028275253,0.0025144949961544375,0.002436531255718603,0.003126589485782922,0.0035840733660615787,0.002895113658793768,0.002561086612444889,0.0026418142892558534,0.002718860492692265,0.002278007981430485,0.0026430368418044583,0.0029608191860183014,0.002576999096942112,0.002256202302583555,0.002394545766604185,0.0024056218287058615,0.002918269744044904,0.002019702373105525,0.0019061232113373847,0.002161418629571255,0.002265533220297032,0.0026936682422072566,0.0020453375990352315,0.002602175792758811,0.001862286117697673,0.0020846992989400764,0.0017280445509917732,0.010734201497171006,0.0017644554301702003,0.0017326418805817772,0.0019462022005848694,0.0018189297630348193,0.002258514497218799,0.0021736712135673104,0.0027619655944384185,0.0018210417555177708,0.001857581231725885,0.001779585919974541,0.0020776299154482264,0.002862682738127394,0.001635426850233879,0.0019051686858438009,0.0018587622259638014,0.0015882146661240478,0.0018074298751237284,0.002367835173973606,0.0021905750133167467,0.0017781583644331464,0.0017345824395093917,0.0018972730259221248,0.0024846680015751543,0.0015137202010869796,0.00169479840399897,0.0022144241556213257,0.0016672739687670858,0.002085539102057471,0.001509770745693333,0.0022418872323786065,0.014234904203462214,0.0023093399249885928,0.0019731635150038343,0.0017955203605944635,0.002423381460061043,0.0020859299581272132,0.002475631409562181,0.0027803330544325846,0.0018502256886526194,0.0023749771220299247,0.002019178851482663,0.0025936033817660887,0.002156396237761439,0.002086937039167269,0.0020125220237310515)
#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-100*oracle
Naif = 100-100*Naif
jointree = 100-100*jointree
wmv = 100-100*wmv
vpop = 100-100*vpop
vnaif = 100-100*vnaif

c_oracle = 100*c_oracle
c_Naif = 100*c_Naif
c_jointree = 100*c_jointree
c_wmv = 100*c_wmv
c_vpop = 100*c_vpop
c_vnaif = 100*c_vnaif
#FIN MAJ VERS ERROR

nb_val = length(oracle)
nb_val = length(Naif)
nb_val = length(jointree)
nb_val = length(wmv)
nb_val = length(vpop)
nb_val = length(vnaif)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*wmv)
min_val_erreur = min(min_val_erreur,100-100*vpop)
min_val_erreur = min(min_val_erreur,100-100*vnaif)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*wmv)
max_val_erreur = max(max_val_erreur,100-100*vpop)
max_val_erreur = max(max_val_erreur,100-100*vnaif)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

min_val_time = 30000
min_val_time = min(min_val_erreur,100-100*Naiftemps)
min_val_time = min(min_val_erreur,100-100*jointreetemps)
min_val_time = min(min_val_erreur,100-100*wmvtemps)
min_val_time = min(min_val_erreur,100-100*vpoptemps)
min_val_time = min(min_val_erreur,100-100*vnaiftemps)
min_val_time = ceiling(min_val_erreur)

max_val_time = 30000
max_val_time = max(max_val_time,Naiftemps)
max_val_time = max(max_val_time,jointreetemps)
max_val_time = max(max_val_time,wmvtemps)
max_val_time = max(max_val_time,vpoptemps)
max_val_time = max(max_val_time,vnaiftemps)
max_val_time = floor(max_val_time)


x_lim_time = c(0,(nb_val-1))
if(min_val_time-y_padding_time <= 0){
  min_val_time = min_val_time+y_padding_time+0.00001
}
size = 0:(nb_val-1)
y_lim_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time))
x_axp_time = c(0, (nb_val-1), x_pas_erreur)
y_axp_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time),y_pas_time)
#fin parametres graphes
#--------------------------------------------------------------------------------------------

  png(file=paste("Taux_erreur_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
    ylab("Error rate (%)") + xlab("Number of assigned variables") + theme_bw() #+ theme(legend.position="bottom")
    +geom_line(aes(y=Naif, colour="Naive Bayes"), colour="turquoise2", linetype = "dotted") + geom_point(aes(y=Naif, shape="Naive Bayes"), colour="turquoise2", fill="turquoise2") 
    +geom_line(aes(y=wmv, colour="Weighted Majority Voter"), colour="deeppink2", linetype = "dotted") + geom_point(aes(y=wmv, shape="Weighted Majority Voter"), colour="deeppink2", fill="deeppink2") 
    +geom_line(aes(y=vpop, colour="Most Popular Choice"), colour="gold2", linetype = "dotted") + geom_point(aes(y=vpop, shape="Most Popular Choice"), colour="gold2", fill="gold2")
    +geom_line(aes(y=vnaif, colour="Naive Bayes Voter"), colour="firebrick3", linetype = "dotted") + geom_point(aes(y=vnaif, shape="Naive Bayes Voter"), colour="firebrick3", fill="firebrick3")
    +geom_line(aes(y=jointree, colour="Bayesian network"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointree, shape="Bayesian network"), colour="springgreen4", fill="springgreen4") 
    +geom_line(aes(y=oracle, colour="Oracle"), colour="black", linetype = "dotted") + geom_point(aes(y=oracle, shape="Oracle"), colour="black", fill="black") 
   + scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Bayesian network' #jointree
                                  ,'Naive Bayes' #Naif
                                  ,'Weighted Majority Voter' #wmv
                                  ,'Most Popular Choice' #vpop
                                  ,'Naive Bayes Voter' #vnaif
                                  ,'Oracle' #oracle
                      ),
                      values =c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ,'Oracle'='black' #oracle
                                  ))
    + scale_shape_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Bayesian network' #jointree
                                  ,'Naive Bayes' #Naif
                                  ,'Weighted Majority Voter' #wmv
                                  ,'Most Popular Choice' #vpop
                                  ,'Naive Bayes Voter' #vnaif
                                  ,'Oracle' #oracle
                      ),
                      values =c(NULL
                                  ,'Bayesian network'=21 #jointree
                                  ,'Naive Bayes'=24 #Naif
                                  ,'Weighted Majority Voter'=25 #wmv
                                  ,'Most Popular Choice'=22 #vpop
                                  ,'Naive Bayes Voter'=23 #vnaif
                                  ,'Oracle'=4 #oracle
                                  ))
  
    + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ,'Oracle'='black' #oracle
                                  ),
                                  fill = c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ,'Oracle'='black' #oracle
                                  ))))
)
  dev.off()

  png(file=paste("Temps_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size))
  + scale_y_log10(
   breaks = scales::trans_breaks("log10", function(x) 10^x),
   labels = scales::trans_format("log10", function(x) round(10^x,2)))
   + annotation_logticks(sides="l")
   + theme_bw() +
    ylab("Time (ms)") + xlab("Number of assigned variables") #+ theme(legend.position="bottom")
    +geom_line(aes(y=jointreetemps, colour="Bayesian network"), colour="springgreen4", linetype = "dotted") + geom_point(aes(y=jointreetemps, shape="Bayesian network"), colour="springgreen4", fill="springgreen4") 
    +geom_line(aes(y=Naiftemps, colour="Naive Bayes"), colour="turquoise2", linetype = "dotted") + geom_point(aes(y=Naiftemps, shape="Naive Bayes"), colour="turquoise2", fill="turquoise2") 
    +geom_line(aes(y=wmvtemps, colour="Weighted Majority Voter"), colour="deeppink2", linetype = "dotted") + geom_point(aes(y=wmvtemps, shape="Weighted Majority Voter"), colour="deeppink2", fill="deeppink2") 
    +geom_line(aes(y=vpoptemps, colour="Most Popular Choice"), colour="gold2", linetype = "dotted") + geom_point(aes(y=vpoptemps, shape="Most Popular Choice"), colour="gold2", fill="gold2")
    +geom_line(aes(y=vnaiftemps, colour="Naive Bayes Voter"), colour="firebrick3", linetype = "dotted") + geom_point(aes(y=vnaiftemps, shape="Naive Bayes Voter"), colour="firebrick3", fill="firebrick3")
   + scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Bayesian network' #jointree
                                  ,'Naive Bayes' #Naif
                                  ,'Weighted Majority Voter' #wmv
                                  ,'Most Popular Choice' #vpop
                                  ,'Naive Bayes Voter' #vnaif
                      ),
                      values =c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ))
    + scale_shape_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Bayesian network' #jointree
                                  ,'Naive Bayes' #Naif
                                  ,'Weighted Majority Voter' #wmv
                                  ,'Most Popular Choice' #vpop
                                  ,'Naive Bayes Voter' #vnaif
                      ),
                      values =c(NULL
                                  ,'Bayesian network'=21 #jointree
                                  ,'Naive Bayes'=24 #Naif
                                  ,'Weighted Majority Voter'=25 #wmv
                                  ,'Most Popular Choice'=22 #vpop
                                  ,'Naive Bayes Voter'=23 #vnaif
                                  ))
  
    + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ),
                                  fill = c(NULL
                                  ,'Bayesian network'='springgreen4' #jointree
                                  ,'Naive Bayes'='turquoise2' #Naif
                                  ,'Weighted Majority Voter'='deeppink2' #wmv
                                  ,'Most Popular Choice'='gold2' #vpop
                                  ,'Naive Bayes Voter'='firebrick3' #vnaif
                                  ))))
  )
  dev.off()
