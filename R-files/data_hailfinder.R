library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "hailfinder"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result
rc = c(0.3933573429371749,0.4109643857543017,0.4133653461384554,0.4343737494997999,0.45438175270108044,0.460984393757503,0.4769907963185274,0.47959183673469385,0.5004001600640257,0.5034013605442177,0.5054021608643458,0.5188075230092036,0.517406962785114,0.5320128051220488,0.5466186474589836,0.56062424969988,0.5596238495398159,0.5670268107242897,0.5786314525810324,0.5772308923569428,0.5710284113645459,0.5870348139255702,0.594437775110044,0.5778311324529812,0.5968387354941976,0.602641056422569,0.5926370548219287,0.6070428171268507,0.6234493797519007,0.6176470588235294,0.6166466586634654,0.6304521808723489,0.6336534613845538,0.6298519407763106,0.6388555422168868,0.657062825130052,0.639655862344938,0.6466586634653861,0.6428571428571429,0.6556622649059624,0.6480592236894758,0.6528611444577831,0.6466586634653861,0.6624649859943977,0.6672669067627051,0.6608643457382953,0.6700680272108843,0.6708683473389355,0.6858743497398959,0.6710684273709484,0.687875150060024,0.6754701880752301,0.6778711484593838,0.6774709883953581,0.6918767507002801,0.6936774709883954)
dRC = c(0.3933573429371749,0.41596638655462187,0.41116446578631455,0.42296918767507,0.4413765506202481,0.4583833533413365,0.4781912765106042,0.46078431372549017,0.48479391756702683,0.492797118847539,0.49379751900760305,0.505202080832333,0.5078031212484994,0.5136054421768708,0.5356142456982793,0.530812324929972,0.5354141656662665,0.5560224089635855,0.5600240096038416,0.5602240896358543,0.5460184073629452,0.5712284913965586,0.5732292917166867,0.5548219287715086,0.5722288915566226,0.5748299319727891,0.572829131652661,0.5816326530612245,0.5980392156862745,0.5886354541816726,0.5798319327731093,0.6000400160064026,0.6042416966786714,0.6046418567426971,0.6144457783113245,0.6258503401360545,0.6096438575430172,0.617046818727491,0.6102440976390556,0.6202480992396959,0.6258503401360545,0.6218487394957983,0.6192476990796318,0.6258503401360545,0.6376550620248099,0.6320528211284514,0.6434573829531812,0.6452581032412965,0.6550620248099239,0.6470588235294118,0.6580632252901161,0.6454581832733093,0.650860344137655,0.6468587434973989,0.6618647458983593,0.6680672268907563)
oracle = c(0.39955982392957184,0.42436974789915966,0.42777110844337735,0.4541816726690676,0.5150060024009604,0.6060424169667867,0.717687074829932,0.8179271708683473,0.9093637454981993,0.9533813525410164,0.978391356542617,0.9915966386554622,0.9959983993597439,0.9971988795518207,0.9991996798719488,0.9995998399359743,1.0,0.9997999199679872,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0)
jointree = c(0.3933573429371749,0.4105642256902761,0.4133653461384554,0.4341736694677871,0.4541816726690676,0.46298519407763106,0.47539015606242496,0.4797919167667067,0.4995998399359744,0.5050020008003201,0.5064025610244097,0.5214085634253701,0.5206082432973189,0.5326130452180873,0.5462184873949579,0.5600240096038416,0.5590236094437775,0.566826730692277,0.5794317727090836,0.5788315326130452,0.5722288915566226,0.586234493797519,0.5958383353341337,0.5786314525810324,0.5996398559423769,0.6046418567426971,0.5950380152060825,0.6082432973189276,0.6248499399759904,0.6166466586634654,0.6184473789515806,0.634453781512605,0.6354541816726691,0.6326530612244898,0.6410564225690276,0.65906362545018,0.641656662665066,0.648859543817527,0.6444577831132453,0.6582633053221288,0.6502601040416166,0.6546618647458984,0.6484593837535014,0.6662665066026411,0.6700680272108843,0.6632653061224489,0.6740696278511404,0.6736694677871149,0.6870748299319728,0.6752701080432173,0.6910764305722289,0.6812725090036015,0.6832733093237295,0.6832733093237295,0.6968787515006002,0.6984793917567027)

#result conf
c_rc = c(0.013543098866883735,0.01364051652773855,0.013652394690906853,0.01374214446091334,0.01380425043957532,0.013819799005948515,0.01384738001735773,0.013850513878332369,0.013862061162260918,0.013861744850459152,0.013861256495257643,0.01385225546968458,0.013853662577764818,0.013833624188826618,0.013801681275103395,0.013759793840833633,0.013763153327542244,0.01373694770193453,0.013689576764012884,0.013695703676713416,0.013721483527049714,0.013650438256029747,0.013612562724236393,0.013693091675264139,0.013599590943148344,0.013566843008895746,0.013622069997673701,0.013540672170169878,0.013432913795601957,0.013472877217469016,0.013479561460318605,0.013381948154884905,0.013357645008324443,0.01338643457361961,0.013316796282794302,0.013160387490061504,0.013310362034835216,0.013252344571017203,0.013284223283101427,0.01317317161026372,0.013240368958630828,0.013198360002243762,0.013252344571017203,0.013109883287475674,0.013063385330207745,0.013125045927831093,0.013035557068150504,0.013027510189643335,0.01286861851252337,0.013025491787597869,0.012846266549426786,0.012980407825700058,0.012955265942883733,0.012959483386956296,0.012800724436910455,0.012779863342327086)
c_dRC = c(0.013543098866883735,0.01366488514763688,0.013641519175469631,0.013696569740117062,0.013766456116487894,0.013813965471940946,0.01384887316115853,0.013819363719384558,0.013855653608061543,0.013860627157613954,0.013860998991950807,0.013861315320772881,0.013860377412534146,0.01385693269130013,0.013826856305351687,0.013835719292079643,0.013827251300800793,0.013774778312867964,0.013761816338899922,0.01376114444189051,0.013803229518673462,0.013720686313741043,0.01371258821747172,0.01377849034114352,0.013716665903700307,0.01370594465716814,0.013714226168359399,0.013676067195124854,0.01359297817412539,0.013642519494084846,0.013684235247948226,0.013581768497670168,0.013557459282481428,0.013555089636147514,0.013494054480172641,0.01341577818662981,0.013524666209879152,0.013476895010444934,0.013520915218965729,0.013455215090320502,0.01341577818662981,0.013444142306030514,0.013462056671788836,0.01341577818662981,0.01332637256208543,0.013369875749444707,0.013279250501254154,0.013264195703690177,0.013178611700294714,0.013248935684185661,0.013151178176540396,0.013262510293258428,0.01321604293764493,0.01325064139828852,0.013115588927132965,0.01305548758787408)
c_oracle = c(0.013579498261265177,0.01370256777618835,0.013716665903700308,0.013803741103105192,0.013855821272397756,0.013546721061563788,0.012479319070882846,0.010698868100042109,0.007959352490870283,0.005844819538616546,0.0040311411108244705,0.0025307659795898415,0.001750266327279451,0.0014652601158265308,7.839998116391135E-4,5.544825796728496E-4,0.0,3.9211762940369E-4,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
c_jointree = c(0.013543098866883735,0.013638504242872856,0.013652394690906853,0.01374140890468932,0.013803741103105192,0.013824028698558593,0.013845264454657577,0.013850739364553102,0.013862061162260917,0.013861371926221663,0.013860929065657961,0.0138493530660495,0.013850286166847112,0.013832546488256641,0.013802715686030169,0.013761816338899922,0.01376514180201353,0.013737696935837799,0.01368602497797409,0.013688692275630658,0.013716665903700307,0.013654341831565948,0.013605036933769599,0.013689576764012884,0.013584029294109927,0.013555089636147514,0.013609351460607265,0.013533334902361032,0.01342296079778993,0.013479561460318605,0.013467486309295701,0.01335147012612473,0.01334369562161788,0.013365307799711627,0.013299005533777369,0.013141903876083301,0.013294100774083417,0.013233469732792843,0.013270912019135847,0.013149328519790206,0.013221297824543624,0.013182225508837537,0.01323692444427878,0.013073197841730543,0.013035557068150504,0.013102239024952445,0.012994894000776904,0.012999008639104193,0.01285524072107208,0.01298248537920099,0.012809922677398408,0.01291897743570571,0.012897261487944714,0.012897261487944714,0.012742209678886804,0.012723108894554485)

#temps
rctemps = c(0.7382509801920768,0.21555539215686276,0.20322721768707483,0.18482943597438975,0.18265203141256503,0.16788592557022808,0.15482165786314525,0.14644069347739094,0.13540585254101642,0.12484646078431373,0.11511246338535414,0.1048639531812725,0.10332630152060825,0.09523791896758703,0.09143147599039615,0.08491101080432173,0.07574270508203282,0.07174154141656662,0.06658177370948379,0.0608554949979992,0.05735107022809124,0.05509243537414966,0.051039103641456585,0.048479395158063224,0.04522911644657863,0.042764073429371746,0.03933073149259704,0.03782453761504602,0.03419667206882753,0.0317417987194878,0.030511797519007604,0.028457356142456983,0.02708529431772709,0.02683856862745098,0.024335945578231294,0.023075347539015606,0.021923420368147258,0.020853702080832332,0.020017003401360544,0.018558131252501,0.01797582793117247,0.017056072028811525,0.016294233093237295,0.015740322729091635,0.015020047819127651,0.014600665466186475,0.013933459783913565,0.013338867547018808,0.013055502400960385,0.012589636054421769,0.012156480592236894,0.011965529411764706,0.011424638655462185,0.011202120448179271,0.01079957743097239,0.01044979231692677)
dRCtemps = c(5.96457968827531,5.07156,3.4179540510204083,3.114649307122849,6.405587469987995,11.065427409763906,11.374576414965986,10.279277911364545,9.231418038215287,8.227637113845539,6.891759556422569,5.6201808121248495,4.996276843137255,4.168907915566226,3.7411476266506605,3.1914558865546216,2.447932431172469,2.017074667667067,1.6300114447779113,1.306829431172469,1.0617513149259703,0.9771544363745498,0.8112590266106443,0.6710352697078832,0.5589396200480192,0.4932683363345338,0.4054965900360144,0.3402292044817927,0.2888351272509004,0.2501394637855142,0.21611998859543818,0.19188723629451782,0.16525121568627452,0.14840213745498199,0.1332017318927571,0.11980582853141257,0.10373505482192877,0.09583797899159664,0.08817972488995598,0.0783789661864746,0.07320216626650661,0.06656099899959984,0.061517007202881155,0.05817016486594638,0.0537531918767507,0.050618230292116845,0.04748135034013606,0.04445097138855542,0.04233841736694678,0.03998041216486595,0.03774540756302521,0.036182639655862346,0.03405017466986795,0.03293556342537015,0.030925532212885153,0.029628136854741898)
jointreetemps = c(0.03229051620648259,0.032412769707883156,0.03348660484193677,0.034340489195678274,0.034479248899559826,0.033720351140456184,0.03371459263705482,0.03358852460984394,0.03358056542617047,0.0335373181272509,0.03338107523009204,0.03309634993997599,0.03296938695478191,0.03413868167266907,0.032743530412164865,0.03237530612244898,0.03227547278911565,0.03199392997198879,0.031844742096838734,0.03158983413365346,0.03132771448579432,0.031133767907162865,0.030861250900360144,0.030553325330132053,0.030194507202881152,0.03010029691876751,0.029876355542216886,0.02957519367747099,0.029333234893957585,0.028942314725890355,0.02873753961584634,0.028529727290916365,0.02823547899159664,0.02800487274909964,0.02756912745098039,0.027400508603441377,0.027026469787915165,0.026822190476190475,0.02670341236494598,0.027806322328931574,0.025889904761904763,0.025645101840736293,0.025386129651860743,0.02513045098039216,0.024841464585834333,0.024510926570628252,0.024194882352941177,0.023978669467787116,0.023621242697078833,0.023348314525810324,0.022979962585034014,0.022696757102841136,0.02247421168467387,0.02260478631452581,0.02463561024409764,0.021363170668267307)

#temps conf
c_rctemps = c(0.017039613630763086,0.006065008052844684,0.00904158276798251,0.005552587491302392,0.007679877231267346,0.004685392157851146,0.004445458113998825,0.00433689130730719,0.004465845719626342,0.0038139689224982285,0.0035693666204250083,0.00326412682322746,0.006202317514648368,0.0031171693014339637,0.003951225588907923,0.002807371080239705,0.002516387669332804,0.00244346215693006,0.0021898211732449243,0.0020144278442562214,0.001921694984690197,0.0019310395734268594,0.00175783464869679,0.00169187036985565,0.0015277364613126624,0.0014739593806182417,0.0012709534176200364,0.0026055100302961524,0.0010230864488252904,9.47692569796726E-4,8.977889599912038E-4,8.579418765202317E-4,7.767954049373237E-4,0.0019641250999509925,6.297253129040221E-4,6.124376445719815E-4,5.182426500872023E-4,4.8320340348090947E-4,4.955798696277951E-4,4.00697599116657E-4,4.122688379706003E-4,3.4414110234213396E-4,2.8945641888101603E-4,2.7143924600663694E-4,2.5701012652472517E-4,2.464855980731599E-4,2.1373297847842264E-4,2.0031644671573526E-4,1.9744340820117772E-4,1.7040561284643651E-4,1.5038085885065168E-4,1.846422953967716E-4,1.4094752290234414E-4,1.341120818271116E-4,1.363837324196787E-4,1.0845501729291016E-4)
c_dRCtemps = c(0.21218578906600166,0.14142320689641538,0.09604698388203434,0.2057894118784954,0.3953249070360701,0.5185546202145138,0.5555598461428742,0.5213637479309132,0.50629848243062,0.45024685216298715,0.3982552489140654,0.3324538766476067,0.33202079923491673,0.2976036680611024,0.2498102031657751,0.230072576090412,0.19837441530958136,0.1430078279135242,0.11969880147533231,0.08219935138980439,0.06600101492090872,0.08191473491349428,0.0605183012016808,0.04982585074771224,0.03591990812922922,0.03635376611399326,0.024562708187546325,0.020531257495235454,0.018837735016428384,0.01395307928302247,0.011834343784025127,0.011203268863090006,0.008418744070761063,0.006887755603454953,0.007232949434996352,0.0063149060322083206,0.0037191969315659578,0.0035347547539653617,0.003680078101600607,0.002597021266630224,0.00255652010546277,0.0018911050053099813,0.0016223151988161164,0.0014952826691748608,0.0014258942821658437,0.0011998846772550732,0.0010523090859690155,9.133997520140941E-4,9.054753781977025E-4,7.424403313865712E-4,6.30791307209131E-4,6.660909475277108E-4,4.990205838283362E-4,4.3667642561167594E-4,3.814674253405251E-4,3.2729504264375963E-4)
c_jointreetemps = c(7.539507575331285E-4,0.001830692664059738,7.260587782939267E-4,0.0016925631599527073,0.001667664380802806,7.170080828429905E-4,7.114167255723255E-4,6.990084127095471E-4,7.106421172454491E-4,7.090360101187992E-4,7.058318398963084E-4,6.928771451522657E-4,6.902937787034672E-4,0.002724397779032505,7.058687577719239E-4,6.938615815901E-4,7.07069084026988E-4,7.005253429172866E-4,7.137604507307996E-4,7.22812655245577E-4,7.028335613036282E-4,7.00620709585156E-4,6.794608240856411E-4,6.614395534285575E-4,6.619001334756523E-4,6.677178216361243E-4,6.621726880402303E-4,6.648572819141167E-4,6.680378863951368E-4,6.579381478118146E-4,6.490239588771005E-4,6.305143990855017E-4,6.196484241657302E-4,6.177758636136827E-4,5.95619451349655E-4,5.919545410509077E-4,5.770991773877539E-4,5.716486350931986E-4,5.990077871466631E-4,0.003007757890352462,5.434463967826744E-4,5.379464307168625E-4,5.361877424204254E-4,5.383410480518638E-4,5.184668406032423E-4,5.020371693260287E-4,4.900831724973341E-4,4.832781058624589E-4,4.695870715006484E-4,4.716396784801606E-4,4.4246400678456585E-4,4.3096042485860314E-4,4.2797739154764404E-4,0.0012910093016102358,0.005725745763409786,3.89714032452489E-4)
#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
dRC = 100-100*dRC
oracle = 100-100*oracle
rc = 100-100*rc
jointree = 100-100*jointree

c_rc = 100*c_rc
c_dRC = 100*c_dRC
c_oracle = 100*c_oracle
c_jointree = 100*c_jointree
#FIN MAJ VERS ERROR

nb_val = length(rc)
nb_val = length(dRC)
nb_val = length(oracle)
nb_val = length(jointree)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*rc)
min_val_erreur = min(min_val_erreur,100-100*dRC)
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*rc)
max_val_erreur = max(max_val_erreur,100-100*dRC)
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

min_val_time = 30000
min_val_time = min(min_val_erreur,100-100*rctemps)
min_val_time = min(min_val_erreur,100-100*dRCtemps)
min_val_time = min(min_val_erreur,100-100*jointreetemps)
min_val_time = ceiling(min_val_erreur)

max_val_time = 30000
max_val_time = max(max_val_time,rctemps)
max_val_time = max(max_val_time,dRCtemps)
max_val_time = max(max_val_time,jointreetemps)
max_val_time = floor(max_val_time)


x_lim_time = c(0,(nb_val-1))
if(min_val_time-y_padding_time <= 0){
  min_val_time = min_val_time+y_padding_time+0.00001
}
size = 0:(nb_val-1)
y_lim_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time))
x_axp_time = c(0, (nb_val-1), x_pas_erreur)
y_axp_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time),y_pas_time)
#fin parametres graphes
#--------------------------------------------------------------------------------------------

  png(file=paste("Taux_erreur_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
    ylab("Error rate (%)") + xlab("Number of known choices") + theme_bw() #+ theme(legend.position="bottom")
    +geom_line(aes(y=dRC, colour="DRC")) + geom_point(aes(y=dRC), colour="coral3") 
    +geom_line(aes(y=oracle, colour="Oracle")) + geom_point(aes(y=oracle), colour="black") 
    +geom_line(aes(y=rc, colour="RC")) + geom_point(aes(y=rc), colour="darkorchid3") 
    +geom_line(aes(y=jointree, colour="Classical Bayes")) + geom_point(aes(y=jointree), colour="springgreen4") 
    + scale_colour_manual(name = 'Legend', guide = 'legend',
                        values =c(NULL
                                  ,'DRC'='coral' #dRC
                                  ,'Oracle'='black' #oracle
                                  ,'RC'='darkorchid1' #rc
                                  ,'Classical Bayes'='springgreen' #jointree
                                  )))
  dev.off()

  png(file=paste("Temps_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size))
  + scale_y_log10(
   breaks = scales::trans_breaks("log10", function(x) 10^x),
   labels = scales::trans_format("log10", function(x) round(10^x,2)))
   + annotation_logticks(sides="l")
   + theme_bw() +
    ylab("Time (ms)") + xlab("Number of known choices") #+ theme(legend.position="bottom")
    +geom_line(aes(y=dRCtemps, colour="DRC")) + geom_point(aes(y=dRCtemps), colour="coral3")
    +geom_line(aes(y=rctemps, colour="RC")) + geom_point(aes(y=rctemps), colour="darkorchid3") 
    +geom_line(aes(y=jointreetemps, colour="Classical Bayes")) + geom_point(aes(y=jointreetemps), colour="springgreen4") 
   + scale_colour_manual(name = 'Legend', guide = 'legend',
                        values =c(NULL
                                  ,'DRC'='coral' #dRC
                                  ,'RC'='darkorchid1' #rc
                                  ,'Classical Bayes'='springgreen' #jointree
                                  )))
  dev.off()
