library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "champi"
taille_img_x = 1024/3
taille_img_y = 720/3
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------

#DRC va dans vpop

#data
#result
Naif = c(0.6878322504430006,0.7527687536916716,0.7943738924985233,0.8277835203780272,0.8471278795038394,0.8625221500295334,0.8761075014766686,0.8807959243945659,0.8924985233313645,0.8968546958062611,0.9006571175428234,0.9083357944477259,0.9096647962197283,0.9083357944477259,0.9122489663319551,0.9145378027170703,0.9213673951565269,0.9215519787359716,0.9229917306556409,0.9256128174837567,0.9273479031305375,0.9287138216184289,0.9311503248670998,0.9317409923213231,0.9339929119905493,0.9352111636148848,0.9363924985233314,0.9386813349084465,0.9373892498523332,0.9395673360897815,0.9405271707028943,0.9422622563496751,0.9440711754282339,0.9432959243945659,0.9454001772002363,0.9452525103366805,0.9485011813349085,0.9478735971647962,0.9497563496751329,0.9523036030714708,0.9509376845835794,0.9526358535144713,0.9541863555818074,0.9518236857649144,0.9548508564678087,0.9551092734790313,0.9559583579444773,0.9564382752510336)
vpop = c(0.6878322504430006, 0.7516981689308919, 0.7957028942705257, 0.8281157708210277, 0.8466479621972829, 0.8626329001772003, 0.8754060838747785, 0.8811281748375664, 0.8917971057294743, 0.8957102776137035, 0.9009524512699351, 0.9080404607206143, 0.90996012994684, 0.9083727111636148, 0.9126550502067337, 0.9152023036030714, 0.9203706438275251, 0.9213673951565269, 0.9216258121677495, 0.9257974010632014, 0.9275694034258712, 0.9295259893679858, 0.9311134081512109, 0.9316671588895452, 0.9349158298877732, 0.9348050797401063, 0.9365401653868872, 0.9389766686355582, 0.9372046662728883, 0.9397519196692262, 0.9400472533963379, 0.9434805079740106, 0.9438865918487891, 0.9443295924394566, 0.9462861783815711, 0.9463230950974602, 0.9485750147666864, 0.9485011813349085, 0.9494240992321323, 0.9530419373892498, 0.9507900177200236, 0.9531896042528056, 0.9540386887182516, 0.9520082693443591, 0.9551831069108092, 0.9556630242173656, 0.9560691080921441, 0.9564382752510336)
jointree = c(0.6878322504430006,0.7526580035440047,0.7941893089190786,0.8277835203780272,0.8470171293561725,0.8625590667454224,0.8761444181925576,0.8808697578263438,0.8924616066154755,0.8967808623744832,0.9006940342587123,0.9083727111636148,0.9097386296515062,0.9083727111636148,0.912322799763733,0.9146485528647371,0.9214412285883048,0.9216627288836385,0.9231024808033077,0.9257235676314235,0.9273479031305375,0.9287507383343178,0.9312241582988777,0.931814825753101,0.9340667454223273,0.9353588304784406,0.9365770821027761,0.9389028352037803,0.9375,0.9397519196692262,0.9406010041346722,0.9424468399291199,0.9441450088600118,0.9435174246898996,0.9455109273479031,0.9453632604843473,0.9486857649143532,0.948058180744241,0.9498301831069108,0.9525989367985824,0.9511591848789132,0.952931187241583,0.9543709391612523,0.9520451860602481,0.9551092734790313,0.9554415239220319,0.956179858239811,0.9568074424099232)
oracle = c(0.6880906674542233, 0.751587418783225, 0.7948168930891908, 0.828780271707029, 0.8484568812758417, 0.8648479031305375, 0.8761444181925576, 0.8821249261665682, 0.89441819255759, 0.8991435321913762, 0.90501329001772, 0.9122120496160662, 0.9154238038984052, 0.9150915534554046, 0.9191523922031896, 0.9221426461901949, 0.9265357353809806, 0.9270894861193149, 0.9311872415829888, 0.9346574128765505, 0.9360233313644418, 0.939124335499114, 0.9422253396337862, 0.9433697578263438, 0.9461754282339043, 0.9467291789722386, 0.9499040165386887, 0.9518975191966923, 0.9535587714116952, 0.9542601890135853, 0.9556630242173656, 0.9596869462492617, 0.9598346131128175, 0.9614220318960425, 0.9624187832250443, 0.9640800354400473, 0.9665165386887182, 0.9686577082102776, 0.9703927938570585, 0.9705035440047254, 0.9703927938570585, 0.9733830478440638, 0.9744905493207324, 0.9729400472533963, 0.9778868871825163, 0.9785144713526285, 0.9787728883638511, 0.9799173065564087)

#Naif = c(0.7603138103611524, 0.794873529013932, 0.8178682537535507, 0.8403219261463547, 0.8556066549438658, 0.8744082239956715, 0.8859732179088327, 0.8953063708913838, 0.9063303124577303, 0.9145137292033004, 0.9218855674286487, 0.927025564723387, 0.930001352630867, 0.9344650344920871, 0.9419721358041391, 0.9428513458677127, 0.9488029216826728, 0.949479237116191, 0.9482618693358582, 0.9529960773704856, 0.9538752874340592, 0.9561747599080211, 0.9575950223184093, 0.9570539699715948, 0.9564452860814284, 0.9606384417692412, 0.9590152847287975, 0.960300284052482, 0.9584066008386312, 0.9604355471391857, 0.9650344920871095, 0.9627350196131476, 0.9605031786825375, 0.9630731773299067, 0.9647639659137022, 0.9631408088732585, 0.963343703503314, 0.9627350196131476, 0.963343703503314, 0.965575544433924, 0.9659137021506831, 0.9617881780062221, 0.9647639659137022, 0.9646287028269985)
#vpop = c(0.7564102564102564, 0.7834008097165992, 0.8049932523616734, 0.8414304993252362, 0.8576248313090419, 0.8819163292847504, 0.8765182186234818, 0.902834008097166, 0.8987854251012146, 0.9203778677462888, 0.9284750337381916, 0.9325236167341431, 0.9406207827260459, 0.9345479082321188, 0.9392712550607287, 0.9412955465587044, 0.9500674763832658, 0.9439946018893387, 0.9520917678812416, 0.956140350877193, 0.9453441295546559, 0.9635627530364372, 0.9615384615384616, 0.9669365721997301, 0.9568151147098516, 0.9662618083670715, 0.9649122807017544, 0.9622132253711201, 0.9635627530364372, 0.9568151147098516, 0.9676113360323887, 0.9622132253711201, 0.9696356275303644, 0.9581646423751687, 0.9635627530364372, 0.9642375168690959, 0.9676113360323887, 0.9709851551956815, 0.9615384615384616, 0.9716407832545577, 0.9696151249155975, 0.962187711006077, 0.9635381498987171, 0.9608372721134368)
#oracle = c(0.7603138103611524,0.7950764236439876,0.8167861490599215,0.8414716623833356,0.8583119166779386,0.8778574327066143,0.8894224266197754,0.9013932097930475,0.9117408359258758,0.9216826727985933,0.9276342486135534,0.9362234546192344,0.9372379277695116,0.9435276613012309,0.9493439740294873,0.9523873934803192,0.9559718652779656,0.9586094954686866,0.9601650209657785,0.964087650480184,0.9654402813472204,0.9662518598674422,0.9686189638847559,0.9705802786419586,0.9692952793182741,0.9717300148789395,0.9709184363587177,0.9730150142026242,0.9708508048153659,0.9744352766130123,0.9759231705667524,0.9736913296361422,0.9767347490869742,0.9753144866765859,0.9769376437170296,0.9772758014337887,0.9773434329771405,0.9776139591505478,0.9801163262545651,0.9798458000811578,0.9806573786013797,0.977140538347085,0.9796429054511024,0.979034221560936)
#jointree = c(0.7603138103611524,0.794873529013932,0.8178682537535507,0.8404571892330583,0.8554713918571621,0.8743405924523198,0.8861084809955363,0.8957797916948465,0.9066008386311376,0.9147842553767077,0.9223589882321115,0.9274313539834979,0.930407141890978,0.9350060868389016,0.9423102935208981,0.9433923982145273,0.9496145002028946,0.9498173948329501,0.9490058163127283,0.9534018666305966,0.9542810766941702,0.9571892330582984,0.9586094954686866,0.9579331800351684,0.9576626538617611,0.9617205464628703,0.9600973894224266,0.9612471256594075,0.9597592317056676,0.9613823887461111,0.9664547544974976,0.964425808196943,0.962193967266333,0.9642905451102394,0.9665900175842013,0.9648315974570539,0.9648315974570539,0.9640200189368321,0.9652373867171649,0.9674015961044231,0.9676044907344785,0.9635465981333694,0.9664547544974976,0.9667252806709049)

#result conf
c_Naif = c(2.1869078824940935,0.8859744003987006,0.7759362800132901,0.6745039136887182,0.5962077637330183,0.5345024772223863,0.4750488417749557,0.42358258494536327,0.3770032688275251,0.3433737052938571,0.3006233945658594,0.2717969289353219,0.24371661481098641,0.22205051251476668,0.2028701800428234,0.1819650617616657,0.16054177617395157,0.1439594737891317,0.12987758793561724,0.11818775003691671,0.1064438469063792,0.09723469226225635,0.08755630607649144,0.07762802141169521,0.07014550723567631,0.06436037418783225,0.057451675059066745,0.051712825568517425,0.046945454850856466,0.041979480101890135,0.039067344543709394,0.035145256829592436,0.03208567158889545,0.029189093989958653,0.026696335462197282,0.024836360934731246,0.022926350450383933,0.021380126439751918,0.01977830574424099,0.01830263146042528,0.017292125959834613,0.016038183697578264,0.015238233608978146,0.014553127658003545,0.013698471758712345,0.013300766723272298,0.012694299173065565,0.01217034446987596)
c_vpop = c(0.010861588073384765,0.0107445767718828,0.01038439316283025,0.009979573154871031,0.00957626007098271,0.009317036614863756,0.009048962151439131,0.008961979979620139,0.009079132201113626,0.008923076528085796,0.008939813476321676,0.008934245200211658,0.009115949411549001,0.008872283506817092,0.009093216384823334,0.00913503725760684,0.009157422182526739,0.009308966152977684,0.009465471151164086,0.009477553093394446,0.009746276324482443,0.00983932143544584)

#temps
Naiftemps = c(2.1869078824940935,0.8859744003987006,0.7759362800132901,0.6745039136887182,0.5962077637330183,0.5345024772223863,0.4750488417749557,0.42358258494536327,0.3770032688275251,0.3433737052938571,0.3006233945658594,0.2717969289353219,0.24371661481098641,0.22205051251476668,0.2028701800428234,0.1819650617616657,0.16054177617395157,0.1439594737891317,0.12987758793561724,0.11818775003691671,0.1064438469063792,0.09723469226225635,0.08755630607649144,0.07762802141169521,0.07014550723567631,0.06436037418783225,0.057451675059066745,0.051712825568517425,0.046945454850856466,0.041979480101890135,0.039067344543709394,0.035145256829592436,0.03208567158889545,0.029189093989958653,0.026696335462197282,0.024836360934731246,0.022926350450383933,0.021380126439751918,0.01977830574424099,0.01830263146042528,0.017292125959834613,0.016038183697578264,0.015238233608978146,0.014553127658003545,0.013698471758712345,0.013300766723272298,0.012694299173065565,0.01217034446987596)
vpoptemps = c(0.008608962935617248, 0.5421996886075015, 5.736728327192853, 9.598066125812167, 30.653669532560542, 19.45889230485824, 17.09588862961459, 15.125646240733904, 13.257270470429711, 11.917461505205257, 10.454172979178972, 9.461963145599528, 8.355109322578263, 7.592733656453042, 6.87333264511961, 6.225347725893385, 5.4397985721721795, 4.979618078854105, 4.424300127805671, 3.9696491067631423, 3.5824246680818073, 3.2306991265135854, 2.926117568074424, 2.6631194507161844, 2.2593035889692854, 2.1337227951491435, 1.8618118125369167, 1.669923456844359, 1.4636099874114, 1.2836704170850561, 1.1540355015505022, 1.0166425427864738, 0.8517278377510337, 0.7512722990253987, 0.6607060973124631, 0.5833630065342588, 0.4976690343325458, 0.4303620654533373, 0.3549467602259303, 0.3047600555227407, 0.26277731098641466, 0.21574819495717662, 0.17104305404607206, 0.1440633185543414, 0.1169600950236267, 0.09338258287802717, 0.07320619691376255, 0.05753750247341997)
jointreetemps = c(0.05651038696101595,0.05548537341258122,0.06120626594802126,0.0623701068738925,0.062498095688127586,0.06209152920112227,0.061362323464264616,0.061881492247489664,0.059686154865623155,0.058089586200531604,0.056820131681925574,0.05545843233165978,0.0545152713747785,0.052729507567926756,0.05129026760927348,0.050216916014471355,0.04846936488481984,0.04752081940342587,0.0458392634746013,0.0454242981024808,0.0435369152023036,0.042790418266391024,0.0409652832250443,0.03991381951417602,0.03865888249409333,0.037593355286473715,0.03649868366066155,0.03593367609273479,0.0345449454001772,0.03359148778056704,0.03271498050797401,0.03201600616509155,0.031172961237448317,0.030205463046367394,0.02980450838009451,0.0286410023257531,0.02801563363851152,0.02784097995422327,0.026706283298877732,0.0259410680744241,0.02541740527170703,0.024615321249261666,0.024441794853809803,0.023971850634967512,0.02294020736119315,0.02211592062906084,0.021499690231836975,0.020839556445658595)

#Naiftemps = c(6.7490853730555935, 4.265753310090626, 3.7041168119843095, 3.291259865345597, 2.9533871759772756, 2.59211119281753, 2.272189572433383, 2.0784379701744893, 1.8283094864736913, 1.6223683818476937, 1.4385192401596105, 1.2560887032327879, 1.1556650209657784, 1.056928474232382, 0.9196997318409306, 0.8271722811443257, 0.7018638395103476, 0.654304578790748, 0.5750706312051941, 0.5217329763965913, 0.45653312626809145, 0.3901171502772893, 0.33939873657513864, 0.28628908866495334, 0.2617215656702286, 0.2270667492898688, 0.2038611238333559, 0.16756462065467334, 0.14430445191397268, 0.11893353523603409, 0.0994681577167591, 0.08624670025699986, 0.07441577181117273, 0.05918456742864872, 0.05273900128499932, 0.046416298187474635, 0.03925677742459083, 0.032305787839848506, 0.02929962816177465, 0.02478049939131611, 0.02188064344650345, 0.019815978290274584, 0.0182589725415934, 0.01703811639388611)
#vpoptemps = c(0.01520711673414305, 2.4011439210526317, 24.993440203103912, 51.72382029554656, 182.01436638461539, 157.84785736707153, 161.6351586734143, 156.03981411875844, 161.6407345222672, 136.4918607219973, 117.88298702766532, 114.36496958299595, 103.10419447503374, 108.01657291228071, 79.69395304723346, 94.36547147908232, 80.47813364642376, 58.86996252968961, 56.18891561470985, 52.88525764979757, 46.485835516194335, 35.87541209784076, 26.92618482726046, 25.959350599865047, 25.19442691025641, 13.896073047233468, 13.85121519905533, 19.17427229892038, 9.428872972334682, 8.947878190958164, 9.406677424426451, 6.435555587719298, 5.033173327260458, 2.628097851551957, 3.3837534622132255, 2.213513402834008, 1.7288274527665317, 0.8373433130904183, 1.361978519568151, 0.7262472660364618, 0.35925706482106684, 0.22110071033085754, 0.1486765408507765, 0.07159485145172181)
#jointreetemps = c(0.0691693280806168,0.06654608068443121,0.07256938495874476,0.07377797687001217,0.07320432787772217,0.0722793575679697,0.07092746354659814,0.06932008832679562,0.06753988286216692,0.0655458321385094,0.06349193764371704,0.06123165345597187,0.05893382436088192,0.056715938996347894,0.05464607669417016,0.052414928310564046,0.050042244690923846,0.048058093128635196,0.04610830853510077,0.04415676281617747,0.04236206627891249,0.04499164405518734,0.03902247227106723,0.037351015622886515,0.03585822920330042,0.034600085215744626,0.03333552772893277,0.03199651021236304,0.03092518605437576,0.02984158014337887,0.028999750642499662,0.028218356824022725,0.027235291965372648,0.02678806763154335,0.026055907953469497,0.02523585979981063,0.024701852022183148,0.02511995157581496,0.023732737454348708,0.023295820167726227,0.022987125659407547,0.02264744406871365,0.0223533163803598,0.02221581962667388)

#temps conf
c_Naiftemps = c(5.825714380863392E-5,7.467741713131934E-5,7.874005730354485E-5,9.634253464465466E-5,1.0492256731643185E-4,1.2314165340509745E-4,1.3206651870520007E-4,1.7646944136045804E-4,1.7421049529386254E-4,1.7259208701506554E-4,1.8753422740190828E-4,2.165709993540696E-4,2.392953541891117E-4,2.4272466653793426E-4,2.5865001666338093E-4,2.574419679224536E-4,2.5728239038577303E-4,3.054320190361853E-4,3.102239821327525E-4,3.354078769230858E-4,3.213923298565306E-4,3.256574310299249E-4)
c_vpoptemps = c(6.98017195027686E-4,0.0013948425795824164,0.0014257605092347248,5.747709647325909E-4,4.217789739549773E-4,4.5748807978158166E-4,4.868895926868611E-4,5.34863288491936E-4,5.89507750837444E-4,6.400229646381698E-4,6.818146563558449E-4,7.195175587107395E-4,0.0010305845860537378,0.0010825020708166793,0.0011391206729347194,0.0011967570863145396,0.0012433720266704928,0.0012291128279559114,0.0012167330383921018,9.729224254311251E-4,8.616359596943645E-4,7.577140443470682E-4)
#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
jointree = 100-100*jointree
Naif = 100-100*Naif
vpop = 100-100*vpop
oracle = 100-100*oracle
c_Naif = 100*c_Naif
c_vpop = 100*c_vpop
#FIN MAJ VERS ERROR

nb_val = length(Naif)
nb_val = length(vpop)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = min(min_val_erreur,100-100*Naif)
min_val_erreur = min(min_val_erreur,100-100*vpop)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = max(max_val_erreur,100-100*Naif)
max_val_erreur = max(max_val_erreur,100-100*vpop)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

min_val_time = 30000
min_val_time = min(min_val_erreur,100-100*Naiftemps)
min_val_time = min(min_val_erreur,100-100*vpoptemps)
min_val_time = ceiling(min_val_erreur)

max_val_time = 30000
max_val_time = max(max_val_time,Naiftemps)
max_val_time = max(max_val_time,vpoptemps)
max_val_time = floor(max_val_time)


x_lim_time = c(0,(nb_val-1))
if(min_val_time-y_padding_time <= 0){
  min_val_time = min_val_time+y_padding_time+0.00001
}
size = 0:(nb_val-1)
y_lim_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time))
x_axp_time = c(0, (nb_val-1), x_pas_erreur)
y_axp_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time),y_pas_time)
#fin parametres graphes
#--------------------------------------------------------------------------------------------

  png(file=paste("Taux_erreur_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size)) + scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
    ylab("Taux d'erreur (%)") + xlab("Nombre de variables configurées") + theme_bw() #+ theme(legend.position="bottom")
    +geom_line(aes(y=jointree, colour="Jointree"), colour="springgreen", linetype = "dotted") + geom_point(aes(y=jointree, shape="Jointree"), colour="springgreen", fill="springgreen") 
  +geom_line(aes(y=Naif, colour="RC"), colour="firebrick3", linetype = "dotted") + geom_point(aes(y=Naif, shape="RC"), colour="firebrick3", fill="firebrick3") 
  +geom_line(aes(y=vpop, colour="DRC"), colour="deepskyblue4", linetype = "dotted") + geom_point(aes(y=vpop, shape="DRC"), colour="deepskyblue4", fill="deepskyblue4")
  +geom_line(aes(y=oracle, colour="Oracle"), colour="black", linetype = "dotted") + geom_point(aes(y=oracle, shape="Oracle"), colour="black", fill="black")
  + scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Jointree' #Naif
                                  ,'RC' #Naif
                                  ,'DRC' #vpop
                                 ,'Oracle'
                      ),
                      values =c(NULL
                                  ,'Jointree'='springgreen' #Naif
                                  ,'RC'='firebrick3' #Naif
                                  ,'DRC'='deepskyblue4' #vpop
                                ,'Oracle'='black'
                                  ))
    + scale_shape_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Jointree' #Naif
                                  ,'RC' #Naif
                                  ,'DRC' #vpop
                                 ,'Oracle'
                      ),
                      values =c(NULL
                                  ,'Jointree'=21 #Naif
                                  ,'RC'=24 #Naif
                                  ,'DRC'=22 #vpop
                                ,'Oracle'=1
                                  ))
  
    + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                  ,'Jointree'='springgreen' #Naif
                                  ,'RC'='firebrick3' #Naif
                                  ,'DRC'='deepskyblue4' #vpop
                                  ,'Oracle'='black'
                                  ),
                                  fill = c(NULL
                                  ,'Jointree'='springgreen' #Naif
                                  ,'RC'='firebrick3' #Naif
                                  ,'DRC'='deepskyblue4' #vpop
                                  ,'Oracle'='black'
                                  ))))
)
  dev.off()

  png(file=paste("Temps_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size))
  + scale_y_log10(
   breaks = scales::trans_breaks("log10", function(x) 10^x),
   labels = scales::trans_format("log10", function(x) round(10^x,2)))
   + annotation_logticks(sides="l")
   + theme_bw() +
    ylab("Temps (ms)") + xlab("Nombre de variables configurées") #+ theme(legend.position="bottom")
    +geom_line(aes(y=jointreetemps, colour="Jointree"), colour="springgreen", linetype = "dotted") + geom_point(aes(y=jointreetemps, shape="Jointree"), colour="springgreen", fill="springgreen") 
    +geom_line(aes(y=Naiftemps, colour="RC"), colour="firebrick3", linetype = "dotted") + geom_point(aes(y=Naiftemps, shape="RC"), colour="firebrick3", fill="firebrick3") 
    +geom_line(aes(y=vpoptemps, colour="DRC"), colour="deepskyblue4", linetype = "dotted") + geom_point(aes(y=vpoptemps, shape="DRC"), colour="deepskyblue4", fill="deepskyblue4")
   + scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Jointree' #Naif
                                  ,'RC' #Naif
                                  ,'DRC' #vpop
                      ),
                      values =c(NULL
                                  ,'Jointree'='springgreen' #Naif
                                  ,'RC'='firebrick3' #Naif
                                  ,'DRC'='deepskyblue4' #vpop
                                  ))
    + scale_shape_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                  ,'Jointree' #Naif
                                  ,'RC' #Naif
                                  ,'DRC' #vpop
                      ),
                      values =c(NULL
                                  ,'Jointree'=21 #Naif
                                  ,'RC'=24 #Naif
                                  ,'DRC'=22 #vpop
                                  ))
  
    + guides(shape = guide_legend(override.aes = list(colour = c(NULL
                                  ,'Jointree'='springgreen' #Naif
                                  ,'RC'='firebrick3' #Naif
                                  ,'DRC'='deepskyblue4' #vpop
                                  ),
                                  fill = c(NULL
                                  ,'Jointree'='springgreen' #Naif
                                  ,'RC'='firebrick3' #Naif
                                  ,'DRC'='deepskyblue4' #vpop
                                  ))))
  )
  dev.off()
