library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "alarm"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data
#result
rc = c(0.7565026010404161,0.7763105242096838,0.7961184473789515,0.8165266106442577,0.8381352541016407,0.8507402961184474,0.8585434173669467,0.8769507803121248,0.8745498199279712,0.882953181272509,0.897358943577431,0.8945578231292517,0.9059623849539816,0.9105642256902761,0.9117647058823529,0.9053621448579432,0.9177671068427371,0.916766706682673,0.9251700680272109,0.9207683073229291,0.9347739095638256,0.9283713485394157,0.9321728691476591,0.9295718287314926,0.9347739095638256,0.9307723089235694,0.9343737494997999,0.9399759903961584,0.9317727090836334,0.937374949979992,0.9397759103641457,0.9431772709083633,0.9407763105242097,0.933173269307723,0.9335734293717487,0.9367747098839536,0.936374549819928)
dRC = c(0.7565026010404161,0.7769107643057223,0.7963185274109644,0.8145258103241296,0.835734293717487,0.8487394957983193,0.8543417366946778,0.8781512605042017,0.8743497398959584,0.8775510204081632,0.8949579831932774,0.8913565426170468,0.9049619847939175,0.9059623849539816,0.9053621448579432,0.9031612645058024,0.9177671068427371,0.9175670268107243,0.9217687074829932,0.9163665466186475,0.9253701480592237,0.9179671868747499,0.9245698279311725,0.9225690276110444,0.9267707082833133,0.9233693477390956,0.9319727891156463,0.9313725490196079,0.9225690276110444,0.9263705482192878,0.9299719887955182,0.9321728691476591,0.9339735894357744,0.9255702280912365,0.9221688675470188,0.9255702280912365,0.9267707082833133)
oracle = c(0.7565026010404161,0.7787114845938375,0.7965186074429772,0.8181272509003601,0.84093637454982,0.8531412565026011,0.8647458983593438,0.8879551820728291,0.8877551020408163,0.898359343737495,0.9145658263305322,0.9161664665866347,0.9297719087635054,0.928171268507403,0.9359743897559024,0.9387755102040817,0.9471788715486195,0.9483793517406963,0.9553821528611445,0.9591836734693877,0.9623849539815926,0.9633853541416567,0.9677871148459384,0.9663865546218487,0.9679871948779512,0.9739895958383353,0.9717887154861945,0.9749899959983993,0.9717887154861945,0.976390556222489,0.9765906362545018,0.9831932773109243,0.9839935974389756,0.9821928771508603,0.9813925570228091,0.985594237695078,0.9849939975990396)
jointree = c(0.7565026010404161,0.776110444177671,0.7961184473789515,0.8165266106442577,0.8381352541016407,0.8507402961184474,0.8589435774309724,0.8775510204081632,0.8753501400560224,0.8835534213685474,0.8979591836734694,0.8945578231292517,0.9073629451780713,0.9113645458183274,0.9139655862344938,0.9071628651460584,0.9201680672268907,0.9193677470988395,0.9287715086034414,0.9241696678671468,0.9381752701080432,0.9329731892757103,0.935374149659864,0.9349739895958383,0.9409763905562225,0.9367747098839536,0.9405762304921969,0.9473789515806322,0.9403761504601841,0.946578631452581,0.9485794317727091,0.9529811924769908,0.9525810324129652,0.9469787915166067,0.9479791916766707,0.9493797519007603,0.9539815926370548)

#result conf
c_rc = c(0.011898996080451365,0.011553098025281573,0.01116955202357754,0.010730739669294857,0.010211537455441252,0.00987933552521324,0.009661635695786604,0.009107202365791663,0.009183027128908169,0.008912644630037317,0.00841398241303957,0.008514699710240716,0.008092148272047694,0.007911682910222304,0.007863583499324254,0.00811524350622754,0.0076163514270256825,0.007658362183829822,0.007294682725762574,0.00748828894414577,0.006845763803119829,0.007149278202728537,0.006971205704882456,0.007093696902875341,0.006845763803119829,0.007037519254728716,0.0068652610495801725,0.006585349474396794,0.006990238635819292,0.006717205888970734,0.006595613853910598,0.006418235565930343,0.006544083943985073,0.006923316692538858,0.006904036881957061,0.006747158922772963,0.006767031221169823)
c_dRC = c(0.011898996080451365,0.011542046579639986,0.011165472820234798,0.010775864256214138,0.010272248330239188,0.009933628714739441,0.009780055533884419,0.009068869038834488,0.009189295852817728,0.009088071149308085,0.008500428025285982,0.008627509827259704,0.00813058496095588,0.008092148272047694,0.00811524350622754,0.008199080527408788,0.0076163514270256825,0.007624780166965036,0.007444905311048664,0.007675074037056169,0.00728571163559721,0.007607909304529805,0.007321504826906786,0.007409940782795282,0.007222482724530579,0.007374743730320437,0.0069807308609093404,0.007009202325082698,0.007409940782795282,0.007240625717677878,0.007075037979483854,0.006971205704882456,0.006884685203550596,0.007276725256954291,0.0074274519067000526,0.007276725256954291,0.007222482724530579)
c_oracle = c(0.011898996080451365,0.011508684195530871,0.011161389369248848,0.010694295756035505,0.010139696431185057,0.009813373344040695,0.009481508154935349,0.00874478942531847,0.008751607638285768,0.008377544054542318,0.007749634887091126,0.007683410325692395,0.00708437575585951,0.007158484751938653,0.006786827197575339,0.0066466285490034225,0.0062012292079208905,0.006134239348721629,0.0057240156587417025,0.0054856209142380525,0.00527488695128833,0.005206973702051867,0.004895112478863982,0.004996776218339029,0.004880390993791719,0.00441274320232036,0.004590450426964946,0.0043292723318659725,0.004590450426964946,0.004209326450072967,0.004191881801753643,0.00356384586562872,0.0034793726823946157,0.003666512863848337,0.0037464735756028867,0.0033035063476571738,0.0033706002080323926)
c_jointree = c(0.011898996080451365,0.011556774167041225,0.01116955202357754,0.010730739669294857,0.010211537455441252,0.00987933552521324,0.00965020849339473,0.009088071149308085,0.009157875723915835,0.008892783480842133,0.0083921493831144,0.008514699710240716,0.00803786735338012,0.007879664879646557,0.007774258355410856,0.008045655664729714,0.007514149756980071,0.00754843595483321,0.007130816499833548,0.007339310808283309,0.006676994980568139,0.0069329298348492175,0.006816379512344288,0.00683598757485636,0.006533715065632655,0.006747158922772963,0.00655443172468473,0.006190127003604573,0.006564758507497912,0.006234387584832572,0.006122985528521322,0.005868619002923539,0.005892301452428047,0.006212306618170904,0.0061566702834403905,0.0060777112442605315,0.005808897791288656)

#temps
rctemps = c(3.260436447979192,1.0735578707482993,0.93003493717487,0.8156372893157263,0.6635573503401361,0.5699110468187275,0.49307356282513004,0.4128526744697879,0.35688447659063627,0.3063106844737895,0.2527949253701481,0.2095138793517407,0.17454798039215685,0.1403603757503001,0.12034017987194878,0.09953717326930772,0.08602137775110044,0.0703179943977591,0.0594418087234894,0.0502299549819928,0.0432231862745098,0.03614089775910364,0.031091359543817528,0.026876727290916367,0.02202147919167667,0.01914060424169668,0.01692589595838335,0.015571928171268507,0.01365353181272509,0.012042611444577831,0.010987975590236095,0.010094930972388956,0.009418771108443377,0.008660603041216486,0.008147490196078432,0.007782820528211285,0.007425873949579832)
dRCtemps = c(0.27289750460184076,0.3344440318127251,0.32342468587434975,0.3047264599839936,0.28732415046018406,0.2942181770708283,0.26818107883153264,0.250398700080032,0.2378962581032413,0.22206827671068427,0.20842731852741098,0.1839763393357343,0.17096564345738297,0.137794600040016,0.12937974649859943,0.11762295298119248,0.1078894405762305,0.09029262284913965,0.07947772328931572,0.07179842196878751,0.06220688915566226,0.05488164325730292,0.04835967206882753,0.0424261262505002,0.036904663665466186,0.03202403481392557,0.028686673469387754,0.025935699479791918,0.023325244097639055,0.020597298519407763,0.01904805162064826,0.016988200480192076,0.015206086834733894,0.013876660464185675,0.013077431172468987,0.012294451780712284,0.01149080412164866)
jointreetemps = c(0.021737294917967186,0.021609754901960786,0.023704201080432172,0.02439247238895558,0.024579980592236896,0.024568289715886354,0.024671546218487394,0.02457873269307723,0.0244480456182473,0.024332928771508604,0.024150624649859943,0.02456728411364546,0.02440703481392557,0.024152599639855943,0.024626024209683874,0.022941143257302923,0.02365316906762705,0.02240504481792717,0.02220267386954782,0.022514459783913567,0.02146152881152461,0.021125953781512604,0.020945569427771107,0.02056649019607843,0.0202254699879952,0.019901987595038015,0.019472195478191276,0.019164631652661065,0.01955662304921969,0.018436654861944776,0.01813618067226891,0.017706675470188074,0.017289522008803522,0.01690908463385354,0.016528327531012407,0.015908469987995198,0.015447368347338935)

#temps conf
c_rctemps = c(0.044645436283594554,0.03718325842821587,0.03846717350242364,0.03198977311307629,0.026813089451046244,0.02538970076697144,0.02254604407482015,0.020004925812057827,0.017985360206016772,0.015828612864037108,0.013067360726790487,0.011316047644701559,0.009492948198985045,0.007541351700576047,0.0069856037222453616,0.005223991571625405,0.004735561546538621,0.003431053164729543,0.0032539773087716575,0.0024704454927248058,0.0023470463559883605,0.0018362105474217234,0.001473236241736253,0.0012861994820142259,7.50956105316084E-4,6.441395427702734E-4,4.64407761266476E-4,4.663975136954178E-4,3.708769199222485E-4,2.627281242757477E-4,2.084799353126599E-4,1.6997291007478575E-4,1.5355085516033184E-4,1.2166840833362048E-4,1.129651930632232E-4,1.0311694886721763E-4,9.60614575926446E-5)
c_dRCtemps = c(0.009655965801481443,0.008352388241588977,0.009529878234955496,0.013130120775472785,0.01492834664601649,0.019119110128629258,0.016873897855699625,0.015144322247090844,0.01412412426599225,0.013742215580684487,0.013126155379179055,0.011128975279350304,0.01087014176205347,0.007341558752194815,0.007998062906879827,0.007057500958581759,0.006504618892188761,0.004994967119463412,0.004441823019135774,0.0037510753695651692,0.0030496104644417796,0.0027421892274049177,0.0022569770174594864,0.0019727596139615233,0.0015774400149314832,0.001209454998157746,9.993785775267465E-4,9.277948480841876E-4,0.001091916215959409,6.311783492331936E-4,8.801760167337482E-4,5.038874493232156E-4,3.410003453145174E-4,2.8194846043173887E-4,3.1812193652384614E-4,2.918115928800728E-4,2.4485531439322373E-4)
c_jointreetemps = c(6.625292612526594E-4,6.461846777205947E-4,7.091947860486793E-4,7.305740973884003E-4,7.554753962042584E-4,7.756323874248317E-4,7.808510968729634E-4,7.922662942161588E-4,7.824529616438664E-4,7.512411164727916E-4,7.479726421790896E-4,0.001423749835924751,0.0016180089983795643,0.0016939217443928912,0.002686867884604553,7.317778220371959E-4,0.0021164841857063106,7.233463738437891E-4,7.281318817253377E-4,0.0016491241542350142,6.978222716552678E-4,6.782607095755156E-4,6.812374791330922E-4,6.785012923377258E-4,6.473088513920302E-4,6.33942735060111E-4,6.172000193633028E-4,6.124329260247301E-4,0.0015284488597482944,5.777371587713996E-4,6.239473715353715E-4,5.504260443439925E-4,5.282424379572948E-4,5.357713626588625E-4,4.934440775974135E-4,4.5227823871917054E-4,4.325728790485179E-4)
#fin data
#--------------------------------------------------------------------------------------------


#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
dRC = 100-100*dRC
oracle = 100-100*oracle
rc = 100-100*rc
jointree = 100-100*jointree

c_rc = 100*c_rc
c_dRC = 100*c_dRC
c_oracle = 100*c_oracle
c_jointree = 100*c_jointree
#FIN MAJ VERS ERROR

nb_val = length(rc)
nb_val = length(dRC)
nb_val = length(oracle)
nb_val = length(jointree)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*rc)
min_val_erreur = min(min_val_erreur,100-100*dRC)
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*jointree)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 30000
max_val_erreur = max(max_val_erreur,100-100*rc)
max_val_erreur = max(max_val_erreur,100-100*dRC)
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*jointree)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

min_val_time = 30000
min_val_time = min(min_val_erreur,100-100*rctemps)
min_val_time = min(min_val_erreur,100-100*dRCtemps)
min_val_time = min(min_val_erreur,100-100*jointreetemps)
min_val_time = ceiling(min_val_erreur)

max_val_time = 30000
max_val_time = max(max_val_time,rctemps)
max_val_time = max(max_val_time,dRCtemps)
max_val_time = max(max_val_time,jointreetemps)
max_val_time = floor(max_val_time)


x_lim_time = c(0,(nb_val-1))
if(min_val_time-y_padding_time <= 0){
  min_val_time = min_val_time+y_padding_time+0.00001
}
size = 0:(nb_val-1)
y_lim_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time))
x_axp_time = c(0, (nb_val-1), x_pas_erreur)
y_axp_time = c((min_val_time-y_padding_time),(max_val_time+y_padding_time),y_pas_time)
#fin parametres graphes
#--------------------------------------------------------------------------------------------

  png(file=paste("Taux_erreur_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
    ylab("Error rate (%)") + xlab("Number of known choices") + theme_bw() #+ theme(legend.position="bottom")
    +geom_line(aes(y=dRC, colour="DRC")) + geom_point(aes(y=dRC), colour="coral3") 
    +geom_line(aes(y=oracle, colour="Oracle")) + geom_point(aes(y=oracle), colour="black") 
    +geom_line(aes(y=rc, colour="RC")) + geom_point(aes(y=rc), colour="darkorchid3") 
    +geom_line(aes(y=jointree, colour="Classical Bayes")) + geom_point(aes(y=jointree), colour="springgreen4") 
    + scale_colour_manual(name = 'Legend', guide = 'legend',
                        values =c(NULL
                                  ,'DRC'='coral' #dRC
                                  ,'Oracle'='black' #oracle
                                  ,'RC'='darkorchid1' #rc
                                  ,'Classical Bayes'='springgreen' #jointree
                                  )))
  dev.off()

  png(file=paste("Temps_sur_",dataset_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
  (ggplot(NULL, aes(size))
  + scale_y_log10(
   breaks = scales::trans_breaks("log10", function(x) 10^x),
   labels = scales::trans_format("log10", function(x) round(10^x,2)))
   + annotation_logticks(sides="l")
   + theme_bw() +
    ylab("Time (ms)") + xlab("Number of known choices") #+ theme(legend.position="bottom")
    +geom_line(aes(y=dRCtemps, colour="DRC")) + geom_point(aes(y=dRCtemps), colour="coral3")
    +geom_line(aes(y=rctemps, colour="RC")) + geom_point(aes(y=rctemps), colour="darkorchid3") 
    +geom_line(aes(y=jointreetemps, colour="Classical Bayes")) + geom_point(aes(y=jointreetemps), colour="springgreen4") 
   + scale_colour_manual(name = 'Legend', guide = 'legend',
                        values =c(NULL
                                  ,'DRC'='coral' #dRC
                                  ,'RC'='darkorchid1' #rc
                                  ,'Classical Bayes'='springgreen' #jointree
                                  )))
  dev.off()
