library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "alarm"
algo_name = "naif"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data

oracle = c(0.7565026010404161,0.7787114845938375,0.7965186074429772,0.8181272509003601,0.84093637454982,0.8531412565026011,0.8647458983593438,0.8879551820728291,0.8877551020408163,0.898359343737495,0.9145658263305322,0.9161664665866347,0.9297719087635054,0.928171268507403,0.9359743897559024,0.9387755102040817,0.9471788715486195,0.9483793517406963,0.9553821528611445,0.9591836734693877,0.9623849539815926,0.9633853541416567,0.9677871148459384,0.9663865546218487,0.9679871948779512,0.9739895958383353,0.9717887154861945,0.9749899959983993,0.9717887154861945,0.976390556222489,0.9765906362545018,0.9831932773109243,0.9839935974389756,0.9821928771508603,0.9813925570228091,0.985594237695078,0.9849939975990396)
courbe1 = c(0.7565026010404161,0.7773109243697479,0.795718287314926,0.8123249299719888,0.8365346138455382,0.8465386154461785,0.8507402961184474,0.8709483793517407,0.8637454981992797,0.8713485394157663,0.882953181272509,0.879951980792317,0.8873549419767908,0.8921568627450981,0.894157663065226,0.8865546218487395,0.899359743897559,0.8917567026810724,0.9027611044417767,0.8957583033213286,0.9087635054021609,0.9037615046018407,0.907563025210084,0.8991596638655462,0.9105642256902761,0.9091636654661864,0.9057623049219687,0.9135654261704682,0.9081632653061225,0.905562224889956,0.9093637454981993,0.9087635054021609,0.9187675070028011,0.9103641456582633,0.9093637454981993,0.9105642256902761,0.913765506202481)
courbe1_2 = c(0.7511336356361696,0.7911443051480395,0.8055481461723126,0.8114163777007202,0.8442251267004535,0.8442251267004535,0.8564950653507603,0.8636969858628968,0.8650306748466258,0.8692984795945585,0.8716991197652707,0.8810349426513737,0.8858362229927981,0.8903707655374766,0.8826353694318485,0.8922379301146972,0.8903707655374766,0.9082421979194452,0.8919711923179514,0.8949053080821553,0.9063750333422246,0.9013070152040544,0.8981061616431049,0.899173112830088,0.9015737530008002,0.9127767404641237,0.9109095758869031,0.9093091491064283,0.9077087223259536,0.9146439050413444,0.916511069618565,0.9015737530008002,0.9101093624966657,0.9175780208055482,0.9173112830088024,0.9189117097892772,0.9117097892771405)
courbe1_4 = c(0.7574302697759487,0.799039780521262,0.7951531778692272,0.8125285779606767,0.838591678097851,0.8353909465020576,0.8529949702789209,0.855281207133059,0.8632830361225423,0.8664837677183356,0.8653406492912665,0.8607681755829903,0.8783721993598537,0.8797439414723366,0.8731138545953361,0.8818015546410608,0.8731138545953361,0.8788294467306813,0.8845450388660265,0.8932327389117513,0.8968907178783722,0.8932327389117513,0.8920896204846822,0.8902606310013718,0.8982624599908551,0.8996342021033379,0.9021490626428899,0.904435299497028,0.9003200731595793,0.903063557384545,0.8927754915409236,0.9016918152720622,0.8998628257887518,0.9085505258344765,0.9028349336991313,0.8964334705075446,0.9014631915866483)
courbe1_8 = c(0.764668231278003,0.7866439086835929,0.7936846596970344,0.8171538297418391,0.8109665030936634,0.8355024535950502,0.8378493705995306,0.8393428632387455,0.8455301898869213,0.8576914870919565,0.850650736078515,0.855344570087476,0.861105184553019,0.8734798378493706,0.8689993599317261,0.8685726477490933,0.8709195647535737,0.8685726477490933,0.874759974397269,0.8713462769362065,0.8786003840409644,0.8798805205888628,0.8822274375933433,0.8788137401322808,0.8724130573927885,0.8839342863238745,0.8832942180499254,0.8843609985065074,0.8790270962235972,0.8871346276936206,0.8869212716023043,0.884147642415191,0.8828675058672925,0.8907616812459995,0.8845743545978237,0.8896949007894175,0.890975037337316)
courbe1_16 = c(0.7571753045632872,0.7864959735701011,0.8061119141028288,0.7978525707206278,0.8230435680363412,0.8154036754078051,0.822837084451786,0.8313029114185422,0.837084451786083,0.8230435680363412,0.8377039025397481,0.8354325831096427,0.8550485236423704,0.8505058847821598,0.8554614908114805,0.8548420400578154,0.8486475325211645,0.8550485236423704,0.8511253355358249,0.859178195333471,0.8600041296716912,0.8583522609952509,0.8581457774106959,0.8579392938261409,0.8515383027049349,0.8637208341936816,0.8626884162709064,0.8620689655172413,0.8604170968408011,0.8705347924839976,0.8633078670245715,0.8633078670245715,0.8659921536237869,0.8612430311790212,0.8709477596531076,0.8562874251497006,0.8723931447449927)
courbe1_32= c(0.7604145498882341,0.7805324121113595,0.7947571631782158,0.797602113391587,0.8063401747612274,0.8043080674659622,0.8087787035155456,0.8097947571631782,0.8093883357041252,0.8140621824832351,0.8266612477138793,0.8126397073765494,0.8219874009347694,0.8244259296890876,0.8154846575899207,0.8321479374110953,0.8258484047957733,0.8236130867709816,0.8244259296890876,0.8165007112375533,0.823409876041455,0.8290997764681975,0.8508433245275351,0.8203617150985572,0.8260516155252997,0.8351960983539931,0.8431213168055274,0.8402763665921561,0.8228002438528754,0.8362121520016257,0.8345864661654135,0.8323511481406218,0.8356025198130461,0.8463726884779517,0.8364153627311522,0.8270676691729323,0.8358057305425727)

tps_courbe1 = c(7.936918767507003E-4,0.0011515302120848339,0.001487282713085234,0.0018068359343737495,0.0020886490596238494,0.002416655662264906,0.0026974421768707485,0.002975955782312925,0.003261547819127651,0.0035494239695878353,0.003823299119647859,0.004080865346138455,0.004394667667066827,0.0045784957983193274,0.004926040416166466,0.0051899153661464584,0.005447185474189676,0.0057940652260904365,0.006051786514605842,0.006303227090836335,0.006591891956782713,0.0068678813525410165,0.007102014805922369,0.0073705584233693475,0.007715587434973989,0.0080090856342537,0.008284668867547019,0.008540610244097638,0.008928211884753902,0.009178201080432173,0.00941289075630252,0.009722789315726291,0.010020828731492596,0.010278527410964385,0.010547804921968787,0.010785344137655061,0.011240849539815927)
tps_courbe1_2 = c(8.309546545745533E-4,0.001252491064283809,0.001563989597225927,0.0018942934115764203,0.002215493198186183,0.002548440917578021,0.0028166692451320353,0.003100308615630835,0.0033916070952253936,0.0036705086689783942,0.003966024806615097,0.00424447292611363,0.00461783355561483,0.004734368098159509,0.0050964219791944515,0.00536912536676447,0.0057189522539343824,0.0059649098426247,0.006241758602293945,0.006544046145638837,0.006793066417711389,0.0070603851693785006,0.0073641363030141375,0.007649408375566818,0.008016673512936784,0.008278150973592958,0.008589639637236596,0.00888834835956255,0.009274868231528408,0.009564427580688184,0.009705023206188317,0.01010215657508669,0.010326051213656975,0.010640058415577486,0.010901476660442784,0.011145565217391304,0.011626103494265138)
tps_courbe1_4 = c(7.953612254229538E-4,0.0011909211248285322,0.0015138486511202562,0.0018301495198902607,0.00214677617741198,0.002431254000914495,0.0027149062642889805,0.0030103477366255145,0.003311445816186557,0.003559721993598537,0.0038267716049382714,0.004093438957475995,0.004449852309099223,0.0045932700045724735,0.004954103566529492,0.005201666209419296,0.005480743484224965,0.005806328989483311,0.006025816643804298,0.006340823273891175,0.006607283036122543,0.006851097393689986,0.007098893232738912,0.0073489561042524,0.007701622542295382,0.008010059670781894,0.008284767032464564,0.008549330589849108,0.008951777549154093,0.009128645404663923,0.009392501143118428,0.009745401920438957,0.01000514357567444,0.010214365112025605,0.010514438957475995,0.010723836305441244,0.01120079812528578)
tps_courbe1_8 = c(7.801147855771282E-4,0.0011635491785790485,0.001473604864518882,0.0017977736291871133,0.0020838288884147643,0.0024078075528056325,0.0026705662470663536,0.0029532323447834436,0.003221668017921912,0.0035143671858331557,0.0037837793898015787,0.004037160870492853,0.004358501386814593,0.004532224663964156,0.004888572221036911,0.00513721399615959,0.005387012588009388,0.00575682824834649,0.005949175165350971,0.00622263217409857,0.0064710305099210585,0.006743793044591423,0.0069973981224663966,0.007264138894815447,0.007624440366972477,0.007833342436526563,0.00815255749946661,0.008396352037550672,0.00876841305739279,0.009036787283976958,0.009267201621506294,0.009541300405376573,0.009810707702154897,0.010090736931939407,0.010367962876040112,0.010589656923405162,0.010991834435673139)
tps_courbe1_16 = c(7.847425149700599E-4,0.0011467871154243238,0.0014612205244683048,0.0017874257691513525,0.0020720448069378485,0.002373501135659715,0.0026650142473673344,0.0029380311790212677,0.0032195552343588685,0.003505662192855668,0.0037392651249225687,0.004015311170761924,0.004340719595292174,0.004513369399132769,0.004839020028907702,0.00512524117282676,0.005383862688416271,0.005695819739830683,0.005962016931653933,0.006192108197398307,0.006477806731364857,0.006743355151765435,0.006994676233739418,0.007259833367747264,0.0076047697708032215,0.007866402436506298,0.008155682428246954,0.008422688622754491,0.008745306834606649,0.008991189345447037,0.009225735907495354,0.00956529465207516,0.00984782180466653,0.010057056576502169,0.010361780714433203,0.010566755936403056,0.011013825108403883)
tps_courbe1_32= c(7.850132086974193E-4,0.0011530959154643365,0.0014898427148953464,0.0017978130461288357,0.002077380816907133,0.0023836547449705343,0.002655229221702906,0.0029425224547856127,0.0032003930095509045,0.0034707258687258686,0.0037233901646006907,0.003971757163178216,0.004292782564519406,0.004451563706563706,0.004787549075391181,0.005054622637675269,0.005293863239179028,0.005624758382442593,0.005866376346271083,0.006102573257467994,0.006363243852875432,0.006610709408656777,0.006869459865880919,0.007113212355212355,0.007486552326762853,0.007754832960780329,0.008039229018492177,0.008268393415972363,0.008631649258280838,0.00883242918106076,0.009062586669376142,0.009349440357650883,0.009637183905710221,0.00982299512294249,0.010121936801463118,0.010327251574883154,0.010731873399715505)

#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-100*oracle
courbe1 = 100-100*courbe1
courbe1_2 = 100-100*courbe1_2
courbe1_4 = 100-100*courbe1_4
courbe1_8 = 100-100*courbe1_8
courbe1_16 = 100-100*courbe1_16
courbe1_32 = 100-100*courbe1_32

nb_val = length(oracle)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*courbe1)
min_val_erreur = min(min_val_erreur,100-100*courbe1_2)
min_val_erreur = min(min_val_erreur,100-100*courbe1_4)
min_val_erreur = min(min_val_erreur,100-100*courbe1_8)
min_val_erreur = min(min_val_erreur,100-100*courbe1_16)
min_val_erreur = min(min_val_erreur,100-100*courbe1_32)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 0
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*courbe1)
max_val_erreur = max(max_val_erreur,100-100*courbe1_2)
max_val_erreur = max(max_val_erreur,100-100*courbe1_4)
max_val_erreur = max(max_val_erreur,100-100*courbe1_8)
max_val_erreur = max(max_val_erreur,100-100*courbe1_16)
max_val_erreur = max(max_val_erreur,100-100*courbe1_32)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

min_val_time = 30000
min_val_time = min(min_val_erreur,100-100*tps_courbe1)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_2)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_4)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_8)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_16)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_32)
min_val_time = ceiling(min_val_erreur)

max_val_time = 0
max_val_time = max(max_val_time,tps_courbe1)
max_val_time = max(max_val_time,tps_courbe1_2)
max_val_time = max(max_val_time,tps_courbe1_4)
max_val_time = max(max_val_time,tps_courbe1_8)
max_val_time = max(max_val_time,tps_courbe1_16)
max_val_time = max(max_val_time,tps_courbe1_32)
max_val_time = floor(max_val_time)

x_lim_time = c(0,(nb_val-1))
if(min_val_time-y_padding_time <= 0){
  min_val_time = min_val_time+y_padding_time+0.00001
}

png(file=paste("Taux_erreur_sur_",dataset_name,"_",algo_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
(ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
  ylab("Error rate (%)") + xlab("Number of known choices") + theme_bw() #+ theme(legend.position="bottom")
+geom_line(aes(y=courbe1, colour="Complete sample",shape="a")) + geom_point(aes(y=courbe1), colour="coral3") 
+geom_line(aes(y=courbe1_2, colour="1/2 sample",shape="b")) + geom_point(aes(y=courbe1_2), colour="firebrick3") 
+geom_line(aes(y=oracle, colour="Oracle",shape="b")) + geom_point(aes(y=oracle), colour="black") 
+geom_line(aes(y=courbe1_4, colour="1/4 sample")) + geom_point(aes(y=courbe1_4), colour="darkorchid3") 
+geom_line(aes(y=courbe1_8, colour="1/8 sample")) + geom_point(aes(y=courbe1_8), colour="darkslategray4") 
+geom_line(aes(y=courbe1_16, colour="1/16 sample")) + geom_point(aes(y=courbe1_16), colour="springgreen4") 
+geom_line(aes(y=courbe1_32, colour="1/32 sample")) + geom_point(aes(y=courbe1_32), colour="indianred4") 
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                 ,'1/32 sample' #1_32
                                 ,'1/16 sample' #1_16
                                 ,'1/8 sample' #1_8
                                 ,'1/4 sample' #1_4
                                 ,'1/2 sample' #1_2
                                 ,'Complete sample' #courbe1
                                 ,'Oracle' #oracleVrai
                      ),
                      values =c(NULL
                                ,'Complete sample'='coral' #courbe1
                                ,'1/2 sample'='firebrick3' #1_2
                                ,'1/4 sample'='darkorchid1' #1_4
                                ,'1/8 sample'='darkslategray1' #1_8
                                ,'1/16 sample'='springgreen' #1_16
                                ,'1/32 sample'='indianred1' #1_32
                                ,'Oracle'='black' #oracleVrai
                      )))

dev.off()

png(file=paste("Temps_sur_",dataset_name,"_",algo_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
(ggplot(NULL, aes(size))
+ scale_y_log10(
  breaks = scales::trans_breaks("log10", function(x) 10^x),
  labels = scales::trans_format("log10", function(x) round(10^x,2)))
+ annotation_logticks(sides="l")
+ theme_bw() +
  ylab("Time (ms)") + xlab("Number of known choices") #+ theme(legend.position="bottom")
+geom_line(aes(y=tps_courbe1, colour="Complete sample",shape="a")) + geom_point(aes(y=tps_courbe1), colour="coral3") 
+geom_line(aes(y=tps_courbe1_2, colour="1/2 sample",shape="b")) + geom_point(aes(y=tps_courbe1_2), colour="firebrick3") 
+geom_line(aes(y=tps_courbe1_4, colour="1/4 sample")) + geom_point(aes(y=tps_courbe1_4), colour="darkorchid3") 
+geom_line(aes(y=tps_courbe1_8, colour="1/8 sample")) + geom_point(aes(y=tps_courbe1_8), colour="darkslategray4") 
+geom_line(aes(y=tps_courbe1_16, colour="1/16 sample")) + geom_point(aes(y=tps_courbe1_16), colour="springgreen4") 
+geom_line(aes(y=tps_courbe1_32, colour="1/32 sample")) + geom_point(aes(y=tps_courbe1_32), colour="indianred4") 
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                 ,'1/32 sample' #1_32
                                 ,'1/16 sample' #1_16
                                 ,'1/8 sample' #1_8
                                 ,'1/4 sample' #1_4
                                 ,'1/2 sample' #1_2
                                 ,'Complete sample' #courbe1
                      ),
                      values =c(NULL
                                ,'Complete sample'='coral' #courbe1
                                ,'1/2 sample'='firebrick3' #1_2
                                ,'1/4 sample'='darkorchid1' #1_4
                                ,'1/8 sample'='darkslategray1' #1_8
                                ,'1/16 sample'='springgreen' #1_16
                                ,'1/32 sample'='indianred1' #1_32
                      )))
dev.off()
