library(ggplot2)

#--------------------------------------------------------------------------------------------
#Parametres globaux
dataset_name = "alarm_appl_64"
algo_name = "rc"
taille_img_x = 1024/2
taille_img_y = 720/2
#fin parametres globaux
#--------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------
#data

oracle = c(0.7511336356361696,0.7906108295545479,0.8052814083755668,0.8122165910909576,0.850093358228861,0.8482261936516404,0.86476393704988,0.8719658575620165,0.8748999733262203,0.8810349426513737,0.8869031741797813,0.899173112830088,0.9037076553747666,0.9061082955454788,0.903174179781275,0.9127767404641237,0.9197119231795146,0.9298479594558549,0.9125100026673779,0.9181114963990398,0.9301146972526007,0.9271805814883969,0.9277140570818885,0.9234462523339557,0.919178447586023,0.9306481728460922,0.9277140570818885,0.9274473192851427,0.9295812216591091,0.9335822886102961,0.9311816484395838,0.9213123499599893,0.9335822886102961,0.9303814350493465,0.9333155508135503,0.9319818618298212,0.932248599626567)
courbe1 = c(0.7565026010404161,0.7763105242096838,0.7961184473789515,0.8165266106442577,0.8381352541016407,0.8507402961184474,0.8585434173669467,0.8769507803121248,0.8745498199279712,0.882953181272509,0.897358943577431,0.8945578231292517,0.9059623849539816,0.9105642256902761,0.9117647058823529,0.9053621448579432,0.9177671068427371,0.916766706682673,0.9251700680272109,0.9207683073229291,0.9347739095638256,0.9283713485394157,0.9321728691476591,0.9295718287314926,0.9347739095638256,0.9307723089235694,0.9343737494997999,0.9399759903961584,0.9317727090836334,0.937374949979992,0.9397759103641457,0.9431772709083633,0.9407763105242097,0.933173269307723,0.9335734293717487,0.9367747098839536,0.936374549819928)
courbe1_2 = c(0.7574302697759487,0.7985825331504344,0.7956104252400549,0.81572930955647,0.8417924096936442,0.8388203017832647,0.8644261545496114,0.8630544124371284,0.8790580704160951,0.8854595336076817,0.8868312757201646,0.8799725651577504,0.9003200731595793,0.9037494284407864,0.8978052126200274,0.9085505258344765,0.8968907178783722,0.9037494284407864,0.9163237311385459,0.9119798811156836,0.9231824417009602,0.9151806127114769,0.9224965706447188,0.9149519890260631,0.9158664837677183,0.9220393232738912,0.9204389574759945,0.9215820759030635,0.9160951074531322,0.9158664837677183,0.9140374942844078,0.9151806127114769,0.9135802469135802,0.9138088705989941,0.909007773205304,0.9078646547782351,0.9092363968907179)
courbe1_4 = c(0.764668231278003,0.7883507574141242,0.7958182206101985,0.8135267761894602,0.8229144442073821,0.8408363558779604,0.8504373799871986,0.8551312139961595,0.8647322381053979,0.8766801792191167,0.8739065500320035,0.8832942180499254,0.890975037337316,0.9033496906336675,0.8980157883507575,0.8952421591636441,0.8843609985065074,0.8958822274375934,0.8982291444420738,0.903563046724984,0.8995092809899723,0.8971623639854918,0.9003627053552379,0.9005760614465543,0.8965222957115425,0.8926818860678473,0.8939620226157456,0.8914017495199488,0.8907616812459995,0.8877746959675699,0.8914017495199488,0.8845743545978237,0.8790270962235972,0.8809473010454448,0.8779603157670152,0.8773202474930659,0.8745466183059526)
courbe1_8 = c(0.7571753045632872,0.7875283914928763,0.807557299194714,0.8104480693784845,0.8352260995250878,0.8352260995250878,0.844517860830064,0.8509188519512699,0.8653727028701218,0.8569068759033657,0.8649597357010118,0.8686764402230023,0.8775552343588685,0.8734255626677679,0.8798265537889738,0.874457980590543,0.8709477596531076,0.8752839149287631,0.8695023745612224,0.8653727028701218,0.8620689655172413,0.8593846789180261,0.8575263266570308,0.8521577534586,0.8428659921536238,0.8430724757381788,0.8428659921536238,0.8292380755729919,0.822630600867231,0.8211852157753459,0.822011150113566,0.8065248812719389,0.8059054305182738,0.8013627916580632,0.7990914722279578,0.7900061945075366,0.7823663018790006)
courbe1_16 = c(0.7604145498882341,0.7823613086770982,0.7996342206868523,0.8061369640317009,0.8197520829099777,0.8152814468603943,0.8321479374110953,0.8331639910587278,0.8319447266815688,0.8412924202397887,0.8469823206665312,0.8382442592968908,0.8321479374110953,0.833976833976834,0.8223938223938224,0.8290997764681975,0.823409876041455,0.8156878683194473,0.8028855923592766,0.7931314773420036,0.7969924812030075,0.7854094696199959,0.7915057915057915,0.7789067262751473,0.7667140825035562,0.7604145498882341,0.7606177606177607,0.7535053850843324,0.737654948181264,0.7311522048364154,0.7240398293029872,0.7132696606380817,0.7116439748018696,0.6988416988416989,0.6937614306035359,0.6925421662263768,0.6856330014224751)
courbe1_32= c(0.7586693548387097,0.777016129032258,0.7858870967741935,0.7951612903225806,0.8036290322580645,0.8070564516129032,0.805241935483871,0.8040322580645162,0.7933467741935484,0.7891129032258064,0.7860887096774194,0.7667338709677419,0.7733870967741936,0.7633064516129032,0.7479838709677419,0.7483870967741936,0.7294354838709678,0.7175403225806452,0.7026209677419355,0.6949596774193548,0.6965725806451613,0.6834677419354839,0.6766129032258065,0.6641129032258064,0.6483870967741936,0.6296370967741935,0.630241935483871,0.6195564516129032,0.6066532258064516,0.6008064516129032,0.5961693548387097,0.5772177419354839,0.5743951612903225,0.561491935483871,0.542741935483871,0.54375,0.5423387096774194)
courbe1_64 = c()

tps_courbe1 = c(3.260436447979192,1.0735578707482993,0.93003493717487,0.8156372893157263,0.6635573503401361,0.5699110468187275,0.49307356282513004,0.4128526744697879,0.35688447659063627,0.3063106844737895,0.2527949253701481,0.2095138793517407,0.17454798039215685,0.1403603757503001,0.12034017987194878,0.09953717326930772,0.08602137775110044,0.0703179943977591,0.0594418087234894,0.0502299549819928,0.0432231862745098,0.03614089775910364,0.031091359543817528,0.026876727290916367,0.02202147919167667,0.01914060424169668,0.01692589595838335,0.015571928171268507,0.01365353181272509,0.012042611444577831,0.010987975590236095,0.010094930972388956,0.009418771108443377,0.008660603041216486,0.008147490196078432,0.007782820528211285,0.007425873949579832)
tps_courbe1_2 = c(0.5512198774577046,0.15480721376314585,0.13294712825788751,0.11954266780978509,0.09959187905807042,0.08646775788751715,0.07832855441243713,0.06665838820301784,0.059952558756287154,0.05360913100137174,0.04760051440329218,0.04133211271147691,0.036782938500228624,0.034173339734796526,0.03000913305898491,0.0267187633744856,0.024230078417924097,0.02225317146776406,0.020187128715134887,0.018395297668038407,0.016739331275720165,0.015500158207590306,0.014530874485596708,0.013246705304069501,0.01241713854595336,0.011536369913123,0.011113029263831732,0.010439139003200731,0.009845171239140376,0.00934022130772748,0.008959086877000456,0.008536445358939186,0.008167636716963878,0.007732367855509831,0.007497670553269319,0.007205697302240512,0.006941411065386374)
tps_courbe1_4 = c(0.36526619692767226,0.08933387518668658,0.08288692297845103,0.07392462940046939,0.06464287774695968,0.058451441433752936,0.05350505525922765,0.04628825752080222,0.04514204693834009,0.04220091188393429,0.03595924898655856,0.032213715382974184,0.029311510987838702,0.026537263281416684,0.024287268401962877,0.024412592063153403,0.020341851290804354,0.018908952208235547,0.01718199402602944,0.015858211649242587,0.014492012374653297,0.013671115425645402,0.012801526136121186,0.012334092169831449,0.011262244932792832,0.010519732878173671,0.01004957200768082,0.00943826242799232,0.008978212075954768,0.008582088756133987,0.00814183955621933,0.007930151056112653,0.007472900149349264,0.007314420738212076,0.006987438233411564,0.006807619799445274,0.006586868572647749)
tps_courbe1_8 = c(0.14614744104893662,0.02771782366301879,0.026465179227751393,0.02407389077018377,0.023196595705141442,0.02203614825521371,0.021364317571753045,0.01909617406566178,0.018211159818294447,0.016873393144744994,0.01614777431344208,0.015406482552137104,0.014519336774726409,0.013682110881684906,0.013099510014453851,0.012570884162709064,0.012040165186867645,0.011633859797646088,0.011072214536444353,0.010539119347511873,0.010000740450134214,0.009890863720834194,0.00937315052653314,0.009179855461490811,0.008731550898203592,0.008238211232707,0.007960594879207103,0.007838540986991533,0.007627925046458806,0.007255726409250465,0.0071421792277513935,0.006874006400991122,0.006640902952715259,0.006468300433615528,0.006426575882717324,0.00622650361346273,0.006032918232500516)
tps_courbe1_16 = c(0.09338369498069499,0.017408818532818532,0.016098247510668563,0.015624732371469214,0.014918029262345051,0.014027833570412518,0.013491121926437716,0.0128576565738671,0.012351667140825036,0.01195574700264174,0.011496727697622434,0.01107483722820565,0.010860743954480797,0.0102512188579557,0.010074168258484048,0.009828678723836618,0.009571007315586263,0.009041758382442594,0.008857958545011176,0.008602930298719773,0.008324474700264173,0.00824021520016257,0.007919498882340987,0.008929088396667345,0.007480628327575696,0.007309440357650884,0.008570870757976022,0.007081931517984149,0.006882726275147328,0.006760792318634424,0.006533878073562284,0.006405898801056696,0.006277661450924609,0.006102761633814266,0.006050069091648039,0.005958121316805527,0.00583003434261329)
tps_courbe1_32= c(0.055193120766129034,0.011006599596774193,0.009931004838709677,0.009656213911290323,0.009329253830645161,0.009190548790322581,0.0089747,0.008750179637096775,0.008605391935483871,0.008433113911290322,0.008184747580645161,0.008118943145161291,0.007980783467741935,0.00770553185483871,0.007665311491935484,0.008487722983870967,0.007444052620967742,0.007351283064516129,0.0071640604838709675,0.007776345766129032,0.006975235887096774,0.0067816649193548385,0.0066895022177419355,0.006698707661290323,0.006623079032258065,0.006369771572580645,0.006263685080645161,0.006149351008064516,0.006120639314516129,0.006035147177419355,0.005900102016129032,0.005870464717741936,0.005739877217741936,0.005542830241935484,0.005483942943548387,0.005458233669354839,0.005338340927419354)
tps_courbe1_64 = c()

#--------------------------------------------------------------------------------------------
#parametres graphes
# -- manuels
x_pas_erreur = 4
y_pas_erreur = 3
x_legend_erreur = 0
y_legend_erreur = 50
y_padding_erreur = 1

x_pas_time = 4
y_pas_time = 3
x_legend_time = 0
y_legend_time = 0.013
y_padding_time = 0.01

# -- auto calcul

#MAJ VERS ERROR
oracle = 100-100*oracle
courbe1 = 100-100*courbe1
courbe1_2 = 100-100*courbe1_2
courbe1_4 = 100-100*courbe1_4
courbe1_8 = 100-100*courbe1_8
courbe1_16 = 100-100*courbe1_16
courbe1_32 = 100-100*courbe1_32
courbe1_64 = 100-100*courbe1_64

nb_val = length(oracle)

min_val_erreur = 30000
min_val_erreur = min(min_val_erreur,100-100*oracle)
min_val_erreur = min(min_val_erreur,100-100*courbe1)
min_val_erreur = min(min_val_erreur,100-100*courbe1_2)
min_val_erreur = min(min_val_erreur,100-100*courbe1_4)
min_val_erreur = min(min_val_erreur,100-100*courbe1_8)
min_val_erreur = min(min_val_erreur,100-100*courbe1_16)
min_val_erreur = min(min_val_erreur,100-100*courbe1_32)
min_val_erreur = min(min_val_erreur,100-100*courbe1_64)
min_val_erreur = ceiling(min_val_erreur)

max_val_erreur = 0
max_val_erreur = max(max_val_erreur,100-100*oracle)
max_val_erreur = max(max_val_erreur,100-100*courbe1)
max_val_erreur = max(max_val_erreur,100-100*courbe1_2)
max_val_erreur = max(max_val_erreur,100-100*courbe1_4)
max_val_erreur = max(max_val_erreur,100-100*courbe1_8)
max_val_erreur = max(max_val_erreur,100-100*courbe1_16)
max_val_erreur = max(max_val_erreur,100-100*courbe1_32)
max_val_erreur = max(max_val_erreur,100-100*courbe1_64)
max_val_erreur = floor(max_val_erreur)

size = 0:(nb_val-1)
x_lim_erreur = c(0,(nb_val-1))
if(min_val_erreur-y_padding_erreur <= 0){
  min_val_erreur = min_val_erreur+y_padding_erreur+0.00001
}
y_lim_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur))
x_axp_erreur = c(0, (nb_val-1), x_pas_erreur)
y_axp_erreur = c((min_val_erreur-y_padding_erreur),(max_val_erreur+y_padding_erreur),y_pas_erreur)

min_val_time = 30000
min_val_time = min(min_val_erreur,100-100*tps_courbe1)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_2)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_4)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_8)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_16)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_32)
min_val_time = min(min_val_erreur,100-100*tps_courbe1_64)
min_val_time = ceiling(min_val_erreur)

max_val_time = 0
max_val_time = max(max_val_time,tps_courbe1)
max_val_time = max(max_val_time,tps_courbe1_2)
max_val_time = max(max_val_time,tps_courbe1_4)
max_val_time = max(max_val_time,tps_courbe1_8)
max_val_time = max(max_val_time,tps_courbe1_16)
max_val_time = max(max_val_time,tps_courbe1_32)
max_val_time = max(max_val_time,tps_courbe1_64)
max_val_time = floor(max_val_time)

x_lim_time = c(0,(nb_val-1))
if(min_val_time-y_padding_time <= 0){
  min_val_time = min_val_time+y_padding_time+0.00001
}

png(file=paste("Taux_erreur_sur_",dataset_name,"_",algo_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
(ggplot(NULL, aes(size)) + #scale_y_log10(breaks = round(seq(0, 100, by = 5),1)) + annotation_logticks(sides="l") +
  ylab("Error rate (%)") + xlab("Number of known choices") + theme_bw() #+ theme(legend.position="bottom")
+geom_line(aes(y=courbe1, colour="Complete sample",shape="a")) + geom_point(aes(y=courbe1), colour="coral3") 
+geom_line(aes(y=courbe1_2, colour="1/2 sample",shape="b")) + geom_point(aes(y=courbe1_2), colour="firebrick3") 
+geom_line(aes(y=oracle, colour="Oracle",shape="b")) + geom_point(aes(y=oracle), colour="black") 
+geom_line(aes(y=courbe1_4, colour="1/4 sample")) + geom_point(aes(y=courbe1_4), colour="darkorchid3") 
+geom_line(aes(y=courbe1_8, colour="1/8 sample")) + geom_point(aes(y=courbe1_8), colour="darkslategray4") 
+geom_line(aes(y=courbe1_16, colour="1/16 sample")) + geom_point(aes(y=courbe1_16), colour="springgreen4") 
+geom_line(aes(y=courbe1_32, colour="1/32 sample")) + geom_point(aes(y=courbe1_32), colour="indianred4") 
+geom_line(aes(y=courbe1_64, colour="1/64 sample")) + geom_point(aes(y=courbe1_64), colour="deepskyblue4") 
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                 ,'1/64 sample' #1_64
                                 ,'1/32 sample' #1_32
                                 ,'1/16 sample' #1_16
                                 ,'1/8 sample' #1_8
                                 ,'1/4 sample' #1_4
                                 ,'1/2 sample' #1_2
                                 ,'Complete sample' #courbe1
                                 ,'Oracle' #oracleVrai
                      ),
                      values =c(NULL
                                ,'Complete sample'='coral' #courbe1
                                ,'1/2 sample'='firebrick3' #1_2
                                ,'1/4 sample'='darkorchid1' #1_4
                                ,'1/8 sample'='darkslategray1' #1_8
                                ,'1/16 sample'='springgreen' #1_16
                                ,'1/32 sample'='indianred1' #1_32
                                ,'1/64 sample'='deepskyblue4' #1_64
                                ,'Oracle'='black' #oracleVrai
                      )))

dev.off()

png(file=paste("Temps_sur_",dataset_name,"_",algo_name,".png",sep=""), bg="white", width=taille_img_x, height=taille_img_y, pointsize = 12)
(ggplot(NULL, aes(size))
+ scale_y_log10(
  breaks = scales::trans_breaks("log10", function(x) 10^x),
  labels = scales::trans_format("log10", function(x) round(10^x,2)))
+ annotation_logticks(sides="l")
+ theme_bw() +
  ylab("Time (ms)") + xlab("Number of known choices") #+ theme(legend.position="bottom")
+geom_line(aes(y=tps_courbe1, colour="Complete sample",shape="a")) + geom_point(aes(y=tps_courbe1), colour="coral3") 
+geom_line(aes(y=tps_courbe1_2, colour="1/2 sample",shape="b")) + geom_point(aes(y=tps_courbe1_2), colour="firebrick3") 
+geom_line(aes(y=tps_courbe1_4, colour="1/4 sample")) + geom_point(aes(y=tps_courbe1_4), colour="darkorchid3") 
+geom_line(aes(y=tps_courbe1_8, colour="1/8 sample")) + geom_point(aes(y=tps_courbe1_8), colour="darkslategray4") 
+geom_line(aes(y=tps_courbe1_16, colour="1/16 sample")) + geom_point(aes(y=tps_courbe1_16), colour="springgreen4") 
+geom_line(aes(y=tps_courbe1_32, colour="1/32 sample")) + geom_point(aes(y=tps_courbe1_32), colour="indianred4") 
+geom_line(aes(y=tps_courbe1_64, colour="1/64 sample")) + geom_point(aes(y=tps_courbe1_64), colour="deepskyblue4") 
+ scale_colour_manual(name = 'Legend', guide = 'legend',
                      limits = c(NULL
                                 ,'1/64 sample' #1_64
                                 ,'1/32 sample' #1_32
                                 ,'1/16 sample' #1_16
                                 ,'1/8 sample' #1_8
                                 ,'1/4 sample' #1_4
                                 ,'1/2 sample' #1_2
                                 ,'Complete sample' #courbe1
                      ),
                      values =c(NULL
                                ,'Complete sample'='coral' #courbe1
                                ,'1/2 sample'='firebrick3' #1_2
                                ,'1/4 sample'='darkorchid1' #1_4
                                ,'1/8 sample'='darkslategray1' #1_8
                                ,'1/16 sample'='springgreen' #1_16
                                ,'1/32 sample'='indianred1' #1_32
                                ,'1/64 sample'='deepskyblue4' #1_64
                      )))
dev.off()
